!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i=window.webpackJsonp;window.webpackJsonp=function(t,n,o){for(var s,a,c=0,u=[];c<t.length;c++)a=t[c],r[a]&&u.push(r[a][0]),r[a]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]);for(i&&i(t,n,o);u.length;)u.shift()()};var n={},r={1:0};t.e=function(e){function i(){a.onerror=a.onload=null,clearTimeout(c);var t=r[e];0!==t&&(t&&t[1](new Error("Loading chunk "+e+" failed.")),r[e]=void 0)}var n=r[e];if(0===n)return new Promise(function(e){e()});if(n)return n[2];var o=new Promise(function(t,i){n=r[e]=[t,i]});n[2]=o;var s=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.async=!0,a.timeout=12e4,t.nc&&a.setAttribute("nonce",t.nc),a.src=t.p+""+e+".bundle.js";var c=setTimeout(i,12e4);return a.onerror=a.onload=i,s.appendChild(a),o},t.m=e,t.c=n,t.i=function(e){return e},t.d=function(exports,e,i){t.o(exports,e)||Object.defineProperty(exports,e,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="dist/",t.oe=function(e){throw e},t(t.s=9)}([function(e,t,i){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=f();return function(){var i,n=d(e);if(t){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return l(this,i)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=i(2),p=i(5),y=i(1),g=function(e){function t(){var e;return r(this,t),e=i.call(this),e.selectedCamera="back",e.mode="picture",e.mozCamera=null,e.recording=!1,e.sharingIsActive=!1,e.recorderProfile=new Map,e}a(t,e);var i=u(t);return s(t,[{key:"load",value:function(){var e=this,t=this.selectedCamera!==this.lastLoadedCamera;if(this.releasing)return void this.on("released",function(){e.load(),e.offAll("released")});this.mozCamera?t&&this.release().then(function(){e.doRequest()}):this.doRequest()}},{key:"doRequest",value:function(){this.requestCamera(this.selectedCamera),this.lastLoadedCamera=this.selectedCamera}},{key:"requestCamera",value:function(e,t){if(!this.isBusy){if(t||(t={mode:this.mode,previewSize:"video"===this.mode?this.recorderVideoSize:this.givenPreviewSize,pictureSize:"video"===this.mode?this.recorderVideoSize:this.pictureSize,recorderProfile:this.recorderProfile}),!this.recorderProfile.get(this.selectedCamera)){var i=y.default.settings.recorderProfiles.selected("key");this.recorderProfile.set(this.selectedCamera,i)}t.recorderProfile=this.recorderProfile.get(this.selectedCamera);this.request(e,t,3)}}},{key:"request",value:function(e,t,i){var n=this;0!==i&&navigator.b2g.cameras&&(this.busy("requesting-camera"),t.previewSize={height:480,width:640},navigator.b2g.cameras.getCamera(e,t).then(function(e){n.mozCamera=e.Camera,n.updateConfig(e.configuration),n.setupNewCamera(e.camera),n.emit("configured",e.camera.capabilities),n.ready()},function(r){i--,n.cameraRequestTimeout=setTimeout(n.request(e,t,i),1e3),n.ready()}))}},{key:"setupNewCamera",value:function(e){this.capabilities=e.capabilities,this.mozCamera=e,this.mozCamera.addEventListener("previewstatechange",this.onPreviewStateChange.bind(this)),this.mozCamera.addEventListener("recorderstatechange",this.onRecorderStateChange.bind(this)),y.default.update(this.capabilities),this.configureCamera(),this.audioChannelClient=new AudioChannelClient("normal")}},{key:"configureCamera",value:function(){var e=y.default.settings.pictureSizes.selected("data"),t=y.default.settings.recorderProfiles.selected("key");this.configureFlash(),this.configureZoom(),this.setPictureSize(e,{configure:!1}),this.setRecorderProfile(t,{configure:!1})}},{key:"setPictureSize",value:function(e,t){if(e){var i=!(t&&!1===t.configure);this.isPictureSize(e)||(this.pictureSize=e,i?this.configureHardware():this.mozCamera.setPictureSize(e),this.setThumbnailSize())}}},{key:"isPictureSize",value:function(e){if(!this.pictureSize)return!1;var t=e.width===this.pictureSize.width,i=e.height===this.pictureSize.height;return t&&i}},{key:"setThumbnailSize",value:function(){var e=this.mozCamera.capabilities.thumbnailSizes,t=this.mozCamera.getPictureSize(),i=this.pickThumbnailSize(e,t);i&&this.mozCamera.setThumbnailSize(i)}},{key:"pickThumbnailSize",value:function(e,t){var i=window.innerWidth*window.devicePixelRatio,n=window.innerHeight*window.devicePixelRatio,r=t.width/t.height,o=null,s=null;if(!(e=e.slice(0))||!t)return null;if(e=e.filter(function(e){var t=e.width/e.height;return Math.abs(t-r)<.05}),0===e.length)return null;for(e.sort(function(e,t){return e.width*e.height-t.width*t.height}),s=0;s<e.length;++s)if(o=e[s],function(e,t){return(e>=i||t>=n)&&(e>=n||t>=i)}(o.width,o.height))return o;return e[e.length-1]}},{key:"configureFlash",value:function(){var e=y.default.settings.flashModes;this.setFlashMode(e.selected("key"))}},{key:"onPreviewStateChange",value:function(e){var t=e.newState;this.emit("previewChanged",t)}},{key:"onRecorderStateChange",value:function(e){var t=e.newState;"FileSizeLimitReached"!==t||this.FileSizeLimitReached||(this.FileSizeLimitReached=!0,this.mozCamera.stopRecording(),p.a.request("update")),"Stopped"===t&&this.emit("recording-stop")}},{key:"loadStreamInto",value:function(e){if(this.mozCamera&&e){e.mozSrcObject===this.mozCamera||(e.mozSrcObject=this.mozCamera,e.play())}}},{key:"getSensorAngle",value:function(){return this.mozCamera&&this.mozCamera.sensorAngle}},{key:"getRecorderProfile",value:function(){var e=this.recorderProfile.get(this.selectedCamera);return this.mozCamera.capabilities.recorderProfiles[e]}},{key:"updateConfig",value:function(e){"picture"===this.mode&&(this.pictureSize=e.pictureSize,this.givenPreviewSize=e.previewSize),this.recorderProfile.set(this.selectedCamera,e.recorderProfile),this.configured=!0}},{key:"previewSize",value:function(){return this.givenPreviewSize}},{key:"release",value:function(){var e=this;return new Promise(function(t){if(clearTimeout(e.cameraRequestTimeout),!e.mozCamera||e.releasing)return void t();e.releasing=!0,e.busy("releasing-camera"),e.mozCamera.release().then(function(){e.releasing=!1,e.ready(),e.mozCamera=null,e.emit("released"),t()},function(t){e.ready()})})}},{key:"configureHardware",value:function(e){var t=this;return new Promise(function(i,n){if(!t.isBusy){if(t.configured=!1,e&&(t.mode=e),!t.mozCamera)return void n("no mozCamera");t.busy("configuring-hardware");var r={mode:t.mode,previewSize:"video"===t.mode?t.getRecorderProfile().video.size:t.givenPreviewSize,pictureSize:"video"===t.mode?t.getRecorderProfile().video.size:t.pictureSize,recorderProfile:t.recorderProfile.get(t.selectedCamera)};t.mozCamera.setConfiguration(r).then(function(e){t.configureZoom(),t.configured=!0,t.emit("configured"),i(e),t.ready()},function(){t.configured=!0,n("configureError"),t.ready()})}})}},{key:"sendEvt",value:function(e){this.emit(e)}},{key:"setZoom",value:function(e){this.mozCamera.zoom=e}},{key:"isZoomSupported",value:function(){return this.mozCamera.capabilities.zoomRatios.length>1}},{key:"configureZoom",value:function(){var e=this.getMinimumZoom();return this.setZoom(e),this.emit("zoomconfigured"),this}},{key:"getMinimumZoom",value:function(){var e=this.mozCamera.capabilities.zoomRatios;return 0===e.length?1:e[0]}},{key:"getMaximumZoom",value:function(){var e=this.mozCamera.capabilities.zoomRatios;return 0===e.length?1:e[e.length-1]}},{key:"previewSizes",value:function(){return this.mozCamera?this.mozCamera.capabilities.previewSizes:null}},{key:"setCamera",value:function(e){this.selectedCamera!==e&&(this.selectedCamera=e,this.load())}},{key:"setMode",value:function(e){this.mode=e,this.configureFlash()}},{key:"isMode",value:function(e){return this.mode===e}},{key:"setFlashMode",value:function(e){this.mozCamera&&(e=e||"off",this.mozCamera.flashMode=e),p.a.request("updateFlashIcon",this)}},{key:"setMaxFileSize",value:function(e){this.maxFileSizeBytes=e}},{key:"updatePictureSize",value:function(e){var t="picture"===y.default.settings.mode.selected("key"),i=y.default.settings.pictureSizes.selected("data"),n=y.default.settings.pictureSizes.selected("key");if(!this.isPictureSize(i)){if(!t)return void this.setPictureSize(i,{configure:!1});this.setPictureSize(i),e&&this.showResolutionChangedToast(n)}}},{key:"updateRecorderProfile",value:function(e){var t="video"===y.default.settings.mode.selected("key"),i=y.default.settings.recorderProfiles.selected("key");if(!this.isRecorderProfile(i)){if(!t)return void this.setRecorderProfile(i,{configure:!1});this.setRecorderProfile(i),e&&this.showResolutionChangedToast(i)}}},{key:"showResolutionChangedToast",value:function(e){var t=null;("video"===this.mode?y.default.settings.recorderProfiles:y.default.settings.pictureSizes).get("options").forEach(function(i){i.key===e&&(t=i)});var i=window.api.l10n.get("set-resolution-to");i+=" ",i+=window.api.l10n.get(t.title),i+=".",Toaster.showToast({message:i})}},{key:"isRecorderProfile",value:function(e){return e===this.recorderProfile.get(this.selectedCamera)}},{key:"setRecorderProfile",value:function(e,t){var i=this;if(e){var n=!(t&&!1===t.configure);this.recorderProfile.set(this.selectedCamera,e),this.recorderVideoSize=this.getRecorderProfile().video.size,n&&("video"===this.mode?setTimeout(function(){i.configureHardware()}):this.configureHardware())}}},{key:"isSharingActive",value:function(){return this.sharingIsActive}},{key:"setSharingState",value:function(e){var t="sharing"===e;t!==this.sharingIsActive&&(this.sharingIsActive=t,this.sharingIsActive)}},{key:"handleZoomChange",value:function(e){var t=this.getMinimumZoom(),i=this.getMaximumZoom(),n=i-t,r=n*e/100+t;this.setZoom(r)}},{key:"busy",value:function(e){this.isBusy=!0,this.emit("busy",e),clearTimeout(this.readyTimeout)}},{key:"ready",value:function(){var e=this;this.isBusy=!1,clearTimeout(this.readyTimeout),this.readyTimeout=setTimeout(function(){e.emit("ready")},150)}}]),t}(v.a),m=new g;t.a=m},function(e,t,i){"use strict";function n(e,t){return c(e)||a(e,t)||o(e,t)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function a(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}}function c(e){if(Array.isArray(e))return e}function u(e){"@babel/helpers - typeof";return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=m();return function(){var i,n=b(e);if(t){var r=b(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return y(this,i)}}function y(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var w=i(3),S=i(2),k=i(0),P=i(10),z=i(8),_=i(11),C=i(12),E=function(e){function t(e){var n;return l(this,t),n=i.call(this),n.key=e.key,n.settings=e.settings,n.current=e.get.bind(g(n)),n.forwardMethods=["filterOptions","resetOptions","supported","selected","select","get","set"],n.forwardMethods.forEach(n.forward,g(n)),n}d(t,e);var i=p(t);return f(t,[{key:"forward",value:function(e){this[e]=function(){var t=this.current();if(t)return t[e].apply(t,arguments)}}}]),t}(S.a),x=function(){function e(t){l(this,e),this.key=t.key,this.reset(t,{silent:!0}),this.select=this.select.bind(this),this.get=this.get.bind(this),this.set=this.set.bind(this),this.configure(t),this.dontSave=!1}return f(e,[{key:"reset",value:function(e){if(e){var t=e instanceof Array;this._data=t?e:this.mix({},e)}}},{key:"mix",value:function(e,t){for(var i in t)e[i]=t[i];return e}},{key:"get",value:function(e){var t=this._getData();return arguments.length?t[e]:this.mix({},t)}},{key:"set",value:function(e,t,i){i="object"===u(e)?t:i;var n=i&&i.silent,r=this._getData();switch(u(e)){case"string":return r[e]=t,void(n||"selected"===e&&(!0!==this._getData().persistent||this.dontSave||this.save()));case"object":this.mix(r,e)}}},{key:"_getData",value:function(){return this._data=this._data||{},this._data}},{key:"configure",value:function(e){var t=!(!e.options||!e.options.length);this.options={defined:t},this.resetOptions(e.options)}},{key:"resetOptions",value:function(e){e=e||[];var t=this.optionsToHash(e);this.options.all=t,this.options.available=t,this.set("options",e,{silent:!0}),this.updateSelected({silent:!0})}},{key:"filterOptions",value:function(e,t){var i=this.options.available={},n=this.options.all,r=[];(e||[]).forEach(function(e){var t=n[e];void 0!==t&&(r.push(t),i[e]=t)}),this.sortByIndex(r),this.set("options",r,t),this.updateSelected({silent:!0})}},{key:"optionsToHash",value:function(e){var t={};return e.forEach(function(e,i){e.index=i,t[e.key]=e}),t}},{key:"selected",value:function(e){var t=this.options.available,i=t[this.get("selected")];return e?i&&i[e]:i}},{key:"select",value:function(e,t){if(void 0===e||null===e)return void this.select(0,t);var i=this.get("options");if(i.length){var n="number"==typeof e?i:this.options.available,r=n[e];if(!r)return void this.select(0,t);this.set("selected",r.key,t)}}},{key:"sortByIndex",value:function(e){return e.sort(function(e,t){return e.index-t.index})}},{key:"updateSelected",value:function(e){this.select(this.get("selected")||this.fetched,e)}},{key:"save",value:function(){var e=this.get("selected");localStorage.setItem("setting:".concat(this.key),e)}},{key:"fetch",value:function(){if(this.get("persistent")){if(this.fetched=localStorage.getItem("setting:".concat(this.key)),!this.fetched)switch(this.key){case"recorderProfilesBack":this.fetched="480p";break;case"recorderProfilesFront":this.fetched="cif"}this.fetched&&this.select(this.fetched,{silent:!0})}}},{key:"supported",value:function(){return this.enabled()&&!!this.get("options").length}},{key:"enabled",value:function(){return!this.get("disabled")}}]),e}(),M=function(){function e(t){l(this,e),this.ids={},this.items=[],this.aliases={},this.dontSave=this.dontSave.bind(this),this.addEach(t)}return f(e,[{key:"addEach",value:function(e){if(e){var t=null,i=null;for(i in e)t=e[i],t.key=t.key||i,this.add(e[i])}}},{key:"add",value:function(e){var t=new x(e);this.items.push(t),this.ids[t.key]=t,this[t.key]=t}},{key:"fetch",value:function(){this.items.forEach(function(e){e.fetch()})}},{key:"dontSave",value:function(){this.items.forEach(function(e){e.dontSave=!0})}},{key:"alias",value:function(e){var t=new E(e);this.aliases[e.key]=t,this[e.key]=t}}]),e}(),O=function(e){function t(){var e;return l(this,t),e=r.call(this),e.settingsData=P.a,e.settings=new M(e.settingsData),e.settings.fetch(),e.setupSettingsMenuAlias(),e.setupFlashModesAlias(),e.setupPictureSizesAlias(),e.setupRecorderProfilesAlias(),e.cameraList=navigator.b2g.cameras&&navigator.b2g.cameras.getListOfCameras(),e.refsHash={},e.currentSettings=null,e}d(t,e);var r=p(t);return f(t,[{key:"menuItems",value:function(){var e=this,t=null,i=null;return this.cameraList&&1===this.cameraList.length&&(t="cameras",(i=this.settings[t])&&i.set("disabled",i.key,{silent:!0})),(window.isSecureMode||"pick"===w.default.name)&&(t="video"===k.a.mode?"video":"gallery",(i=this.settings[t])&&i.set("disabled",i.key,{silent:!0})),this.settings.settingsMenu.get("items").filter(this.validMenuItem,this).map(function(t){return e.settings[t.key]},this)}},{key:"setupFlashModesAlias",value:function(){var e=this.settings;this.settings.alias({key:"flashModes",settings:{picture:this.settings.flashModesPicture,video:this.settings.flashModesVideo},get:function(){var t=e.mode.selected("key");return this.settings[t]}})}},{key:"setupSettingsMenuAlias",value:function(){var e=this.settings;this.settings.alias({key:"settingsMenu",settings:{picture:this.settings.settingsMenuPhoto,video:this.settings.settingsMenuVideo},get:function(){var t=e.mode.selected("key");return this.settings[t]}})}},{key:"setupPictureSizesAlias",value:function(){var e=this.settings;this.settings.alias({key:"pictureSizes",settings:{back:this.settings.pictureSizesBack,front:this.settings.pictureSizesFront},get:function(){var t=e.cameras.selected("key");return this.settings[t]}})}},{key:"setupRecorderProfilesAlias",value:function(){var e=this.settings;this.settings.alias({key:"recorderProfiles",settings:{back:this.settings.recorderProfilesBack,front:this.settings.recorderProfilesFront},get:function(){var t=e.cameras.selected("key");return this.settings[t]}})}},{key:"validMenuItem",value:function(e){var t=this.settings[e.key];return!!t&&t.supported()}},{key:"getSupportedModes",value:function(){return this.settings.mode.get().options}},{key:"setMaxPixelSize",value:function(e){if(e){var t=this.settings.pictureSizes,i=t.get("maxPixelSize");if(this.settings.pictureSizesFront.set("maxPixelSize",e),this.settings.pictureSizesBack.set("maxPixelSize",e),i!==e){var n=t.get("options"),r=[];n&&n.length>0&&(n.forEach(function(t){t.pixelSize<=e&&r.push(t)}),t.resetOptions(r))}}}},{key:"setMaxFileSize",value:function(e){var t=this.settings.recorderProfiles;if(this.settings.recorderProfilesFront.set("maxFileSizeBytes",e),this.settings.recorderProfilesBack.set("maxFileSizeBytes",e),e&&this.formattedRecorderProfiles){var i=n(this.formattedRecorderProfiles,1),r=i[0];t.resetOptions([r]),t.select(r.key),k.a.updateRecorderProfile()}}},{key:"configurePictureSizes",value:function(e){var t=this.settings.pictureSizes,n=t.get("support"),r=z.a.globals.CONFIG_MAX_IMAGE_PIXEL_SIZE,o={support:n,maxPixelSize:r},s=i.i(_.a)(e,o);if(t.resetOptions(s),!t.dontSave){var a="back"===k.a.selectedCamera?localStorage.getItem("setting:pictureSizesBack"):localStorage.getItem("setting:pictureSizesFront");a&&t.select(a)}}},{key:"configureRecorderProfiles",value:function(e){var t=this.settings.recorderProfiles,n=t.get("maxFileSizeBytes"),r=t.get("options"),o=i.i(C.a)(e,r);t.options=o,this.formattedRecorderProfiles=o,n&&(o=[o[0]],t.select(o[0].key),k.a.updateRecorderProfile()),t.resetOptions(o)}},{key:"update",value:function(e){1===e.flashModes.length&&"off"===e.flashModes[0]&&(e.flashModes[0]=void 0,this.settings.flashModes.select("off")),this.settings.flashModesVideo.filterOptions(e.flashModes),this.settings.flashModesPicture.filterOptions(e.flashModes),this.configurePictureSizes(e.pictureSizes),this.configureRecorderProfiles(e.recorderProfiles)}}]),t}(S.a),R=new O;t.default=R},function(e,t,i){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=f();return function(){var i,n=d(e);if(t){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return l(this,i)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i.d(t,"a",function(){return y});var v=i(7),p=i(5),y=function(e){function t(){var e;return r(this,t),e=i.call(this),e.EVENT_PREFIX="",e.service=window.Service||p.a,e.EVENTS&&e.EVENTS.forEach(function(e){window.addEventListener(e,this)},h(e)),e.SERVICES&&e.SERVICES.forEach(function(e){this.service.register(e,this)},h(e)),e.STATES&&e.STATES.forEach(function(e){this.service.registerState(e,this)},h(e)),e}a(t,e);var i=u(t);return s(t,[{key:"publish",value:function(e,t,i){var n=i?"":this.EVENT_PREFIX,r=new CustomEvent(n+e,{bubbles:!0,detail:t||this});this.debug("publishing: "+n+e),window.dispatchEvent(r)}},{key:"handleEvent",value:function(e){if("function"==typeof this._pre_handleEvent){if(!1===this._pre_handleEvent(e))return}else this.debug("no handle event pre found. skip");"function"==typeof this["_handle_"+e.type]&&(this.debug("handling "+e.type),this["_handle_"+e.type](e)),"function"==typeof this._post_handleEvent&&this._post_handleEvent(e)}},{key:"debug",value:function(){this.DEBUG?this.TRACE:window.DUMP&&DUMP("["+this.name+"]"+Array.slice(arguments).concat())}}]),t}(v.a)},function(e,t,i){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return u(e)||c(e,t)||s(e,t)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function c(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}}function u(e){if(Array.isArray(e))return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=m();return function(){var i,n=b(e);if(t){var r=b(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return y(this,i)}}function y(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var w=i(2),S=i(0),k=i(1),P=function(e){function t(){var e;return l(this,t),e=i.call(this),e.types={pick:"pick",record:"record"},e.name=null,e.setupListener(),e}d(t,e);var i=p(t);return f(t,[{key:"setupListener",value:function(){var e=this;navigator.serviceWorker.addEventListener("message",function(t){e.onMessage(t.data)})}},{key:"onMessage",value:function(e){var t=e,i=e.source;if(i){this.name=i.name;if(this.types[this.name]){var n={name:this.name,maxPixelSize:this.getMaxPixelSize(t),maxFileSizeBytes:t.source.data.maxFileSizeBytes};this.activity=t,this.configureMode(t),"record"===this.name&&this.configureCamera(t),S.a.setMaxFileSize(n.maxFileSizeBytes),k.default.setMaxPixelSize(n.maxPixelSize),k.default.setMaxFileSize(n.maxFileSizeBytes)}}}},{key:"getMaxPixelSize",value:function(e){var t=e.source.data,i=t.maxFileSizeBytes;return i?this.bytesToPixels(i):t.width||t.height?this.getMaxPixelsFromSize(t):0}},{key:"bytesToPixels",value:function(e){var t=window.CONFIG_AVG_JPEG_COMPRESSION_RATIO||8,i=e*t;return Math.round(i/3)}},{key:"getMaxPixelsFromSize",value:function(e){return(e.width||e.height*(4/3))*(e.height||e.width*(4/3))*2.5}},{key:"configureMode",value:function(e){var t=e.source.data.type,i=this.name,n="pick"===i?this.getModesForPick(t):this.getModesForRecord(t),o=r(n,1);this.mode=o[0],k.default.settings.mode.filterOptions(n),k.default.settings.mode.select(n[0])}},{key:"configureCamera",value:function(e){var t=e.source.data.camera;t||(t="back"),k.default.settings.cameras.select(t)}},{key:"getModesForPick",value:function(e){var t=this;e=[].concat(e||[]);var i=[];return e.forEach(function(e){var n=e.split("/"),o=r(n,1),s=o[0],a=null;"video"===s?a="video":"image"===s?a="picture":"wallpaper"===s&&(t.caller="wallpaper"),a&&-1===i.indexOf(a)&&i.push(a)}),0===i.length&&(i=["picture","video"]),i}},{key:"getModesForRecord",value:function(e){e=[].concat(e||[]);var t=[];return e.forEach(function(e){var i="photos"===e?"picture":"video";-1===t.indexOf(i)&&t.push(i)}),0===t.length&&(t=["picture","video"]),t}},{key:"onActivityExit",value:function(){this.activity&&navigator.serviceWorker.controller.postMessage({isError:!0})}},{key:"closeWindow",value:function(){clearInterval(window.keepSWStateInterval),window.close()}}]),t}(w.a),z=new P;t.default=z},,function(e,t,i){"use strict";var n={_providers:new Map,_services:new Map,_requestsByService:new Map,_requestsByProvider:new Map,request:function(e){var t=e.split(":"),i=Array.prototype.slice.call(arguments,1),n=this;if(this.debug(t),t.length>1){var r=t[0],o=t[1];return this._providers.get(r)?(this.debug("service: "+o+" is online, perform the request with "+i.concat()),Promise.resolve(this._providers.get(r)[o].apply(n._providers.get(r),i))):new Promise(function(t,s){n.debug("service: "+e+" is offline, queue the task."),n._requestsByProvider.has(r)||n._requestsByProvider.set(r,[]),n._requestsByProvider.get(r).push({service:o,resolve:t,args:i})})}if(this._services.has(e)){var s=this._services.get(e);return this.debug("service ["+e+"] provider ["+s.name+"] is online, perform the task."),Promise.resolve(s[e].apply(s,i))}return this.debug("service: "+e+" is offline, queue the task."),new Promise(function(t,r){n.debug("storing the requests..."),n._requestsByService.has(e)||n._requestsByService.set(e,[]),n._requestsByService.get(e).push({service:e,resolve:t,args:i})})},register:function(e,t){var i=this;if(this._providers.has(t.name)||this._providers.set(t.name,t),this.debug((t.name||"(Anonymous)")+" is registering service: ["+e+"]"),this.debug("checking awaiting requests by server.."),this._requestsByProvider.has(t.name)&&(this._requestsByProvider.get(t.name).forEach(function(e){i.debug("resolving..",t,t.name,e.service,e.args);var n="function"==typeof t[e.service]?t[e.service].apply(t,e.args):t[e.service];e.resolve(n)}),this._requestsByProvider.delete(t.name)),this._services.has(e))return void this.debug("the service ["+e+"] has already been registered by other server:",this._services.get(e).name);this._services.set(e,t),this.debug("checking awaiting requests by service.."),this._requestsByService.has(e)&&(this._requestsByService.get(e).forEach(function(e){i.debug("resolving..",t,e.service);var n=t[e.service].apply(t,e.args);e.resolve(n)}),this._requestsByService.delete(e))},unregister:function(e,t){this._providers.delete(t.name);var i=this._services.get(e);i&&t===i&&this._services.delete(e)},_states:new Map,_statesByState:new Map,registerState:function(e,t){this._states.set(t.name,t),t.name,this._statesByState.set(e,t)},unregisterState:function(e,t){this._states.delete(t.name),this._statesByState.get(e)===t&&this._statesByState.delete(e)},query:function(e){this.debug(e);var t,i,n=e.split(".");if(n.length>1?(i=this._states.get(n[0]),t=n[1]):(t=n[0],i=this._statesByState.get(t)),!i)return void this.debug("Provider not ready, return undefined state.");if("function"==typeof i[t]){var r=Array.prototype.slice.call(arguments,1);return i[t].apply(i,r)}return i[t]},_start:(new Date).getTime()/1e3,currentTime:function(){return((new Date).getTime()/1e3-this._start).toFixed(3)},debug:function(){}};t.a=n},function(e,exports){},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function s(e){if(!e||"string"!=typeof e)throw new Error("Event name should be a valid non-empty string!")}function a(e){if("function"!=typeof e)throw new Error("Handler should be a function!")}i.d(t,"a",function(){return c});var c=function(){function e(){n(this,e),this.listeners=new Map}return o(e,[{key:"on",value:function(e,t){s(e),a(t);var i=this.listeners.get(e);i||(i=new Set,this.listeners.set(e,i)),i.add(t)}},{key:"off",value:function(e,t){s(e),a(t);var i=this.listeners.get(e);i&&(i.delete(t),i.size||this.listeners.delete(e))}},{key:"offAll",value:function(e){if(void 0===e)return void this.listeners.clear();s(e);var t=this.listeners.get(e);t&&(t.clear(),this.listeners.delete(e))}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];s(e);var r=this.listeners.get(e);r&&r.forEach(function(e){try{e.apply(null,i)}catch(e){}})}}]),e}()},function(e,t,i){"use strict";var n={globals:{CONFIG_MAX_IMAGE_PIXEL_SIZE:5242880,CONFIG_MAX_SNAPSHOT_PIXEL_SIZE:5242880,CONFIG_REQUIRED_EXIF_PREVIEW_WIDTH:0,CONFIG_REQUIRED_EXIF_PREVIEW_HEIGHT:0},viewfinder:{scaleType:"fill"},sounds:{list:[{name:"shutter",url:"./resources/sounds/shutter.ogg",setting:"camera.sound.enabled"},{name:"timer",url:"./resources/sounds/timer.opus",setting:"camera.sound.enabled"},{name:"recordingStart",url:"./resources/sounds/camcorder_start.ogg",setting:"camera.sound.enabled"},{name:"recordingEnd",url:"./resources/sounds/camcorder_end.ogg",setting:"camera.sound.enabled"}]},activity:{maxPixelSizeScaleFactor:2.5,maxPickPixelSize:0,maxSharePixelSize:0}};t.a=n},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}Object.defineProperty(t,"__esModule",{value:!0});var s=i(6),a=(i.n(s),i(0)),c=function(){function e(){n(this,e)}return o(e,[{key:"start",value:function(){var e=this;if(!navigator.b2g.cameras)return void i.e(0).then(i.bind(null,4));window.addEventListener("visibilitychange",function(){document.hidden&&(a.a.recording||a.a.release()),a.a.sendEvt("visiblechange")}),"#activity"===window.location.hash?(window.keepSWStateInterval=setInterval(function(){navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({isDummy:!0})},3e5),navigator.serviceWorker.addEventListener("message",function(t){new Promise(function(e){e()}).then(i.bind(null,3)).then(function(i){window.Activity=i.default,window.Activity.onMessage(t.data),a.a.setMode(window.Activity.mode),a.a.load(),e.showView()})})):(a.a.load(),window.addEventListener("DOMContentLoaded",this)),a.a.on("configured",this.onConfigured.bind(this)),this.previewStateChange=this.onPreviewStateChange.bind(this),a.a.on("previewChanged",this.previewStateChange),this.content=document.querySelector("#ssr"),this.video=document.querySelector("#viewfinder-video"),this.frame=document.querySelector("#frame"),this.videoContainer=document.querySelector("#video-container")}},{key:"handleEvent",value:function(e){"DOMContentLoaded"===e.type&&(window.removeEventListener("DOMContentLoaded",this),this.showView())}},{key:"setFlashModeIcon",value:function(e){var t=localStorage.getItem("setting:flashModesPicture"),i=document.querySelector(".flash-mode-icon");if(!window.Activity&&i){if(!t&&e.flashModes.length>1)return void(i.dataset.icon="flash-auto");switch(t){case"on":i.dataset.icon="flash-on";break;case"auto":i.dataset.icon="flash-auto";break;case"off":i.dataset.icon=""}}}},{key:"showView",value:function(){var e=this,t=document.createElement("div");if(t.innerHTML='<div id="indicators">\n         <div class="mode-icon flash-mode-display">\n          <div class="flash-mode-icon"></div>\n        </div>\n          <div class="mode-icon photo-mode-icon current-mode">\n          </div>\n          <div class="mode-icon video-mode-icon">\n          </div>\n        </div>\n\n        <div class="zoom-bar">\n          <div class="zoom-bar-slider">\n            <div class="zoom-in-out zoom-in-display"></div>\n            <gaia-slider id="slider" transparent="true"></gaia-slider>\n            <div class="zoom-in-out zoom-out-display"></div>\n          </div>\n        </div>\n\n        <div class="controls">\n          <div class="controls-left hidden">\n            <div class="mode-cancel sk-button" data-l10n-id="cancel"></div>\n          </div>\n          <div class="controls-middle">\n            <div class="capture-button test-capture rotates js-capture"\n              data-icon="shutter" name="capture">\n            </div>\n            <div class="video-button hidden">\n              <div class="button" data-icon="recording"></div>\n            </div>\n          </div>\n          <div class="controls-right">\n            <div class="mode-options sk-button" name="options"\n              data-l10n-id="options"></div>\n          </div>\n        </div>\n      ',window.Activity&&window.Activity.name)"pick"===window.Activity.name&&t.querySelector(".controls-left").classList.remove("hidden"),new Promise(function(e){e()}).then(i.bind(null,1)).then(function(i){var n=i.default.settings.mode.get("options");"video"===i.default.settings.mode.get("selected")&&(t.querySelector(".capture-button").classList.add("hidden"),t.querySelector(".video-button").classList.remove("hidden")),1===n.length&&(t.querySelector(".video-mode-icon").classList.add("hidden"),t.querySelector(".photo-mode-icon").classList.add("hidden")),e.content.appendChild(t),document.getElementById("slider").value=0});else{this.content.appendChild(t);document.getElementById("slider").value=0}}},{key:"onConfigured",value:function(e){this.setFlashModeIcon(e),a.a.loadStreamInto(this.video),this.configurePreview(),this.load(),a.a.offAll("configured")}},{key:"onPreviewStateChange",value:function(e){"started"===e&&(window.performance.mark("visuallyLoaded"),a.a.off("previewChanged",this.previewStateChange))}},{key:"load",value:function(e){window.setTimeout(function(){i.e(0).then(i.bind(null,4))},e)}},{key:"configurePreview",value:function(){var e=a.a.getSensorAngle(),t="video"===a.a.mode?a.a.getRecorderProfile().video.size:a.a.previewSize(),i="front"===a.a.selectedCamera;this.updatePreview(t,e,i)}},{key:"updatePreview",value:function(e,t,i){e&&(this.width=window.innerWidth,this.height=window.innerHeight,this.container=t%180==0?{width:this.width,height:this.height,aspect:this.width/this.height}:{width:this.height,height:this.width,aspect:this.height/this.width},this.updatePreviewMetrics(e,{sensorAngle:t,mirrored:i}))}},{key:"scaleSizeToFillViewport",value:function(e,t){var i=e.width/t.width,n=e.height/t.height,r=Math.max(i,n);return{width:t.width*r,height:t.height*r}}},{key:"updatePreviewMetrics",value:function(e,t){var i=this.scaleSizeToFillViewport(this.container,e),n={width:i.height,height:i.width};-1===screen.orientation.type.indexOf("portrait")?(this.frame.style.width="".concat(i.width,"px"),this.frame.style.height="".concat(i.height,"px")):(this.frame.style.width="".concat(n.width,"px"),this.frame.style.height="".concat(n.height,"px"));var r="";t.mirrored&&(r+="scale(-1, 1) "),r+="rotate(".concat(t.sensorAngle,"deg)"),this.videoContainer.style.width="".concat(i.width,"px"),this.videoContainer.style.height="".concat(i.height,"px"),this.videoContainer.style.transform=r,"fill"!==t.scaleType&&this.frame.innerHTML.replace("fill",t.scaleType)}}]),e}(),u=new c;u.start(),window._app=u},function(e,t,i){"use strict";var n={mode:{title:"switch-modes",icon:"camera-switch-mode",options:[{key:"picture",title:"photo-mode"},{key:"video",title:"video-mode"}],persistent:!1},cameras:{title:"switch-camera",icon:"camera-switch",options:[{key:"back",title:"toggle-camera-rear-button"},{key:"front",title:"toggle-camera-front-button"}],persistent:!1},pictureSizesFront:{title:"camera-resolution",header:"camera-resolution-header",icon:"video-resolution",support:[{aspects:["4:3"]}],selected:"high",persistent:!0,optionsLocalizable:!1},pictureSizesBack:{title:"camera-resolution",header:"camera-resolution-header",icon:"video-resolution",support:[{aspects:["4:3"]}],selected:"high",persistent:!0,optionsLocalizable:!1},recorderProfilesBack:{title:"video-resolution",header:"video-resolution-header",icon:"video-resolution",options:[{key:"qcif"},{key:"cif"},{key:"480p"}],persistent:!0,optionsLocalizable:!1},recorderProfilesFront:{title:"video-resolution",header:"video-resolution-header",icon:"video-resolution",options:[{key:"qcif"},{key:"cif"},{key:"480p"},{key:"qvga"}],persistent:!0,optionsLocalizable:!1},flashModesPicture:{title:"flash",header:"flash",icon:"flash-on",options:[{key:"auto",icon:"flash-auto",title:"flash-auto"},{key:"on",icon:"flash-on",title:"flash-on"},{key:"off",icon:"flash-off",title:"flash-off"}],persistent:!0},flashModesVideo:{title:"flash",header:"flash",icon:"flash-on",options:[{key:"off",icon:"flash-off",title:"flash-off"},{key:"torch",icon:"flash-on",title:"flash-on"}],persistent:!1},timer:{title:"self-timer",header:"self-timer-header",icon:"self-timer",options:[{key:"off",title:"self-timer-off",value:0},{key:"secs3",value:3,title:"self-timer-3-seconds"},{key:"secs5",value:5,title:"self-timer-5-seconds"},{key:"secs10",value:10,title:"self-timer-10-seconds"}],persistent:!1},grid:{title:"grid",header:"grid-header",icon:"grid",options:[{key:"off",title:"grid-off"},{key:"on",title:"grid-on"}],selected:0,persistent:!0},video:{title:"video",icon:"video-player",options:[{key:"video",title:"video-option",forward:!0}]},gallery:{title:"gallery",icon:"gallery",options:[{key:"gallery",title:"gallery-option",forward:!0}]},settingsMenuPhoto:{items:[{key:"cameras"},{key:"flashModesPicture"},{key:"pictureSizes"},{key:"timer"},{key:"grid"},{key:"gallery"},{key:"mode"}]},settingsMenuVideo:{items:[{key:"cameras"},{key:"flashModesVideo"},{key:"recorderProfiles"},{key:"video"},{key:"mode"}]}};t.a=n},function(e,t,i){"use strict";var n=function(e,t){function i(e,t){return Math.round(e*t/1e6)}function n(e,t){var i=function e(t,i){return 0===i?t:e(i,t%i)}(e,t);return"".concat(e/i,":").concat(t/i)}var r=t&&t.maxPixelSize,o=t&&t.support,s=[],a=[],c=[];return e.forEach(function(e){var t=e.width,a=e.height,u="".concat(t,"x").concat(a),l=t*a,h=!1,f=[];if(e.aspect=n(t,a),!(l<76800||r&&l>r)){if(o.forEach(function(t){f=t.aspects,t.aspects&&t.aspects.forEach(function(t){-1!==t.indexOf(e.aspect)&&(h=!0)})}),!h)return void c.push({key:u,aspects:f,pixelSize:l,data:e});e.mp=i(t,a),s.push({key:u,aspects:f,pixelSize:l,data:e})}}),s.length<=0&&(c.sort(function(e,t){return e.pixelSize-t.pixelSize}),c[0].pixelSize>r?s.push(c[0]):s.push(c[c.length-1])),s.sort(function(e,t){return e.pixelSize-t.pixelSize}),s[0].title="low-resolution",s[0].key="low",a.push(s[0]),2===s.length&&(s[s.length-1].title="standard-resolution",s[s.length-1].key="medium",a.push(s[s.length-1])),s.length>=3&&(s[s.length-2].title="standard-resolution",s[s.length-2].key="medium",a.push(s[s.length-2]),s[s.length-1].title="high-resolution",s[s.length-1].key="high",a.push(s[s.length-1])),a};t.a=n},function(e,t,i){"use strict";var n=function(e,t){var i=t,n=[],r=[],o=null,s=null,a=null;for(var c in e)!function(t){s=e[t],a=s.video,i.forEach(function(e){if(e.key!==t)return!1;o=a.width*a.height,n.push({key:t,title:"".concat(t," ").concat(a.width,"x").concat(a.height),pixelSize:o,raw:s})})}(c);return n.sort(function(e,t){return e.pixelSize-t.pixelSize}),n[0].title="low-resolution",r.push(n[0]),2===n.length&&(n[n.length-1].title="standard-resolution",r.push(n[n.length-1])),n.length>=3&&(n[n.length-2].title="standard-resolution",r.push(n[n.length-2]),n[n.length-1].title="high-resolution",r.push(n[n.length-1])),r};t.a=n}]);
//# sourceMappingURL=bundle.js.map