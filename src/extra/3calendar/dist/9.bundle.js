(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{623:function(e,t,n){var a=n(624);"string"==typeof a&&(a=[[e.i,a,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(66)(a,o);a.locals&&(e.exports=a.locals)},624:function(e,t,n){(e.exports=n(65)(!1)).push([e.i,".agendaView {\n  display: flex;\n  width: 100%;\n  background-color: var(--color-gs00);\n  color: var(--color-gs00);\n  flex-direction: column;\n  overflow: auto;\n  position: absolute;\n  height: 23.6rem; }\n\n.agenda-event {\n  height: 5rem;\n  width: 21.6rem;\n  padding: 1rem;\n  border-left: 0.4rem solid var(--highlight-color); }\n\n.agenda-event.focus {\n  border-left-color: var(--color-gs10); }\n\n.event-title {\n  line-height: normal;\n  margin-bottom: 0.5rem;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  padding-right: 2rem; }\n\n.event-reminder-icon {\n  right: 0.5rem;\n  height: 1.6rem;\n  width: 1.6rem;\n  font-size: 1.6rem;\n  color: var(--highlight-color); }\n\n.focus .event-reminder-icon {\n  color: var(--color-gs00); }\n\n.event-start-datetime {\n  line-height: 136%;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  display: block; }\n\n#agenda .agenda-events {\n  height: 23.6rem;\n  overflow-y: scroll; }\n\n#agenda .event-text {\n  display: flex;\n  justify-content: space-between;\n  width: 22rem; }\n",""])},632:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n(0),o=n(162),r=n.n(o),i=n(3),l=n.n(i),s=n(18),c=n.n(s),u=n(92),d=n.n(u),f=n(45),v=n.n(f),h=n(11),p=n(21),g=n(2),m=n(51),E=n(26),w=n(95),y=n(599);n(623);function D(e,t,n,a,o,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function S(e){return function(){var t=this,n=arguments;return new Promise(function(a,o){var r=e.apply(t,n);function i(e){D(r,a,o,i,l,"next",e)}function l(e){D(r,a,o,i,l,"throw",e)}i(void 0)})}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=a.default.createElement("span",{className:"event-reminder-icon","data-icon":"reminder","aria-hidden":"true"}),C=function(e){var t,n;function o(t){var n;O(b(n=e.call(this,t)||this),"logger",new w.a("AgendaView","trace")),O(b(n),"node",void 0),O(b(n),"FOCUS_SELECTOR",".agenda-focus"),O(b(n),"updateSoftkey",function(){p.a.register({left:"delete",center:"select",right:"edit"},document)}),O(b(n),"focus",function(){n.updateSoftkey()}),O(b(n),"optionClosed",function(){n.updateSoftkey()}),O(b(n),"handleKeydown",function(e){var t=null;switch(e.key){case"Enter":e.stopPropagation(),e.preventDefault(),n.handlKeydownClick();break;case"ArrowUp":e.stopPropagation(),e.preventDefault(),t=n.findNext(-1);break;case"ArrowDown":e.stopPropagation(),e.preventDefault(),t=n.findNext(1);break;case"Backspace":e.stopPropagation(),e.preventDefault(),m.a.go(-1);break;case"SoftLeft":e.stopPropagation(),e.preventDefault(),n.handleClickSoftLeft();break;case"SoftRight":e.stopPropagation(),e.preventDefault(),n.modifyEventshow()}n.changeFocusItem(t)}),O(b(n),"changeFocusItem",function(e){if(e){var t=n.element.querySelector(n.FOCUS_SELECTOR+".focus");t&&t.classList.remove("focus"),e.scrollIntoView(!1),e.classList.add("focus"),e.focus()}}),O(b(n),"buildOptionMenuItems",function(){n.optionItems={delAllItem:{id:"delete-all-events",callback:function(){n.handleOptionMenu("allEvent")}},delAllFutureItem:{id:"delete-all-future-events",callback:function(){n.handleOptionMenu("futureEvent")}}}}),O(b(n),"showDelOptions",function(){var e=[];e.push(n.optionItems.delAllItem),e.push(n.optionItems.delAllFutureItem),h.a.request("showOptionMenu",{options:e})}),O(b(n),"showDelEventDialg",function(e){Object(g.P)({header:"delete",type:"confirm",cancel:"cancel",ok:"delete",content:"deleteEvent-confirmation",onCancel:n.delEventCancel,onBack:n.delEventCancel,onOk:function(){n.delEvent(e)}})}),O(b(n),"showDelDialog",function(e){n.showDelEventDialg(e)}),O(b(n),"handleClickSoftLeft",function(){if(Object(g.G)("left")){var e=JSON.parse(n.element.querySelector(".focus").dataset.event);"never"!==e.repeat?n.showDelOptions(e):n.showDelDialog(e)}}),O(b(n),"fetchAgendaEvents",function(){var e=S(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(g.t)(E.a.arrangeEvents),e.next=3,n.setState({arrangeEvents:a});case 3:t<0&&setTimeout(function(){n.focusEvent()},0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),O(b(n),"gotoToday",function(){var e=new Date;o.postProcessGotoDate(e)}),O(b(n),"handleLocalize",function(){n.logger.info("get lan changed event!!!!!!"),n.forceUpdate()});var a=window.agendaScrollTop,r=Object(g.t)(E.a.arrangeEvents);return void 0===a&&(window.agendaScrollTop=-1),n.state={arrangeEvents:r},n.buildOptionMenuItems(),n.handleKeydown=n.handleKeydown.bind(b(n)),n.delEvent=n.delEvent.bind(b(n)),n.delEventCancel=n.delEventCancel.bind(b(n)),n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.postProcessGotoDate=function(e){r()(window.selectedDate,e)||(E.a.pullAllLocalEvents(e),E.a.pullRemoteEvents(e,!1)),Object(g.N)(e);var t=document.getElementById(l()(e,"MMMM D"));t&&t.scrollIntoView({inline:"center",behavior:"smooth"})};var i=o.prototype;return i.componentDidMount=function(){var e=S(regeneratorRuntime.mark(function e(){var t,n,a,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=window,n=t.agendaScrollTop,this.initAllEvents(),this.element.focus(),(a=this.element.querySelector(this.FOCUS_SELECTOR+".agenda-event"))&&(a.classList.add("focus"),a.focus()),this.updateSoftkey(),n<0?setTimeout(function(){o.focusEvent()},0):(window.agendaScrollTop=-1,this.node.scrollTop=n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),i.componentDidUpdate=function(){var e=this.element.querySelector(this.FOCUS_SELECTOR+".agenda-event.focus"),t=this.element.querySelectorAll(this.FOCUS_SELECTOR+".agenda-event");0===t.length?m.a.go(-1):e||((e=t[t.length-1]).classList.add("focus"),e.focus()),this.updateSoftkey()},i.componentWillUnmount=function(){this.removeAllEvents()},i.handlKeydownClick=function(){var e=this.element.querySelector(".focus");e&&e.click()},i.findNext=function(e){var t=Array.from(this.element.querySelectorAll(this.FOCUS_SELECTOR));if(!t.length)return null;var n=this.element.querySelector(this.FOCUS_SELECTOR+".focus")||t[0],a=-1;return t.some(function(o,r){return o===n&&(a=(r+t.length+e)%t.length,!0)}),-1===a?null:t[a]},i.getEventByDataset=function(){var e=JSON.parse(this.element.querySelector(".focus").dataset.event);return e.busytimeSDate=new Date(e.busytimeSDate),e.busytimeEDate=new Date(e.busytimeEDate),e.repeatSDate=e.repeatSDate?new Date(e.repeatSDate):e.repeatSDate,e.repeatEDate=e.repeatEDate?new Date(e.repeatEDate):e.repeatEDate,e},i.handleOptionMenu=function(e){var t=this.getEventByDataset(),n=e;t.busytimeSDate.valueOf()===t.repeatSDate.valueOf()&&(n="allEvent"),E.a.del(t,n),m.a.go(-1)},i.showNoInternetDialog=function(){Object(g.P)({header:"dialog-title-error",type:"alert",ok:"dialog-button-ok",content:"dialog-delete-event-message",onOk:this.updateSoftkey})},i.delEvent=function(e){"calendar-local"===e.account||Object(g.H)()?E.a.del(e):this.showNoInternetDialog()},i.delEventCancel=function(){this.updateSoftkey()},i.modifyEventshow=function(){if(Object(g.G)("right")){var e=JSON.parse(this.element.querySelector(".focus").dataset.event);m.a.push("/modifyEvent",{item:e})}},i.getFocusElement=function(e){var t=document.getElementById("agendaView");if(!t||0===t.children.length)return null;for(var n=parseInt(e.substring(e.length-2,e.length),10),a=0;a<t.children.length;a++){var o=t.children[a].id;if(parseInt(o.substring(o.length-2,o.length),10)>=n)return t.children[a]}return null},i.handleEventClick=function(e){m.a.push("/eventDetails",{event:e})},i.initAllEvents=function(){E.a.on("fetch-events-success",this.fetchAgendaEvents),window.addEventListener("localized",this.handleLocalize),TimeService.addEventListener("timeChange",this.gotoToday),document.addEventListener("keydown",this.handleKeydown),h.a.register("focus",this),h.a.register("optionClosed",this)},i.removeAllEvents=function(){E.a.removeListener("fetch-events-success",this.fetchAgendaEvents),window.removeEventListener("localized",this.handleLocalize),TimeService.removeEventListener("timeChange",this.gotoToday),document.removeEventListener("keydown",this.handleKeydown),h.a.unregister("focus",this),h.a.unregister("optionClosed",this)},i.focusEvent=function(){var e=this.props.location.state.id,t=document.getElementById(e);t||(t=this.getFocusElement(e)),t&&t.scrollIntoView({inline:"center",behavior:"smooth"})},i.renderAgendaEvents=function(e){var t=this,n=window.selectedDate,o=[];return e.forEach(function(e){var r=e.title?e.title:Object(g.a)("event-no-title"),i=Object(g.C)(e,n),l=a.default.createElement("li",{className:"agenda-event agenda-focus",tabIndex:"-1",role:"menuitem","data-event":JSON.stringify(e),onClick:function(){t.handleEventClick(e)}},a.default.createElement("div",{className:"event-text"},a.default.createElement("span",{className:"event-title p-pri"},r),k),a.default.createElement("span",{className:"event-start-datetime p-sec"},i));o.push(l)}),o},i.isShowEvent=function(e,t){var n=window.selectedDate,a=new Date(n.valueOf());a=new Date(a.setHours(t,0,0,0));var o=new Date(a.valueOf()+36e5),r=e.busytimeSDate,i=e.busytimeEDate,l=!1;return!e.allDayEvent&&(i>a&&i<o||r>a&&r<o||r<a&&i>o||r>=a&&i<=o)&&(l=!0),l},i.getMutilEvents=function(e){var t=this,n=window.selectedDate,o=d()(e,function(e){return v()(e.day,n)}),r=[],i=!1;if(!c()(o)&&o.dayEvents.length>0){i=!0;var l=this.props.location,s=l.state.hour;l.state.allDay?o.dayEvents.forEach(function(e){e.allDayEvent&&r.push(e)}):s>=0&&s<=23?o.dayEvents.forEach(function(e){t.isShowEvent(e,s)&&r.push(e)}):r=o.dayEvents}return i?a.default.createElement("div",{className:"agenda-events"},this.renderAgendaEvents(Object(g.R)(r))):(m.a.go(-1),null)},i.render=function(){var e=this,t=this.state.arrangeEvents;return a.default.createElement("div",{id:"agenda",tabIndex:"-1",role:"heading","aria-labelledby":"settings",ref:function(t){e.element=t}},a.default.createElement(y.a,{view:"settings",headerStr:Object(g.a)("agenda-view-header")}),this.getMutilEvents(t))},o}(a.default.Component)}}]);