class PairManager{constructor(){this._debug=!0,this.defaultAdapter=null,this.deviceName=null,this.childWindow=null}init(){this.defaultAdapter=AdapterManager.defaultAdapter,this.watchOndisplaypasskeyreq(),this.watchOnenterpincodereq(),this.watchOnpairingconfirmationreq(),this.watchOnpairingconsentreq(),this.watchOnpairingaborted(),AdapterManager.observe("defaultAdapter",this.onDefaultAdapterChanged.bind(this))}onDefaultAdapterChanged(e){(this.defaultAdapter=e)&&(this.watchOndisplaypasskeyreq(),this.watchOnenterpincodereq(),this.watchOnpairingconfirmationreq(),this.watchOnpairingconsentreq(),this.watchOnpairingaborted())}watchOndisplaypasskeyreq(){this.defaultAdapter&&this.defaultAdapter.pairingReqs?this.defaultAdapter.pairingReqs.ondisplaypasskeyreq=this.onDisplayPasskey.bind(this):this.debug("watchOndisplaypasskeyreq() no adapter or pairingReqs")}onDisplayPasskey(e){this.debug("onDisplayPasskey()"),this.handlePairingRequest({method:"displaypasskey",evt:e})}watchOnenterpincodereq(){this.defaultAdapter&&this.defaultAdapter.pairingReqs?this.defaultAdapter.pairingReqs.onenterpincodereq=this.onEnterPincode.bind(this):this.debug("watchOnenterpincodereq() no adapter or pairingReqs")}onEnterPincode(e){this.debug("onEnterPincode()"),this.handlePairingRequest({method:"enterpincode",evt:e})}watchOnpairingconfirmationreq(){this.defaultAdapter&&this.defaultAdapter.pairingReqs?this.defaultAdapter.pairingReqs.onpairingconfirmationreq=this.onPairingConfirmation.bind(this):this.debug("watchOnpairingconfirmationreq() no adapter or pairingReqs")}onPairingConfirmation(e){this.debug(`onPairingConfirmation: evt = ${JSON.stringify(e)}`),this.handlePairingRequest({method:"confirmation",evt:e})}watchOnpairingconsentreq(){this.defaultAdapter&&this.defaultAdapter.pairingReqs?this.defaultAdapter.pairingReqs.onpairingconsentreq=this.onPairingConsent.bind(this):this.debug("watchOnpairingconsentreq() no adapter or pairingReqs")}onPairingConsent(e){this.debug(`onPairingConsent: evt = ${JSON.stringify(e)}`),this.handlePairingRequest({method:"consent",evt:e})}watchOnpairingaborted(){this.defaultAdapter&&(this.defaultAdapter.onpairingaborted=this.onPairingAborted.bind(this))}onPairingAborted(e){this.debug(`onPairingAborted(): evt = ${JSON.stringify(e)}`),this.unregisterAllEvent(),window.close()}watchDefaultAdapterOndevicepaired(){this.defaultAdapter&&(this.defaultAdapter.ondevicepaired=this.onAdapterDevicepaired.bind(this))}onAdapterDevicepaired(e){this.debug(`onAdapterDevicepaired evt = ${e.device.name}`),this.showToast("paired-with-device",{deviceName:this.deviceName}),this.unregisterAllEvent()}handlePairingRequest(e){this.debug(`handlePairingRequest(): pairingInfo.method = ${e.method} pairingInfo.evt = ${e.evt}`),this.showPairview(e)}showPairview(e){this.debug("showPairview()");const i=window.api.l10n.get;this.deviceName=e.evt.deviceName||i("unnamed-device");const t=new Pairview;t.start(e.method,e.evt)}unregisterAllEvent(){this.defaultAdapter.ondevicepaired=null,this.defaultAdapter.onpairingaborted=null,this.defaultAdapter.pairingReqs.onpairingconsentreq=null,this.defaultAdapter.pairingReqs.ondisplaypasskeyreq=null,this.defaultAdapter.pairingReqs.onpairingconfirmationreq=null,this.defaultAdapter.pairingReqs.onenterpincodereq=null}showToast(e,i){i={messageL10nId:e,messageL10nArgs:i,latency:2e3,useTransition:!0};this.debug("show Toast "),Toaster.showToast(i)}onBluetoothDisabled(){this.debug("onBluetoothDisabled():"),this.childWindow&&this.childWindow.close()}debug(e){this._debug}}