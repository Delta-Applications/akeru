(window.webpackJsonp=window.webpackJsonp||[]).push([[3,5],{34:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return r})),i.d(t,"f",(function(){return l})),i.d(t,"a",(function(){return c})),i(3);const s=(e,t)=>{let i;return(...s)=>{const n=!i;return window.clearTimeout(i),i=window.setTimeout(()=>{i=null},e),n&&t(...s),i}},n=({callType:e,simNum:t})=>{let i="call";-1!==e.indexOf("rttCall")?i="call-rtt":-1!==e.indexOf("videoCall")&&(i="video-call");const s=(()=>{const{iccManager:e}=window.navigator.b2g;return e&&e.iccIds.length>1})()?t:"";return`${i}-${e.split("_")[0]}${s}`},a=e=>{const t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()},o=e=>{const{get:t}=window.api.l10n,i=(a(Date.now())-a(e))/1e3,s=Math.floor(i/86400),n=new Date(e),o=(new Date).getFullYear()===n.getFullYear(),r=navigator.language;return 0===s?t("today"):1===s?t("yesterday"):s<7&&s>1?n.toLocaleString(r,{weekday:"long"}):o?n.toLocaleString(r,{weekday:"short",month:"long",day:"numeric"}):n.toLocaleString(r,{weekday:"short",year:"numeric",month:"short",day:"numeric"})},r=()=>document.body.classList.contains("low-memory-device"),l=()=>DeviceCapabilityManager.get("device.parental-control").then(e=>!!e),c=()=>{document.hidden||navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({name:"clearNotices"})}},35:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return n})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o}));const s=()=>!(!ContactsManager||!ContactsManager.findBlockedNumbers),n=e=>e?ContactsManager.addBlockedNumber(e):Promise.reject(new TypeError("Invalid number")),a=e=>e?ContactsManager.removeBlockedNumber(e):Promise.reject(new TypeError("Invalid number")),o=e=>{const t={filterValue:e,filterOption:ContactsManager.FilterOption.MATCH};return ContactsManager.findBlockedNumbers(t).then(e=>!(!e||!e.length))}},36:function(e,t,i){"use strict";var s=i(9);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t.a=new class extends s.a{constructor(){super(),n(this,"getSimCardIndex",()=>this.cardIndex),n(this,"getDefaultSimCardIndex",()=>{let e=this.cardIndex;return-1===e&&(e=0,this.hasOnlyOneSIMCardDetected()&&(e=this.isSIMCardAbsent(0)?1:0)),e}),n(this,"isSIMCardAbsent",e=>{const t=navigator.b2g.mobileConnections[e];if(!this.iccManager||!t)return!0;const i=this.iccManager.getIccById(t.iccId);return!i||i&&i.iccInfo&&null===i.iccInfo.iccid}),n(this,"hasOnlyOneSIMCardDetected",()=>this.isSIMCardAbsent(0)^this.isSIMCardAbsent(1)),this.iccManager=window.navigator.b2g.iccManager,this.multipleSIMs=this.iccManager&&this.iccManager.iccIds.length>1,this.cardIndex=-1,this.getCardIndex()}getCardIndex(){SettingsObserver.observe("ril.telephony.defaultServiceId",-1,e=>{this.cardIndex=e,this.emit("update")})}showSimIndicator(){return this.multipleSIMs&&this.cardIndex>=0}}},37:function(e,t,i){"use strict";const s={voicemailNumbers:"",init:function(){SettingsObserver.observe("ril.iccInfo.mbdn","",e=>{this.voicemailNumbers=e,window.calllogStore&&window.calllogStore.emit("update")})},check:function(e,t){if(!e)return!1;let{voicemail:i}=window.navigator.b2g;return!(!i||i.getNumber(t)!==e)||("string"==typeof this.voicemailNumbers?this.voicemailNumbers===e:!!this.voicemailNumbers&&this.voicemailNumbers[t]===e)}};s.init(),t.a=s},38:function(e,t,i){"use strict";var s=i(0),n=i.n(s),a=({isWifiLogo:e,radioTech:t})=>{let i=null;return"ps"===t&&(i=n.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"32px",height:"10px",viewBox:"0 0 32 10",version:"1.1"},n.a.createElement("title",null,"ic_lte_badge"),n.a.createElement("g",{id:"ic_lte_badge",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.a.createElement("rect",{id:"Rectangle",fill:"#000000",x:"3",y:"0",width:"26",height:"10",rx:"5"}),n.a.createElement("path",{d:"M10.6506,2.0002 C11.0086,2.0002 11.2996,2.2912 11.2996, 2.6502 L11.2996,2.6502 L11.2996,6.7002 L13.3496,6.7002 C13.7086, 6.7002 13.9996,6.9912 13.9996,7.3502 C13.9996,7.7092 13.7086, 8.0002 13.3496,8.0002 L13.3496,8.0002 L10.6506, 8.0002 C10.2906,8.0002 9.9996,7.7092 9.9996,7.3502 L9.9996, 7.3502 L9.9996,2.6502 C9.9996,2.2912 10.2906,2.0002 10.6506, 2.0002 Z M17.3496,2 C17.7086,2 17.9996,2.291 17.9996, 2.65 C17.9996,3.009 17.7086,3.3 17.3496,3.3 L17.3496,3.3 L16.4006, 3.3 L16.4006,7.35 C16.4006,7.709 16.1096,8 15.7496,8 C15.3906, 8 15.0996,7.709 15.0996,7.35 L15.0996,7.35 L15.0996,3.3 L14.1506, 3.3 C13.7906,3.3 13.4996,3.009 13.4996,2.65 C13.4996,2.291 13.7906, 2 14.1506,2 L14.1506,2 Z M21.8496,1.9998 C22.2086,1.9998 22.4996, 2.2908 22.4996,2.6498 C22.4996,3.0088 22.2086,3.2998 21.8496, 3.2998 L21.8496,3.2998 L19.7996,3.2998 L19.7996,4.3498 L21.5496, 4.3498 C21.9096,4.3498 22.2006,4.6408 22.2006,4.9998 C22.2006, 5.3588 21.9096,5.6498 21.5496,5.6498 L21.5496,5.6498 L19.7996, 5.6498 L19.7996,6.6998 L21.8496,6.6998 C22.2086,6.6998 22.4996, 6.9908 22.4996,7.3498 C22.4996,7.7088 22.2086,7.9998 21.8496, 7.9998 L21.8496,7.9998 L19.1506,7.9998 C18.7906,7.9998 18.4996, 7.7088 18.4996,7.3498 L18.4996,7.3498 L18.4996,2.6498 C18.4996, 2.2908 18.7906,1.9998 19.1506,1.9998 L19.1506,1.9998 Z",id:"Combined-Shape",fill:"#FFFFFF"})))),"wifi"===t&&(i=e?n.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"32px",height:"10px",viewBox:"0 0 32 10",version:"1.1"},n.a.createElement("title",null,"ic_wifi_badge"),n.a.createElement("g",{id:"ic_wifi_badge",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.a.createElement("rect",{id:"Rectangle",fill:"#000000",x:"3",y:"0",width:"26",height:"10",rx:"5"}),n.a.createElement("path",{d:"M13.8266,2.43337 C13.9226,2.11537 14.2556,1.93637 14.5746, 2.03237 C14.8916,2.12837 15.0706,2.46337 14.9746,2.78037 L14.9746, 2.78037 L13.5246,7.57937 C13.4486,7.83337 13.2156,8.00637 12.9506, 8.00637 C12.6856,8.00637 12.4526,7.83337 12.3766,7.57937 L12.3766, 7.57937 L11.5006,4.68137 L10.6246,7.57937 C10.4716,8.08637 9.6286, 8.08637 9.4756,7.57937 L9.4756,7.57937 L8.0256,2.78037 C7.9296, 2.46337 8.1086,2.12837 8.4266,2.03237 C8.7456,1.93637 9.0786, 2.11537 9.1746,2.43337 L9.1746,2.43337 L10.0506,5.33137 L10.9266, 2.43337 C11.0786,1.92637 11.9226,1.92637 12.0746,2.43337 L12.0746, 2.43337 L12.9506,5.33137 Z M21.349,2.00407 C21.708,2.00407 21.999, 2.29507 21.999,2.65407 C21.999,3.01307 21.708,3.30407 21.349, 3.30407 L21.349,3.30407 L19.296,3.30407 L19.296,4.35407 L21.049, 4.35407 C21.408,4.35407 21.699,4.64507 21.699,5.00407 C21.699, 5.36307 21.408,5.65407 21.049,5.65407 L21.049,5.65407 L19.296, 5.65407 L19.296,7.35407 C19.296,7.71307 19.005,8.00407 18.647, 8.00407 C18.287,8.00407 17.996,7.71307 17.996,7.35407 L17.996, 7.35407 L17.996,2.65407 C17.996,2.29507 18.287,2.00407 18.647, 2.00407 L18.647,2.00407 Z M23.35,4.00107 C23.709,4.00107 24, 4.29207 24,4.65107 L24,4.65107 L24,7.35407 C24,7.71307 23.709, 8.00407 23.35,8.00407 C22.992,8.00407 22.701,7.71307 22.701, 7.35407 L22.701,7.35407 L22.701,4.65107 C22.701,4.29207 22.992, 4.00107 23.35,4.00107 Z M16.35,4.00107 C16.709,4.00107 17,4.29207 17, 4.65107 L17,4.65107 L17,7.35407 C17,7.71307 16.709,8.00407 16.35, 8.00407 C15.992,8.00407 15.701,7.71307 15.701,7.35407 L15.701, 7.35407 L15.701,4.65107 C15.701,4.29207 15.992,4.00107 16.35, 4.00107 Z M23.3496,2.00007 C23.7096,2.00007 24.0006,2.29107 24.0006, 2.65007 C24.0006,3.00907 23.7096,3.30007 23.3496,3.30007 C22.9916, 3.30007 22.7006,3.00907 22.7006,2.65007 C22.7006,2.29107 22.9916, 2.00007 23.3496,2.00007 Z M16.35,2.00017 C16.709,2.00017 17, 2.29117 17,2.65017 C17,3.00917 16.709,3.30017 16.35,3.30017 C15.992, 3.30017 15.701,3.00917 15.701,2.65017 C15.701,2.29117 15.992, 2.00017 16.35,2.00017 Z",id:"Combined-Shape",fill:"#FFFFFF"}))):n.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"32px",height:"10px",viewBox:"0 0 32 10",version:"1.1"},n.a.createElement("title",null,"ic_wlan_badge"),n.a.createElement("g",{id:"ic_wlan_badge",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.a.createElement("rect",{id:"Rectangle",fill:"#000000",x:"3",y:"0",width:"26",height:"10",rx:"5"}),n.a.createElement("g",{id:"Group-9",transform:"translate(8.000000, 2.000000)",fill:"#FFFFFF"},n.a.createElement("path",{d:"M2.5502,0.00014 C2.8612,0.00014 3.1282,0.22114 3.1872, 0.52614 L3.1872,0.52614 L3.49287578,2.08611372 L3.8132, 0.52114 C3.87865455,0.20114 4.16642314,-0.0122484298 4.4841692, 0.00268770849 L4.5802,0.01414 C4.9322,0.08514 5.1592, 0.42914 5.0872,0.78114 L5.0872,0.78114 L4.1172,5.53114 C4.0552, 5.83314 3.7882,6.05114 3.4802,6.05114 L3.4802,6.05114 C3.1672, 6.04914 2.9022,5.82914 2.8422,5.52614 L2.8422,5.52614 L2.5502, 4.03414 L2.2582,5.52614 C2.1992,5.82914 1.9332,6.04914 1.6222, 6.05114 L1.6222,6.05114 C1.3112,6.05114 1.0452,5.83314 0.9832, 5.53114 L0.9832,5.53114 L0.0132,0.78114 C-0.0588,0.42914 0.1682, 0.08514 0.5202,0.01414 C0.8712,-0.05386 1.2152,0.16914 1.2872, 0.52114 L1.2872,0.52114 L1.6062,2.08614 L1.9122,0.52614 C1.9722, 0.22114 2.2392,0.00014 2.5502,0.00014 Z M15.3502,0.00044 C15.7092, 0.00044 16.0002,0.29144 16.0002,0.65044 L16.0002,0.65044 L16.0002, 5.40044 C16.0002,5.70144 15.7932,5.96344 15.5012,6.03244 C15.4512, 6.04544 15.4002,6.05144 15.3502,6.05144 C15.1092,6.05144 14.8822, 5.91644 14.7702,5.69344 L14.7702,5.69344 L13.6002,3.37844 L13.6002, 5.40044 C13.6002,5.76044 13.3092,6.05144 12.9502,6.05144 C12.5912, 6.05144 12.3002,5.76044 12.3002,5.40044 L12.3002,5.40044 L12.3002, 0.65044 C12.3002,0.35044 12.5072,0.08844 12.7992,0.01944 C13.0932, -0.05456 13.3952,0.08944 13.5302,0.35744 L13.5302,0.35744 L14.7002, 2.67344 L14.7002,0.65044 C14.7002,0.29144 14.9912,0.00044 15.3502, 0.00044 Z M6.0184,0.00084 C6.3774,0.00084 6.6684,0.29184 6.6684, 0.64984 L6.6684,0.64984 L6.6754,4.75084 L7.9244,4.75084 L9.0654, 0.48284 C9.1414,0.19884 9.3994,0.00084 9.6934,0.00084 L9.6934, 0.00084 L10.3064,0.00084 C10.6014,0.00084 10.8584,0.19884 10.9344, 0.48284 L10.9344,0.48284 L12.2044,5.23284 C12.2974,5.57984 12.0904, 5.93584 11.7444,6.02884 C11.6884,6.04384 11.6314,6.05084 11.5754, 6.05084 C11.2884,6.05084 11.0264,5.85884 10.9484,5.56884 L10.9484, 5.56884 L10.8034,5.02584 L9.1964,5.02584 L9.0514,5.56884 L9.0514, 5.56884 L9.0314,5.60884 C9.0164,5.65284 8.9954,5.69084 8.9714, 5.73084 C8.9514,5.76284 8.9334,5.79684 8.9074,5.82484 C8.8774, 5.85984 8.8414,5.88584 8.8044,5.91384 C8.7754,5.93484 8.7484, 5.95784 8.7154,5.97384 C8.6754,5.99484 8.6314,6.00584 8.5874, 6.01784 C8.5484,6.02884 8.5124,6.03884 8.4724,6.04184 C8.4554, 6.04284 8.4414,6.05084 8.4234,6.05084 L8.4234,6.05084 L6.0264, 6.05084 C5.6684,6.05084 5.3774,5.75984 5.3764,5.40184 L5.3764, 5.40184 L5.3684,0.65184 C5.3684,0.29284 5.6584,0.00184 6.0174, 0.00084 L6.0174,0.00084 Z M10.0004,2.02084 L9.4644,4.02584 L10.5354, 4.02584 L10.0004,2.02084 Z",id:"Combined-Shape"}))))),i};t.a=({isWifiLogo:e,iconData:t,radioTech:i})=>n.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexShrink:"0",alignItems:"center"}},n.a.createElement("i",{className:"icon","data-icon":t,role:"presentation"}),n.a.createElement(a,{isWifiLogo:e,radioTech:i}))},39:function(e,t,i){"use strict";i.r(t);var s=i(9),n=i(3),a=i(34),o=i(36),r=i(35),l={InvalidNumber:{header:"invalidNumberToDialTitle",content:"invalidNumberToDialMessage",translated:!1},NumberBlocked:{content:"numberBlockedMessage",translated:!1},NoNetwork:{header:"emergencyDialogTitle",content:"emergencyDialogBodyBadNumber",translated:!1},RadioNotAvailable:{header:"callAirplaneModeTitle",content:"callAirplaneModeMessage",translated:!1},DeviceNotAccepted:{header:"emergencyDialogTitle",content:"emergencyDialogBodyDeviceNotAccepted",translated:!1},Busy:{header:"numberIsBusyTitle",content:"numberIsBusyMessage",translated:!1},FDNBlocked:{header:"fdnIsActiveTitle",content:"fdnIsActiveMessage",containNumber:!0,translated:!1},FdnCheckFailure:{header:"fdnIsActiveTitle",content:"fdnIsActiveMessage",containNumber:!0,translated:!1},OtherConnectionInUse:{header:"otherConnectionInUseTitle",content:"otherConnectionInUseMessage",translated:!1},EmergencyCallOnly:{header:"emergency-call-only",content:"emergency-call-error",containNumber:!0,translated:!1},Default:{content:"CallFailed",translated:!1}};const{get:c}=window.api.l10n,d=1,h=4,{get:m}=window.api.l10n;t.default=class extends s.a{constructor(){super(),this.name="DialHelper",this.DEBUG=!1,this.isDialing=!1;const{telephony:e}=window.navigator.b2g;this.telephony=e,this.call=Object(a.b)(1e3,this.call.bind(this)),this.isRtt=!1,this.rttPref="always-visible-automatic",this.hasVideo=!1,SettingsObserver.observe("ril.rtt.enabled",this.isRtt,e=>{this.isRtt=e,this.emit("update")}),SettingsObserver.observe("ril.rtt.preferredSettings","always-visible-automatic",e=>{this.rttPref=e,this.emit("update")}),this.isParentalControl=!1,Object(a.f)().then(e=>{this.isParentalControl=e})}async dialVoice(e,t){return this.dial(e,{serviceId:t,isRtt:!1,isVideo:!1})}async dialRtt(e,t){return this.dial(e,{serviceId:t,isRtt:!0,isVideo:!1})}async dialVideo(e,t){return this.dial(e,{serviceId:t,isRtt:!1,isVideo:!0})}async dial(e,t={serviceId:0,isRtt:!1,isVideo:!1}){const{serviceId:i,isRtt:s,isVideo:n}=t;if(this.isDialing)return;this.debug("Trying to dial: "+JSON.stringify({number:e,...t}));const a=()=>{this.isDialing=!1,document.removeEventListener("visibilitychange",a)};document.addEventListener("visibilitychange",a),this.isDialing=!0;const o=this.getConnection(i),r=this.isEmergencyOnly(o);let l;try{s?(this.debug("Dialing an RTT call..."),l=this.telephony.dial(e,d,!0,i)):n?(this.debug("Dialing a video call..."),l=this.telephony.dial(e,h,!1,i)):(this.debug("Dialing a voice call..."),l=this.telephony.dial(e,d,!1,i)),l.then(()=>{}).catch(t=>{this.showErrorDialog(t,e,r)})}catch(e){throw this.isDialing=!1,e}}async chooseSim(){let e=0;try{e=await n.a.request("chooseSim","call")}catch(e){throw e}return this.debug(`The SIM card ${e} is selected.`),e}async isEmergencyNumber(e,t=0){let i;try{i=await this.telephony.getEccList(t)}catch(e){throw e}return(i=i.split(",")).includes(e)}async isNumberAllowed(e,t,i){if(await this.isEmergencyNumber(e,i))return!0;const s=await Object(r.c)(e);return"true"===t&&!s}async getVilte(){try{this.hasVideo=await DeviceCapabilityManager.get("device.vilte")}catch(e){throw e}}getConnection(e){const{mobileConnections:t}=window.navigator.b2g;return t&&t[e]}isEmergencyOnly(e){return!(e.imsHandler&&e.imsHandler.capability)&&e.voice.emergencyCallsOnly}hasNetwork(e){const t=e&&e.voice,i=this.isEmergencyOnly(e),s=t&&(i||e.iccId);return this.debug("hasNetwork: "+s),s}showErrorDialog(e,t="",i){this.isDialing=!1;let s=e;"BadNumber"!==s&&"ServiceNotAvailable"!==s||(s=i?"NoNetwork":"EmergencyCallOnly");const n=((e,t)=>({type:"alert",noClose:!1,...((e,t)=>e.containNumber?{header:c(e.header,{number:t}),content:c(e.content,{number:t}),containNumber:!0,translated:!0}:e)(e,t)}))(l[s]||l.Default,t),a=new CustomEvent("showDialDialog",{detail:{data:n}});window.dispatchEvent(a)}async call(e,t){const i=e.replace(/(\s|-|\.|\(|\))/g,"");if(!this.isValid(i))return void this.showErrorDialog("InvalidNumber");if(!this.telephony)return void this.showErrorDialog("DeviceNotAccepted",i);let s=o.a.getSimCardIndex();if(-1===s)try{s=await this.chooseSim()}catch(e){throw e}if(this.isParentalControl&&!await this.isNumberAllowed(i,t,s))return void this.showErrorDialog("NumberBlocked");const n=this.getConnection(s);if(!this.hasNetwork(n))return void this.showErrorDialog("NoNetwork",i);let a=[];if((a=this.getCallOptions(i,s)).length<=0)throw new Error("No call options found.");a.length>=2?this.showCallMenu(a):a[0].callback()}showCallMenu(e){const t=new CustomEvent("showDialOptionMenu",{detail:{data:{header:"select",options:e}}});window.dispatchEvent(t)}getCallOptions(e,t){const i={label:m("call"),callback:()=>{this.dialVoice(e,t)}},s={label:m("rttCall"),callback:()=>{this.dialRtt(e,t)}},n={label:m("videoCall"),callback:()=>{this.dialVideo(e,t)}};let a=[];if(this.isRtt)switch(this.rttPref){case"always-visible-manual":a=a.concat([i,s]);break;case"always-visible-automatic":a=a.concat([s]);break;case"visible-during-calls":default:a=a.concat([i])}else a=a.concat([i]);return!this.hasVideo||this.isRtt&&"always-visible-automatic"===this.rttPref||(a=a.concat(n)),a}isValid(e){return/^(?!,)([0-9#+*,]){1,50}$/.test(e)}dialForcely(e){let t=o.a.getDefaultSimCardIndex();this.dialVoice(e,t)}showRttCall(){return this.isRtt&&"always-visible-automatic"===this.rttPref}}},42:function(e,t,i){"use strict";i.r(t);var s=i(0),n=i.n(s),a=i(3),o=i(2),r=({name:e,data:t})=>{window.activityIsWorking=!0,new WebActivity(e,t).start().then(()=>{window.activityIsWorking=!1}).catch(e=>{window.activityIsWorking=!1})},l=i(36),c=i(9),d=class extends c.a{constructor({scrollable:e,sticky:t}){super(),this.scrollable=e,this.sticky=t,this.DEBUG=!1,this.stickyStyle=t.style,this.throttle=null}throttledRefresh(){let e=!1;void 0===this.stickyPosition&&(this.stickyPosition=this.sticky.offsetHeight+this.sticky.offsetTop);const t=this.scrollable.querySelectorAll(".group-header"),i=t.length;for(let s=1;s<=i;s++){if(s===i||t[s].offsetTop-this.scrollable.scrollTop>(this.scrollable.stickyHiddenGap||this.stickyPosition)){let i=1,n=t[s-i];for(;n&&0===n.offsetHeight;)n=t[s-(i+=1)];n&&(this.stickyStyle.backgroundImage="-moz-element(#"+n.id+")",e=!0);break}if(t[s].offsetTop-this.scrollable.scrollTop>0)break}this.sticky.classList.toggle("has-content",e),this.throttle=null}refresh(){this.throttle||(this.throttle=setTimeout(()=>{this.throttledRefresh()},0))}},h=i(39),m=i(34);i(31);const{get:u}=window.api.l10n;class g extends n.a.PureComponent{constructor(e){super(e),this.DEBUG=!1}componentDidMount(){const{isSnapshot:e}=this.props;e||window.performance.mark("navigationLoaded")}componentDidUpdate(){this.updateIndicator()}updateIndicator(){const{selectedIndex:e}=this.props,t="rtl"===document.documentElement.dir;let i=0;const s=this.element.children,n=this.element.offsetWidth,a=s[e].offsetLeft,o=s[e].offsetWidth,r=n-(a+o),l=s[s.length-1].offsetLeft,c=n-(l+s[s.length-1].offsetWidth);if(0===e)i=0;else if(e===s.length-1)i=t?Math.abs(l):c>0?0:c;else{const e=(a+r)/2;let s=e-a;if(t){const t=r+o;t>n&&(t<c?(s=Math.abs(e)-a,i=Math.abs(s)):i=Math.abs(l))}else s>0||c>0?i=0:s<0&&s>c?i=s:s<0&&s<c&&(i=c)}this.element.style.transform="translateX("+i+"px)"}render(){const{tabNames:e=[],selectedIndex:t}=this.props,i=e.map((e,i)=>{const s=t===i?"selected":"";return n.a.createElement("div",{className:s,key:e,slot:"tab"},n.a.createElement("span",{"aria-selected":!!s,id:e},u(e)))});return n.a.createElement("gaia-tabs",{class:"h3",underline:"child",position:"top",ref:e=>this.element=e},i)}}g.defaultProps={tabNames:[],selectedIndex:0};var p=g,f=i(38),w=i(37);const{get:b}=window.api.l10n;var C=class extends n.a.Component{constructor(e){super(e),this.name="CalllogListItem",this.DEBUG=!1,this.showContactIcon=!Object(m.e)()}render(){const{calls:e,callType:t,date:i,emergency:s,id:o,itemContact:r=null,number:l,radioTech:c,simNum:d,index:h,checked:u,serviceId:g,verStatus:p,isWifiLogo:C}=this.props,y=Object(m.c)({callType:t,simNum:d});let v="",I="";const L=w.a.check(l,g),k=null!==r;I=s?"emergencyNumber":L?"voicemail":"";const E=window.sdnContacts.get();let S=!1;if(!I){const e=E[g];e&&e.get(l)?(v=e.get(l),S=!0):v=r&&r.name?r.name:l,v||(I="withheld-number")}I&&!v&&(v=b(I));let T=null;e&&e.length>1&&(T=n.a.createElement("span",{className:"retry-count","aria-hidden":"true"},"(",e.length,")"));let M=null;"pass"===p&&(M=n.a.createElement("div",{className:"stir-checked","aria-hidden":"true"}));let N=window.api.hour12;if(null===N){const e=a.a.query("getBackupHour12");null!==e&&(N=e)}const D=new Date(i).toLocaleString(navigator.language,{hour:"numeric",minute:"numeric",hour12:N});let x=D,_=null,O="",R="";!S&&r&&r.type&&(O=r.type),(s||L)&&(R=D,O="",x=l),(O||R)&&(R||(R=b(O)),_=n.a.createElement("div",{className:"additional-info"},n.a.createElement("span",{"data-l10n-id":O},R)));const A=u?"check-on":"check-off",H=n.a.createElement("i",{className:"icon box","data-icon":A,"data-id":o,role:"presentation"});let B="";return B=this.showContactIcon&&!s&&!L&&!S&&r&&r.photoBlob?n.a.createElement("i",{className:"icon thumb",style:{backgroundImage:`url(\n              data:${r.photoType};base64,${r.photoBlob}\n            )`},role:"presentation","aria-hidden":"true"}):n.a.createElement("i",{className:"icon thumb","data-icon":"contacts",role:"presentation","aria-hidden":"true"}),n.a.createElement("div",{className:"list-item",tabIndex:-1,ref:e=>this.element=e,id:"li-"+h,"data-id":o,"data-call-type":t.split("_")[0],"data-number":l,"data-contact":k},H,B,n.a.createElement("div",{className:"content",role:"textbox"},n.a.createElement("div",{className:"primary-info"},n.a.createElement("span",{"data-l10n-id":I},v),T,M),n.a.createElement("div",{className:"secondary-info"},n.a.createElement("span",null,x)),_),n.a.createElement(f.a,{isWifiLogo:C,iconData:y,radioTech:c}))}};function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e}).apply(this,arguments)}var v=class extends n.a.PureComponent{constructor(e){var t,i;super(e),i=(e,t,i)=>{const{showOptionMenu:s}=this.props;window.sessionStorage.focusItem=t,window.sessionStorage.selectedTabIndex=i;const n=this.listItemIndex[e].props;let a=["callInformation","sendSms","editCalllog"];if(!n.itemContact){const e=["createNewContact","addToExistingContact"];a.splice(2,0,...e)}a=a.map(e=>{const t={id:e,callback:()=>{s({openOptionMenu:!1}),this["_option_"+e](n)}};return(e=>["sendSms","createNewContact","addToExistingContact"].includes(e))(e)?{...t,debounce:500}:t}),s({openOptionMenu:!0,options:a})},(t="showOptionMenu")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i,this.name="CalllogList",this.DEBUG=!1,this.ITEM_HEIGHT=62,this.GROUNPHEADHEIGHT=22,this.CACHE_NUMBER=5,this.listItemIndex={},this.calllogStore=e.calllogStore,this.renderNumbers=new Map,this.state={isWifiLogo:!1}}componentDidMount(){DeviceCapabilityManager.get("device.wifi.certified").then(e=>{this.setState({isWifiLogo:!!e})})}scrollFocusItemIntoView(e){const t=document.querySelector("#root #li-"+e),i=this.element;let s=i.offsetTop;const n=i.querySelector(".group-header");n&&(s=i.offsetTop+n.offsetHeight),t&&(i.scrollTop+s>t.offsetTop?i.scrollTop=t.offsetTop-s:i.scrollTop+i.offsetTop+i.clientHeight<t.offsetTop+t.clientHeight&&(i.scrollTop=t.offsetTop-i.offsetTop-i.clientHeight+t.clientHeight),i.stickyHiddenGap=t.offsetHeight)}componentDidUpdate(){const{focusItem:e}=this.props;this.scrollFocusItemIntoView(e)}_option_callInformation(e){const{isWifiLogo:t}=this.state,{changeView:i}=this.props;i({currentView:"listInfoView",params:{...e,isWifiLogo:t}})}_option_sendSms(e){r({name:"new",data:{type:"websms/sms",number:e.number}})}_option_createNewContact(e){r({name:"new",data:{type:"webcontacts/contact",caller:"Call",params:{tel:e.number}}})}_option_addToExistingContact(e){r({name:"update",data:{type:"webcontacts/contact",params:{tel:e.number}}})}_option_editCalllog(e){a.a.request("setEditMode")}_skipRender(e){const{focusItem:t}=this.props;return e+this.CACHE_NUMBER<t||t+this.CACHE_NUMBER<e}_generateGroupDom(){const{isWifiLogo:e}=this.state,{logItems:t,itemContacts:i,focusItem:s}=this.props;let a=new Map;t.forEach((e,t)=>{const i=e.groupKey;a.has(i)||a.set(i,[]),a.get(i).unshift(e)});let o=[],r=t.size-1,l=0,c=0;this.renderNumbers.clear(),a.forEach((t,a)=>{let d=[],h=!0,u=r-(t.length-1);if(t.forEach(t=>{const a=i.get(t.number);this._skipRender(u)?u<s?l+=this.ITEM_HEIGHT:c+=this.ITEM_HEIGHT:(h=!1,this.renderNumbers.set(t.number,{number:t.number}),d.push(n.a.createElement(C,y({},t,{isWifiLogo:e,index:u,key:t.id,itemContact:a,ref:e=>this.listItemIndex[t.id]=e})))),u++,r--}),h)u<s?l+=this.GROUNPHEADHEIGHT:c+=this.GROUNPHEADHEIGHT;else{const e="header-"+new Date(a).getTime();o.unshift(n.a.createElement("div",{className:"group-container",key:a},n.a.createElement("p",{className:"group-header",id:e},Object(m.d)(a)),d))}});const d={height:l},h={height:c};return(l||c)&&(o.unshift(n.a.createElement("div",{id:"top-edge",style:{...d},ref:e=>this.topEdge=e})),o.push(n.a.createElement("div",{id:"bottom-edge",style:{...h},ref:e=>this.bottomEdge=e}))),o}render(){const e=this._generateGroupDom();return n.a.createElement("div",{className:"list",tabIndex:-1,ref:e=>this.element=e},e)}};function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e}).apply(this,arguments)}function L(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(29),i(30);const{get:k}=window.api.l10n;t.default=class extends n.a.PureComponent{constructor(e){super(e),L(this,"updateList",e=>{const{type:t=""}=e||{},{reRenderView:i,logItems:s}=this.state;switch(t){case"timeformatchange":a.a.query("getBackupHour12")!==window.api.hour12&&this.setState({reRenderView:!i});break;case"visibilitychange":document.hidden||(this.setState({reRenderView:!i}),Object(m.a)());break;default:this.setState({reRenderView:!i})}this.snapShotSoftKeyConfig={},s.size>0?this.snapShotSoftKeyConfig={center:"call",left:"contacts",right:"options"}:this.snapShotSoftKeyConfig={left:"contacts"},this.debounce(300)}),L(this,"debounce",e=>{clearTimeout(window.timer),window.timer=setTimeout(()=>{a.a.request("backupScreen",this.snapShotSoftKeyConfig)},e)}),L(this,"getSoftKeyConfig",()=>{const{isEditMode:e}=this.state;let t={};if("#pick"===window.location.hash)return 0===this.listedCount?{left:"cancel"}:{center:"select",left:"cancel"};if(e){if(this.listedCount){t={left:"calllog-all",center:"select"},this.checkedCount>0&&(t.right="delete");const e=document.activeElement.querySelector(".box");e&&"check-on"===e.dataset.icon&&(t.center="deselect"),this.checkedCount===this.listedCount&&(t.left="calllog-none")}return t}return this.listedCount?(t={left:"contacts",center:{text:"call",icon:""},right:"options"},this.dialHelper.showRttCall()&&(t.center.text="rtt-call"),l.a.showSimIndicator()&&(t.center.icon="sim-"+(l.a.cardIndex+1)),t):{left:"contacts"}}),L(this,"_doDeletion",()=>{const{curTabLogItems:e,logItems:t,selectedTabIndex:i,focusItem:s}=this.state,{deleteLogs:n}=this.props;window.performance.mark("delete-start");let a=[];e.forEach(e=>{e.checked&&a.push(e.id)});const o={messageL10nId:"deletedNotification-1",messageL10nArgs:{n:this.checkedCount}};this._showToast(o);const r=new Map([...t.entries()].filter(e=>!a.includes(e[0]))),l=this._filterCallTypeItems(r,i);let c=Math.min(l.size-1,s);c=Math.max(c,0),this.toggleAll("off","allItems"),this.setState({logItems:r,curTabLogItems:l,focusItem:c,isEditMode:!1}),n(a),window.performance.mark("delete-start"),setTimeout(()=>{(new DB).deleteData(a).then(()=>{this._focusElement(this.element),window.performance.mark("delete-end"),window.performance.measure("performance-calllog-delete","delete-start","delete-end"),window.performance.clearMarks("delete-start"),window.performance.clearMarks("delete-end"),window.performance.clearMeasures("performance-calllog-delete")}).catch(e=>{this._showToast({message:"Something wrong"}),window.performance.clearMarks("delete-start"),window.performance.clearMarks("delete-end"),window.performance.clearMeasures("performance-calllog-delete")})},300)}),L(this,"focus",()=>{this._focusItem()}),this.name="CalllogView",this.DEBUG=!1,this.tabNames=["all","missed","outgoing","incoming"],this.checkedCount=0,this.focusSelector=".list-item",this.timer=null;const{focusItem:t,selectedTabIndex:i}=window.sessionStorage,s=i?Number.parseInt(i,10):0,n=t||0,o=this._filterCallTypeItems(e.logsStore,s)||new Map;this.listedCount=o.size,this.state={itemContacts:e.contactsStore,logItems:e.logsStore,curTabLogItems:o,timestamp:0,focusItem:n,selectedTabIndex:s,isEditMode:!1,itemId:-1,reRenderView:!1},this.dialHelper=new h.default,this.config={},this.stickyHeader=null,a.a.register("focus",this);const{isSnapshot:r}=e;r||(TimeService.addEventListener("timeChange",this.updateList),window.addEventListener("timeformatchange",this.updateList),document.addEventListener("visibilitychange",this.updateList))}componentWillReceiveProps(e){if(this.props!==e){const{selectedTabIndex:t}=this.state;this.setState({curTabLogItems:this._filterCallTypeItems(e.logsStore,t),logItems:e.logsStore,itemContacts:e.contactsStore})}}componentDidMount(){const{isSnapshot:e}=this.props;e||(Object(m.a)(),window.dispatchEvent(new CustomEvent("calllogRenderComplete"))),this._focusItem(),a.a.register("setEditMode",this),this.dialHelper.on("update",this._updateSoftKeys.bind(this)),l.a.on("update",this._updateSoftKeys.bind(this)),this.element.dataset.hasListedItems=0!==this.listedCount,this._updateSoftKeys(),window.performance.mark("navigationInteractive"),window.performance.mark("contentInteractive"),window.dispatchEvent(new CustomEvent("renderEnd"));let t=document.getElementById("snapshot")||null;t&&(document.body.removeChild(t),t=null);const i=this.element.querySelector(".body .list"),s=this.element.querySelector(".sticky");this.stickyHeader=new d({scrollable:i,sticky:s})}componentWillUnmount(){TimeService.removeEventListener("timeChange",this.updateList),window.removeEventListener("timeformatchange",this.updateList),document.removeEventListener("visibilitychange",this.updateList),a.a.unregister("focus",this),a.a.unregister("setEditMode",this)}_updateItems(e){const{selectedTabIndex:t}=this.state;this.setState({logItems:e,curTabLogItems:this._filterCallTypeItems(e,t)})}_updateSoftKeys(){const{isSnapshot:e}=this.props,t=this.getSoftKeyConfig();o.a.register(t,this.element),this.config=t}componentDidUpdate(e,t){const{isSnapshot:i,logsStore:s}=this.props,{isEditMode:n,selectedTabIndex:a,curTabLogItems:o}=this.state;this.listedCount=o.size,this.element.dataset.hasListedItems=0!==this.listedCount,this.listedCount||i||this.element.focus(),n&&this._setCheckedCount(),a!==t.selectedTabIndex&&this._updateListNavigator(),this._focusItem(),this._updateSoftKeys(),this.stickyHeader.refresh()}_focusElement(e){const{openDialog:t,openOptionMenu:i,isSnapshot:s}=this.props;e===document.activeElement||s||document.activeElement.classList.contains("menu-item")||t||i||e.focus()}_focusItem(){const{openDialog:e,openOptionMenu:t}=this.props,{focusItem:i}=this.state;if((!e||!t)&&this.element){const e=this.element.querySelector("#li-"+i);if(e)this._focusElement(e);else{const e=this.element.querySelector(".no-result");this._focusElement(e)}}}onKeyDown(e){const{isEditMode:t}=this.state;return"MicrophoneToggle"===e.key?(e.preventDefault(),void e.stopPropagation()):!window.activityIsWorking&&(this.onTabKeyDown(e),this.onListKeyDown(e),void("#pick"!==window.location.hash?t?this.onEditModeKeyDown(e):this.onItemKeyDown(e):this.onActivityKeyDown(e)))}onActivityKeyDown(e){if(navigator.serviceWorker.controller)switch(e.key){case"SoftLeft":case"Backspace":case"EndCall":navigator.serviceWorker.controller.postMessage({name:"addCall",value:null}),window.close();break;case"Call":case"Enter":if(this.listedCount){const t=[{value:e.target.dataset.number}];navigator.serviceWorker.controller.postMessage({name:"addCall",value:{tel:t}}),window.close()}}}onListKeyDown(e){switch(e.key){case"ArrowUp":case"ArrowDown":e.preventDefault(),e.stopPropagation(),this._changeFocus(e.key)}}onTabKeyDown(e){const{selectedTabIndex:t}=this.state;let i;if("rtl"!==document.documentElement.dir)switch(e.key){case"ArrowRight":(i=t+1)<=this.tabNames.length-1&&this.setSelectedTabIndex(i);break;case"ArrowLeft":(i=t-1)>=0&&this.setSelectedTabIndex(i)}else switch(e.key){case"ArrowRight":(i=t-1)>=0&&this.setSelectedTabIndex(i);break;case"ArrowLeft":(i=t+1)<=this.tabNames.length-1&&this.setSelectedTabIndex(i)}}_filterCallTypeItems(e,t){const{isSnapshot:i}=this.props,s=this.tabNames[t];if(i){let t=a.a.query("snapshotItemNumber");if(e.size>t)return new Map([...e.entries()].slice(e.size-t))}return new Map([...e.entries()].filter(e=>"all"===s||s===e[1].callType.split("_")[0]))}_changeFocus(e){let{focusItem:t}=this.state;const{curTabLogItems:i}=this.state;"ArrowUp"===e?t--:t++,t<0?t=i.size-1:t>=i.size&&(t=0),this.setState({focusItem:t})}async onItemKeyDown(e){const{id:t,number:i,contact:s}=e.target.dataset;switch(e.key){case"Call":case"Enter":try{t&&this.dialHelper.call(i,s)}catch(e){return}break;case"SoftLeft":r({name:"launch",data:{type:"app/contacts"}});break;case"SoftRight":const{focusItem:n,selectedTabIndex:a}=this.state;t&&this.list.showOptionMenu(t,n,a)}}onEditModeKeyDown(e){const{contactsStore:t}=this.props,i=e.target.dataset.id;switch(e.key){case"Backspace":e.stopPropagation(),e.preventDefault(),this.toggleAll("off","allItems"),this.setState({isEditMode:!1});break;case"Enter":this.toggleCheckbox(i);break;case"SoftLeft":this.checkedCount!==this.listedCount?this.toggleAll("on"):this.toggleAll("off");break;case"SoftRight":if(1===this.checkedCount){const e=this._boxNodes("on")[0].parentNode.dataset.number;let i=e||k("withheld-number");const s=t.get(e);s&&s.name&&(i=s.name),this._showDeleteDialog(k("delete-single-log",{name:i}))}else this.checkedCount>0&&this._showDeleteDialog(k("deleteLog"))}}setEditMode(){this.toggleAll("off","allItems"),this.setState({isEditMode:!0})}setSelectedTabIndex(e){const{logItems:t}=this.state;this.setState({focusItem:0,selectedTabIndex:e,curTabLogItems:this._filterCallTypeItems(t,e)})}toggleCheckbox(e){const{curTabLogItems:t}=this.state,i=this.element.querySelector(`.list-item[data-id='${e}'] [data-icon^=check-]`);i&&i.dataset&&i.dataset.icon&&(i.dataset.icon="check-off"===i.dataset.icon?"check-on":"check-off",t.get(e).checked="check-off"!==i.dataset.icon,this._setCheckedCount())}toggleAll(e,t){const{logItems:i,curTabLogItems:s}=this.state,n=this._boxNodes();Array.from(n).forEach(t=>{t.dataset.icon="check-"+e});let a="off"!==e;t?i.forEach(e=>e.checked=a):s.forEach(e=>e.checked=a),this._setCheckedCount()}_showDeleteDialog(e){const{showDialog:t}=this.props;t({openDialog:!0,options:{header:k("confirmation"),type:"confirm",ok:"delete",content:e,translated:!0,onOk:()=>{t({openDialog:!1}),this._doDeletion()},onCancel:()=>{t({openDialog:!1})}}})}_setCheckedCount(){this.checkedCount=this._getCheckedCount(),this.header.dataset.checkedCount=this.checkedCount,this._updateSoftKeys()}_getCheckedCount(){const{curTabLogItems:e}=this.state;let t=0;return e.forEach(e=>{e.checked&&t++}),t}_boxNodes(e){e||(e="");const t=`${this.focusSelector} [data-icon^=check-${e}]`;return this.element.querySelectorAll(t)}_updateListNavigator(){const{isSnapshot:e}=this.props;e||this.element.focus()}_setFocusSelector(){const{selectedTabIndex:e}=this.state,t=this.tabNames[e],i="all"===t?"":`[data-call-type='${t}']`;this.focusSelector=".list-item"+i}_showToast(e){Toaster.showToast(e)}render(){const{isEditMode:e,selectedTabIndex:t,itemId:i,curTabLogItems:s,itemContacts:a,timestamp:o,focusItem:r,reRenderView:l}=this.state,{isSnapshot:c,changeView:d,showOptionMenu:h}=this.props,m={itemId:i,changeView:d,logItems:s,itemContacts:a,callType:this.tabNames[t],timestamp:o,focusItem:r,showOptionMenu:h,reRenderView:l};this._setFocusSelector();const u=e?"checkedCount":"callLog",g=this.tabNames[t],f="calllog "+g;return n.a.createElement("div",{id:"calllog-view",tabIndex:-1,ref:e=>this.element=e,role:"heading","aria-labelledby":f,"data-view-call-type":g,"data-is-edit-mode":e,onKeyDown:c?e=>{}:e=>this.onKeyDown(e),onFocus:e=>this.focus()},n.a.createElement("div",{ref:e=>this.header=e,className:"header h1",id:"calllog"},k(u)),n.a.createElement(p,{tabNames:this.tabNames,selectedIndex:t}),n.a.createElement("div",{className:"body"},n.a.createElement("div",{className:"no-result primary",tabIndex:-1,role:"textbox",style:{display:s.size>0?"none":""}},n.a.createElement("div",null,k("no-logs-msg-1")),n.a.createElement("div",{className:"#pick"===window.location.hash?"hide":""},k("no-logs-msg-2"))),n.a.createElement(v,I({ref:e=>this.list=e},m)),n.a.createElement("div",{className:"sticky"})))}}}}]);