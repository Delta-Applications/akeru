!function(t){"use strict";function e(){this.context={},this.currentSelector=void 0,this.nextId=this.generatorId(0),document.addEventListener("focusChanged",this.focusChandedHandler.bind(this))}e.prototype.CLASS_NAME="NavigationManager",e.prototype.DEBUG=!1,e.prototype.init=function(t){this.config=t||{clickHandler:void 0},window.addEventListener("keydown",this.keyHandler.bind(this))},e.prototype.keyHandler=function(t){var e,o=t.target;this.debug("key "+t.key),NavigationMap&&NavigationMap.currentActivatedLength&&0<NavigationMap.currentActivatedLength||o&&("Enter"===t.key||"Accept"===t.key?(this.click(o),this.dispatchEvent("accepted",{acceptedEl:o})):o.classList&&(o.classList.contains("focus")||(this.debug("event target does not have focus"),o=document.querySelector(".focus")),(o=this.findElementFromNavProp(o,t))&&o!=(e=document.querySelectorAll(".focus"))[0]&&(e.length&&e[0].classList.remove("focus"),(e=this.scrollToElement)&&e.constructor&&e.call&&e.apply?this.scrollToElement(o,t):(t=o.offsetTop+o.offsetHeight,"settings-alarm-snooze-control"===o.id&&(o.parentNode.scrollTop=0),o.offsetTop<o.parentNode.scrollTop?o.scrollIntoView(!0):t>o.parentNode.scrollTop+o.parentNode.offsetHeight&&o.scrollIntoView(!1)),o.classList.add("focus"),(o.querySelector('input[type="text"]')||o).focus(),this.dispatchEvent("focusChanged",{focusedElement:o}))))},e.prototype.findElementFromNavProp=function(t,e){if(!t)return null;var o,r=t.style,n=!0;switch(e.key){case"ArrowLeft":o=r.getPropertyValue("--nav-left");break;case"ArrowRight":o=r.getPropertyValue("--nav-right");break;case"ArrowUp":o=r.getPropertyValue("--nav-up");break;case"ArrowDown":o=r.getPropertyValue("--nav-down");break;case"Home":case"MozHomeScreen":o=r.getPropertyValue("--nav-home");break;default:n=!1}return o?(n&&e.preventDefault(),document.querySelector('[data-nav-id="'+o+'"]')):null},e.prototype.click=function(t){this.config.clickHandler?this.config.clickHandler(t):t.click()},e.prototype.dispatchEvent=function(t,e){e=e?{detail:e}:{},document.dispatchEvent(new CustomEvent(t,e))},e.prototype.focusChandedHandler=function(t){var e=t.detail.focusedElement,t=e&&e.getAttribute("data-nav-id");e&&this.currentSelector&&(this.context[this.currentSelector]=t)},e.prototype.generatorId=function(t){var e=t;return function(){return e++}},e.prototype.initNavId=function(t){Array.prototype.forEach.call(t,t=>{t.getAttribute("data-nav-id")||t.setAttribute("data-nav-id",this.nextId())})},e.prototype.prepareElements=function(t){if(!t)throw Error("selector is undefined");var e=document.querySelectorAll(t),o=Array.prototype.slice.call(document.querySelectorAll(".focus")),r=o.length;if(this.currentSelector=t,this.debug("items.length "+e.length),e.length){if(r)for(var n=0;n<r;n++)o[n].classList.remove("focus");return this.initNavId(e),e}this.dispatchEvent("focusChanged",{focusChanged:null})},e.prototype.reset=function(t,e,o,r){var n,i=this.prepareElements(t);i&&(i=i[0],e&&(n=document.querySelector('[data-nav-id="'+e+'"]'))&&(i=n),this.context[t]=i.dataset.navId,this.setFocus(i),r||this.update(t,o))},e.prototype.unfocus=function(){var t=Array.prototype.slice.call(document.querySelectorAll(".focus"));[].forEach.call(t,t=>{t.classList.remove("focus")})},e.prototype.update=function(t,e){var o,r,n,i,a=0;if(document.querySelectorAll(".focus").length){if(!t)throw Error("selector is undefined");if(o=document.querySelectorAll(t),this.debug("items.length "+o.length),this.initNavId(o),o.length<=1)(r=o[0])&&(r.style.removeProperty("--nav-down"),r.style.removeProperty("--nav-up"));else if(this.debug(t+".length = "+o.length),e=e||"vertical","function"!=typeof this.doUpdateCb)switch(e){case"vertical":for(a=0;a<o.length;a++)r=o[a],n=o[a-1]||o[o.length-1],i=o[a+1]||o[0],r.style.setProperty("--nav-down",i.getAttribute("data-nav-id")),r.style.setProperty("--nav-up",n.getAttribute("data-nav-id"));break;case"horizontal":for(a=0;a<o.length;a++)r=o[a],n=o[a-1]||o[o.length-1],i=o[a+1]||o[0],r.style.setProperty("--nav-right",i.getAttribute("data-nav-id")),r.style.setProperty("--nav-left",n.getAttribute("data-nav-id"))}else this.doUpdateCb(o)}else this.reset(t)},e.prototype.setFocus=function(t){t.classList.add("focus"),t.focus(),this.dispatchEvent("focusChanged",{focusedElement:t})},e.prototype.switchContext=function(t,e,o){if(!t)throw Error("selector is undefined");e=e||this.context[t],this.reset(t,e,o)},e.prototype.debug=function(t){this.DEBUG},t.NavigationManager=new e}(window);