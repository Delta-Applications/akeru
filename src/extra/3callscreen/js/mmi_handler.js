const MmiHandler=function(){const f=window.api.l10n.get;let u=null;function l(e,a){(e||a)&&(a={title:{text:f(e)||e,args:{}},body:{text:f(a)||a},accept:{name:"ok",l10nId:"ok",priority:2}},CallScreen.showConfirmDialog(a))}return window.addEventListener("ussd-received",function(){CallScreen.closeConfirmDialog()}),{handleMmi:function(e,s,a){u=navigator.b2g.mobileConnections&&navigator.b2g.mobileConnections[a],e.then(e=>{if(e&&e.success){var r=e.serviceCode;let a=e.statusMessage;const{additionalInformation:i}=e;switch(e.serviceCode){case"scCall":return;case"scUssd":if(!a)return n={body:{text:f("wait")},title:{text:""},otherClass:"is-loading",accept:{name:"ok",l10nId:"ok",priority:2}},void CallScreen.showConfirmDialog(n);break;case"scCallForwarding":a?i&&(a=function(r){var e=f("call-forwarding-inactive");let n=e,i=e,s=e,l=e,c=e,o=e,t=e,C=e,d=["unconditional","mobilebusy","noreply","notreachable"],S=d[0];for(let a=0;a<r.length;a++)if(r[a].active){for(let e=1;e<=u.ICC_SERVICE_CLASS_MAX;e<<=1)if(0!=(e&r[a].serviceClass))switch(e){case u.ICC_SERVICE_CLASS_VOICE:n=r[a].number;break;case u.ICC_SERVICE_CLASS_DATA:i=r[a].number;break;case u.ICC_SERVICE_CLASS_FAX:s=r[a].number;break;case u.ICC_SERVICE_CLASS_SMS:l=r[a].number;break;case u.ICC_SERVICE_CLASS_DATA_SYNC:c=r[a].number;break;case u.ICC_SERVICE_CLASS_DATA_ASYNC:o=r[a].number;break;case u.ICC_SERVICE_CLASS_PACKET:t=r[a].number;break;case u.ICC_SERVICE_CLASS_PAD:C=r[a].number;break;default:return f("call-forwarding-error")}var b=0;0<=(b=r[a].reason)&&b<4&&(S=d[b])}else S="";e=[f("call-forwarding-status"),f("call-forwarding-reason",{reason:S}),f("call-forwarding-voice",{voice:n}),f("call-forwarding-data",{data:i}),f("call-forwarding-fax",{fax:s}),f("call-forwarding-sms",{sms:l}),f("call-forwarding-sync",{sync:c}),f("call-forwarding-async",{async:o}),f("call-forwarding-packet",{packet:t}),f("call-forwarding-pad",{pad:C})].join("\n");return e}(i)):a="GenericFailure";break;case"scCallBarring":case"scCallWaiting":if("*#33#"===s||"*#43#"===s){let e=[];var n={smServiceEnabled:"ServiceIsEnabled",smServiceDisabled:"ServiceIsDisabled",smServiceEnabledFor:"ServiceIsEnabledFor"};i&&"smServiceEnabledFor"===a&&Array.isArray(i)&&(e=i.map(f)),e.unshift(f(n[a])||a),a=e.join("\n")}}l(r,a)}else e&&!e.success&&e.statusMessage?l("error",e.statusMessage):l("","GenericFailure")})}}}();window.MmiHandler=MmiHandler;