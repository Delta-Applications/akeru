'use strict';var ViewManager={softkey:null,softkeyItems:null,menuItems:null,navigator:VerticalNavigator,controls:null,selector:null,focus:null,curView:null,mainHeader:null,previousItem:null,init:function(){this.mainHeader=$('fxa-module-header').querySelector('h1');this.controls=this.getControls.bind(this);this.constSoftkeyItems={'fxa-about':[{l10nId:'fxa-decline',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}},{l10nId:'fxa-accept',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-in':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-signin-rsk',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-in.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-sign-out':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-out.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-check-password':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-check-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-account-info':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'select',priority:2,method:function(){}}],'fxa-enter-account-info.next':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'select',priority:2,method:function(){}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-account-info.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-phone-number':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}}],'fxa-enter-phone-number.send-sms':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}},{l10nId:'send-sms',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-phone-number.resend-sms':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}},{l10nId:'resend-sms',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-otp':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}}],'fxa-email':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-email.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-email.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-valueselector':[{l10nId:'cancel',priority:1,method:null,},{l10nId:'select',priority:2,method:null,}],'fxa-set-password':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-set-password.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-set-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-password':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}}],'fxa-enter-password.next':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-change-password':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-change-password.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-change-password.loading':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-signup-success':[{l10nId:'fxa-next',priority:3,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-send-success':[{l10nId:'fxa-next',priority:3,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-forgot-password':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'fxa-forgot-password-sk',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-forgot-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back(true);}}],'fxa-forgot-password-success':[{l10nId:'fxa-ok',priority:2,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-reset-password-success':[{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-multiple-sign-in-attempts':[{l10nId:'fxa-ok',priority:2,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}]};this.softkeyItems={'fxa-about':[{l10nId:'fxa-decline',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}},{l10nId:'fxa-accept',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-in':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-signin-rsk',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-in.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-sign-out':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-sign-out.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-check-password':[{l10nId:'fxa-forgot-password-sk',priority:1,method:function(){FxaModuleNavigation.back(true);}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-check-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-account-info':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'select',priority:2,method:function(){}}],'fxa-enter-account-info.next':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'select',priority:2,method:function(){}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-account-info.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-phone-number':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}}],'fxa-enter-phone-number.send-sms':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}},{l10nId:'send-sms',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-phone-number.resend-sms':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}},{l10nId:'resend-sms',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-otp':[{l10nId:'not-now',priority:1,method:function(){window.parent.FxAccountsUI.error({verifiedResult:false});}}],'fxa-email':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-email.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}},{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-email.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-valueselector':[{l10nId:'cancel',priority:1,method:null,},{l10nId:'save',priority:2,method:null,}],'fxa-set-password':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-set-password.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(function(){});}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-set-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-enter-password':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}}],'fxa-enter-password.next':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-enter-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.done();}}],'fxa-change-password':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-change-password.next':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}},{l10nId:'fxa-next',priority:1,method:function(){FxaModuleNavigation.next();}}],'fxa-change-password.loading':[{l10nId:'cancel',priority:1,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-signup-success':[{l10nId:'fxa-next',priority:3,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-send-success':[{l10nId:'fxa-next',priority:3,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}],'fxa-forgot-password':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back();}},{l10nId:'fxa-forgot-password-sk',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-forgot-password.loading':[{l10nId:'cancel',priority:1,method:function(){FxaModuleNavigation.back(true);}}],'fxa-forgot-password-success':[{l10nId:'fxa-ok',priority:2,method:function(){window.parent.FxAccountsUI.done(function(){});}}],'fxa-reset-password-success':[{l10nId:'fxa-next',priority:3,method:function(){FxaModuleNavigation.next();}}],'fxa-multiple-sign-in-attempts':[{l10nId:'fxa-ok',priority:2,method:function(){window.parent.FxAccountsUI.done(FxaModuleStates.DONE);}}]};},get curViewId(){var viewId=null;if(this.curView){viewId=this.curView.id;var subId=this.curView.dataset.subid;if(subId&&subId.length>0){viewId+='.'+subId;}}
return viewId;},getControls:function(){var controls=null;if(this.selector&&this.curView){controls=this.curView.querySelectorAll(this.selector);}
return controls;},backKeyHandler:function(){var self=ViewManager;switch(self.curView.id){case'fxa-sign-in':case'fxa-change-password':case'fxa-sign-out':case'fxa-check-password':document.activeElement.blur();window.parent.FxAccountsUI.done(FxaModuleStates.DONE);break;case'fxa-email':FxaModuleNavigation.back();break;case'fxa-enter-phone-number':case'fxa-enter-otp':break;case'fxa-about':window.parent.FxAccountsUI.done(FxaModuleStates.DONE);break;case'fxa-set-password':FxaModuleNavigation.back();break;case'fxa-enter-password':case'fxa-enter-account-info':FxaModuleNavigation.back();break;case'fxa-send-success':FxaModuleNavigation.back();break;case'fxa-forgot-password':FxaModuleNavigation.back();break;case'fxa-forgot-password-success':window.parent.FxAccountsUI.done(function(){});break;case'fxa-reset-password-success':window.parent.FxAccountsUI.done(FxaModuleStates.DONE);break;case'fxa-multiple-sign-in-attempts':window.parent.FxAccountsUI.done(FxaModuleStates.DONE);break;default:window.parent.FxAccountsUI.done(FxaModuleStates.DONE);break;}},switchSection:function(sectionId){this.curView=$(sectionId);var headerId='';switch(sectionId){case'fxa-sign-in':this.selector='ul li,p span';headerId='firefox-accounts-title-sign-in';break;case'fxa-enter-account-info':this.selector='.focusable';headerId='kaios-accounts-title-account-info';break;case'fxa-enter-phone-number':this.selector='ul li';headerId='kaios-accounts-phone-verification';break;case'fxa-enter-otp':this.selector='ul li';headerId='kaios-accounts-phone-verification';break;case'fxa-about':this.selector='p';headerId='kaios-accounts-title-about-kaios-account';break;case'fxa-email':this.selector='ul li,p span';headerId='fxa-create-account-title';break;case'fxa-set-password':this.selector='ul li';headerId='fxa-setup-password-title';break;case'fxa-enter-password':this.selector='ul li';headerId='fxa-setup-password-title';break;case'fxa-change-password':this.selector='ul li';headerId='fxa-change-password-title';break;case'fxa-signup-success':this.selector='p';headerId='fxa-signup-success-title';break;case'fxa-send-success':this.selector='ul li';headerId='firefox-accounts-title';break;case'fxa-forgot-password':this.selector='ul li';headerId='fxa-forgot-password-title';break;case'fxa-forgot-password-success':this.selector='ul li';headerId='fxa-forgot-password-success-title';break;case'fxa-reset-password-success':this.selector='ul li';headerId='fxa-forgot-password-success-title';break;case'fxa-sign-out':this.selector='ul li';headerId='fxa-sign-out-title';break;case'fxa-check-password':this.selector='.focusable';headerId='fxa-check-password-title';break;case'fxa-multiple-sign-in-attempts':this.selector='ul li';headerId='fxa-multiple-sign-in-attempts-title';break;}
this.mainHeader.setAttribute('data-l10n-id',headerId);this.mainHeader.textContent=lget(headerId);},setMethod:function(viewId,index,method){console.log('setMethod',viewId,index,method);this.softkeyItems[viewId][index].method=method;},resetMethod:function(viewId){if(undefined===viewId){viewId=ViewManager.curViewId;}
for(var index in this.constSoftkeyItems[viewId]){var method=this.constSoftkeyItems[viewId][index].method;this.softkeyItems[viewId][index].method=method;}},setSkMenu:function(viewId){var self=ViewManager;var items=null;if(undefined===viewId){viewId=ViewManager.curViewId;}
items=self.softkeyItems[viewId];self.previousItem=items;if(items){self.create(items);}},setSkMenu4Dialog:function(id){var self=ViewManager;if(id){self.create(self.softkeyItems[id]);}},create:function(items){if(!items||items.length===0){if(this.softkey){this.softkey.hide();}
return;}
var skParams={header:'App Header',items:items};if(!this.softkey){this.softkey=new SoftkeyPanel(skParams);}else{this.softkey.initSoftKeyPanel(skParams);}
this.softkey.show();},getSk:function(priority){var sks=this.softkeyItems[this.curViewId];if(undefined===priority){priority=sks[0].priority;}
var ids=['left','center','rigth'];return $('software-keys-'+ids[priority-1]);},updateSkText:function(l10nId,priority){var sk=this.getSk(priority);if(sk){sk.innerHTML=l10nId==''?'':lget(l10nId);}},setSkVisible:function(visibile,priority){var sk=this.getSk(priority);if(sk){sk.setVisible(visibile);}},disable:function(disable,priority){var sk=this.getSk(priority);if(sk){sk.disabled=disable;}},hide:function(){this.softkey.hide();},menuVisible:function(){return this.softkey?this.softkey.menuVisible:false;},dirKeyHandler:function(arrowDir){if(ViewHelper.dirChange){ViewHelper.dirChange.call(ViewHelper,arrowDir);}},endKeyHandler:function(){window.close();},enterKeyHandler:function(){},otherHandler:function(key){this.debug(key);switch(key){case'*':break;case'#':break;}},defaultBackHandler:function(viewId){if(undefined===viewId){viewId=ViewHelper.curViewId;}
delete NavigationMap.focusedControls[viewId];},get showingMenu(){return false;},};