define([],function(){function e(e,t,n){function r(t,n){var r=e[n];if(r){var i=r.indexOf(t);i>=0&&r.splice(i,1)}}"function"==typeof t?Object.keys(e).forEach(r.bind(null,t)):n?r(n,t):t in e&&(e[t]=[])}function t(t){var n=t||[],r={insert:[],remove:[],replace:[],reset:[]},i=function(e,t){var n=r[e];n.forEach(function(n){n({type:e,data:t})})};return{get length(){return n.length},get array(){return n},forEach:function(e){n.forEach(e)},observe:function(e,t){var n=r[e];n&&n.push(t)},unobserve:e.bind(null,r),push:function(e){n.push(e),i("insert",{index:n.length-1,count:1,items:[e]})},pop:function(){if(n.length){var e=n.pop();return i("remove",{index:n.length,count:1}),e}},splice:function(e,t){if(!(arguments.length<2)){var r=Array.prototype.slice.call(arguments,2);n.splice.apply(n,arguments),t&&i("remove",{index:e,count:t}),r.length&&i("insert",{index:e,count:r.length,items:r})}},set:function(e,t){if(!(0>e||e>=n.length)){var r=n[e];n[e]=t,i("replace",{index:e,oldValue:r,newValue:t})}},get:function(e){return n[e]},reset:function(e){n=e,i("reset",{items:n})}}}return t});