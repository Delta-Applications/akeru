'use strict';(function(window){window.OrientationManager={init:function om_init(){this.fetchDefaultOrientation();if(SettingsListener){SettingsListener.observe('screen.orientation.lock',true,function(value){this.globalOrientation=value?this.fetchCurrentOrientation():null;this.publish('reset-orientation');}.bind(this));}
window.addEventListener('lockscreen-appclosing',this);window.addEventListener('attentionclosed',this);window.addEventListener('searchclosing',this);window.Service&&window.Service.registerState('isOnRealDevice',this);},handleEvent:function om_handleEvent(evt){switch(evt.type){case'attentionclosed':case'lockscreen-appclosing':case'searchclosing':if(Service.query('locked')){return;}
this.publish('reset-orientation');break;}},globalOrientation:null,defaultOrientation:screen.mozOrientation,isDefaultPortrait:function(){return(this.defaultOrientation==='portrait-primary');},_isOnRealDevice:undefined,isOnRealDevice:function sl_isOnRealDevice(){if(typeof(this._isOnRealDevice)!=='undefined')
return this._isOnRealDevice;if(window.innerWidth===screen.availWidth){this._isOnRealDevice=true;}else{this._isOnRealDevice=false;}
return this._isOnRealDevice;},fetchDefaultOrientation:function sl_fetchDefaultOrientation(){if(!this.isOnRealDevice()){this.defaultOrientation=window.innerWidth>window.innerHeight?'landscape-primary':'portrait-primary';}else{screen.mozLockOrientation('default');this.defaultOrientation=screen.mozOrientation;}},fetchCurrentOrientation:function sl_fetchCurrentOrientation(){if(!this.isOnRealDevice()){return window.innerWidth>window.innerHeight?'landscape-primary':'portrait-primary';}else{return screen.mozOrientation;}},publish:function sl_publish(eventName,detail){var evt=document.createEvent('CustomEvent');evt.initCustomEvent(eventName,true,false,detail);window.dispatchEvent(evt);}};OrientationManager.init();}(this));