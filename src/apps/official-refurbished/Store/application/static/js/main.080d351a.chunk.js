(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{159:function(t,e,n){t.exports=n(322)},160:function(t,e,n){},167:function(t,e,n){},169:function(t,e,n){},171:function(t,e,n){},172:function(t,e,n){"use strict";n.r(e);var r=n(2),o=n(3),a=n(5),i=n(7),c=n(1),s=n(155),u=n.n(s),l=n(156),f=n.n(l),h=n(40);function p(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(c.a)(t);if(e){var o=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(i.a)(this,n)}}var d="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_.",v="debug-forwarder",y="/data/local/service/debug-forwarder",g=".forwarder_token",b="(mkdir -p ".concat(y," && ")+"(cp ".concat("/data/media","/tmp.").concat(v,".bin ").concat(y,"/").concat(v," || ")+"cp ".concat("/sdcard","/tmp.").concat(v,".bin ").concat(y,"/").concat(v,") && ")+"echo 'Copied daemon to ".concat(y,"/' && ")+"chmod 700 ".concat(y,"/").concat(v,") > ").concat("/sdcard/store-self-debug.log"," 2>&1; ")+"".concat(y,"/").concat(v," 6000 /data/local/debugger-socket 127.0.0.1")+">/dev/null </dev/null 2>/dev/null & "+"echo 'Started daemon' > ".concat("/sdcard/store-self-debug.log","; ");var m=new(function(t){Object(a.a)(n,t);var e=p(n);function n(){var t;return Object(r.a)(this,n),(t=e.call(this)).loading=null,t}return Object(o.a)(n,[{key:"load",value:function(){this.loading=new Promise(function(t,e){function n(t){alert("Something went wrong with the daemon initialization.\nPlease manually follow the instructions at https://gitlab.com/affenull2345/kaios-self-debug and run the following command in 'adb shell'; then dismiss this dialog:\n\nprintf '".concat(t,"' > '").concat(y,"/").concat(g,"'\n\nIf the problem persists, please create an issue at https://gitlab.com/affenull2345/store-client and mention your phone model, firmware version and KaiOS version."))}for(var r="",o=0;o<32;o++)r+=d[Math.floor(Math.random()*d.length)];function a(){try{var e=navigator.engmodeExtension.startUniversalCommand(b+"printf '".concat(r,"' > '").concat(y,"/").concat(g,"'"),!0);e.onsuccess=function(){setTimeout(function(){return t(r)},500)},e.onerror=function(){n(r),t(r)}}catch(o){n(r),t(r)}}var i=new XMLHttpRequest;i.open("GET","/".concat(v,".bin"),!0),i.responseType="blob",i.onload=function(){function t(t){var e=t.addNamed(i.response,"tmp.".concat(v,".bin"));e.onsuccess=function(){console.log("[self-debug] Daemon saved to sdcard0"),a()},e.onerror=function(){console.error("[self-debug] Failed to save daemon",e.error),a()}}if(200===i.status&&i.response){console.log("[self-debug] Loaded daemon",i.response);var e=navigator.getDeviceStorages("sdcard"),n=e[0].delete("tmp.".concat(v,".bin"));n.onsuccess=function(){console.log("[self-debug] Deleted old daemon file on sdcard0"),t(e[0])},n.onerror=function(){console.log("[self-debug] Did not delete old daemon file"),t(e[0])}}else console.log("[self-debug] Could not load daemon, unexpected result"),a()},i.onerror=function(){console.error("[self-debug] Could not load daemon, XHR failed"),a()};try{i.send()}catch(c){console.error("[self-debug] Could not load daemon",c),a()}}).then(function(t){return new Promise(function(e,n){var r=new u.a;r.connect("127.0.0.1",6e3,t,function(){e(r)}),r.on("error",function(t){n(new Error(t.name+" ("+t.message+")"))}),r.on("end",function(t){n()})})}).then(function(t){return new Promise(function(e,n){t.getWebapps(function(r,o){r?n(r):e({client:t,webapps:o})})})})}},{key:"installPackage",value:function(t,e,n,r){var o=this;return this.loading||this.load(),this.loading.then(function(e){var o=r?"{"+r+"}":t;return new Promise(function(t,r){console.log("[self-debug] appId=".concat(o,", installing"),n),f()(n,function(n,a){n&&r(n),e.webapps.installPackaged(a,o,function(n,o){e.webapps.close("app://".concat(o,"/manifest.webapp"),function(t){t&&console.info("Could not close app",t)}),n?r(n):t()})})})}).catch(function(t){return o.loading=null,Promise.reject(t)})}},{key:"name",get:function(){return"self-debug"}}]),n}(h.b));e.default=m},191:function(t,e,n){"use strict";n.r(e);var r=n(2),o=n(3),a=n(5),i=n(7),c=n(1),s=n(33),u=n(40);function l(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(c.a)(t);if(e){var o=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(i.a)(this,n)}}var p=null;function d(){return p||(p=new Promise(function(t,e){var n=navigator.mozApps.mgmt.getAll();n.onsuccess=function(){t(n.result)},n.onerror=function(){e(new Error(n.error.name+" "+n.error.message))}})),p}navigator.mozApps&&navigator.mozApps.mgmt&&(navigator.mozApps.mgmt.onuninstall=navigator.mozApps.mgmt.oninstall=function(){p=null,s.b.emit()});var v=function(t){Object(a.a)(n,t);var e=h(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this))._mozApp=t,o}return Object(o.a)(n,[{key:"open",value:function(){this._mozApp.launch()}},{key:"uninstall",value:function(){var t=this;return new Promise(function(e,n){var r=navigator.mozApps.mgmt.uninstall(t._mozApp);r.onsuccess=function(){e()},r.onerror=function(){n(new Error(r.error.name+" "+r.error.message))}})}},{key:"version",get:function(){return this._mozApp.manifest.version}},{key:"idHint",get:function(){return this._mozApp.origin.replace(/^app:\/\//,"")}}]),n}(u.a),y=new(function(t){Object(a.a)(n,t);var e=h(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"importPackage",value:function(t,e,n){return navigator.mozApps.mgmt.import(e).then(function(t){return Promise.resolve()}).catch(function(t){if(t instanceof DOMError)return Promise.reject(new Error(t.name+" "+t.message))})}},{key:"checkInstalledByOrigin",value:function(t){var e=new URL(t);return d().then(function(t){var n,r=l(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.origin===e.origin||o.manifestURL==="app://".concat(e.origin,"/manifest.webapp"))return Promise.resolve(new v(o))}}catch(a){r.e(a)}finally{r.f()}})}},{key:"checkInstalled",value:function(t,e,n){return d().then(function(r){var o,a=/^app:\/\/\{[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}\}/,i=l(r);try{for(i.s();!(o=i.n()).done;){var c=o.value;if(c.manifestURL===t||c.manifestURL==="app://{".concat(e,"}/manifest.webapp")||c.origin==="app://{".concat(e,"}")||c.origin===e||(a.test(c.origin)||!e)&&c.manifest&&c.manifest.name===n)return Promise.resolve(new v(c))}}catch(s){i.e(s)}finally{i.f()}})}},{key:"name",get:function(){return"mozApps-import"}}]),n}(u.b));e.default=y},192:function(t,e,n){},193:function(t,e,n){},194:function(t,e,n){},195:function(t,e,n){},196:function(t,e,n){},222:function(t,e){},224:function(t,e){},232:function(t,e){},234:function(t,e){},262:function(t,e){},263:function(t,e){},268:function(t,e){},270:function(t,e){},277:function(t,e){},296:function(t,e){},319:function(t,e,n){},32:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"a",function(){return s});var r=n(158),o=n(55),a=n(9);function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(S){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,a=Object.create(o.prototype),i=new x(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return E()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,o,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(L([])));g&&g!==e&&n.call(g,o)&&(v=g);var b=d.prototype=h.prototype=Object.create(v);function m(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=l(t[o],t,a);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=d,s(b,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(w.prototype),s(w.prototype,a,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new w(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},m(b),s(b,c,"Generator"),s(b,o,function(){return this}),s(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}var c=[n(172).default,n(191).default];function s(t,e,n){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(i().mark(function t(e,n,a){var s,u,l,f,h,p,d,v;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s=new Error("No installers found"),u=e.getInstallationMethod(),l=Object(o.a)(u,2),f=l[0],h=l[1],p=i().mark(function t(e){var o,u,l;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=!1,t.next=3,h(function(t,e){o||a(t,e)});case 3:return u=t.sent,o=!0,t.prev=5,console.log("Trying with ".concat(c[e].name,".").concat(f)),a("Installing [".concat(c[e].name,"]")+("self-debug"===c[e].name?" - be patient!":"")),t.next=10,(l=c[e])[f].apply(l,[n].concat(Object(r.a)(u.args)));case 10:return t.t0=t.sent,t.abrupt("return",{v:t.t0});case 14:t.prev=14,t.t1=t.catch(5),console.error("Install error",t.t1),s=t.t1;case 18:case"end":return t.stop()}},t,null,[[5,14]])}),d=0;case 4:if(!(d<c.length)){t.next=12;break}return t.delegateYield(p(d),"t0",6);case 6:if("object"!==typeof(v=t.t0)){t.next=9;break}return t.abrupt("return",v.v);case 9:d++,t.next=4;break;case 12:throw s;case 13:case"end":return t.stop()}},t)}))).apply(this,arguments)}},320:function(t,e,n){},321:function(t,e,n){},322:function(t,e,n){"use strict";n.r(e);var r=n(0),o=(n(160),n(2)),a=n(3),i=n(5),c=n(7),s=n(1),u=(n(161),n(53)),l=n(19),f=n(56);n(162);function h(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var p=function(t){Object(i.a)(n,t);var e=h(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={index:0},r.childRefs=[],r}return Object(a.a)(n,[{key:"componentDidMount",value:function(){this.handleKeyDown_bound=this.handleKeyDown.bind(this),document.addEventListener("keydown",this.handleKeyDown_bound)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown_bound)}},{key:"renderChildren",value:function(){var t=this;return this.props.children.map(function(e,n){return Object(u.a)(e,{isActive:t.state.index===n,ref:function(e){return t.childRefs[n]=e}})})}},{key:"render",value:function(){return Object(r.g)(1,"div","kai-tabs",this.renderChildren(),0)}},{key:"handleKeyDown",value:function(t){var e=this.state.index;"ArrowLeft"===t.key?(this.setTabActive(e,!1),--e<0&&(e=this.props.children.length-1),this.setTabActive(e,!0),this.setState({index:e}),this.props.onChangeIndex&&this.props.onChangeIndex(e)):"ArrowRight"===t.key&&(this.setTabActive(e,!1),++e>=this.props.children.length&&(e=0),this.setTabActive(e,!0),this.setState({index:e}),this.props.onChangeIndex&&this.props.onChangeIndex(e))}},{key:"setTabActive",value:function(t,e){this.props.children.length>t&&(this.props.children[t].props.isActive=e,e&&this.childRefs[t]&&Object(f.a)(Object(l.a)(this.childRefs[t]),{behavior:"smooth",block:"start",inline:"center"}))}}]),n}(r.a);n(163);function d(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var v=function(t){Object(i.a)(n,t);var e=d(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var t=this.props.isActive?"kai-tab-active":"kai-tab-inactive";return Object(r.g)(1,"div",t,Object(r.g)(1,"div",t+"-label",this.props.label,0),2)}}]),n}(r.a);function y(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var g=function(t){Object(i.a)(n,t);var e=y(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={active:0},r}return Object(a.a)(n,[{key:"handleChangeIndex",value:function(t){this.setState({active:t})}},{key:"renderTabs",value:function(){return this.props.tabLabels.map(function(t,e){return Object(r.c)(2,v,{label:t})})}},{key:"renderContent",value:function(){var t=this;return this.props.children.map(function(e,n){return n===t.state.active?e:null})}},{key:"render",value:function(){return Object(r.g)(1,"div","kai-tab-view",[Object(r.g)(1,"div","kai-tab-view-tabs",Object(r.c)(2,p,{onChangeIndex:this.handleChangeIndex.bind(this),children:this.renderTabs()}),2),Object(r.g)(1,"div","kai-tab-view-content",this.renderContent(),0)],4)}}]),n}(r.a);n(164),n(165);function b(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var m=function(t){Object(i.a)(n,t);var e=b(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"handleClick",value:function(t){t.preventDefault(),this.props.handleClick&&this.props.handleClick()}},{key:"handleFocus",value:function(t){t.preventDefault(),t.relatedTarget?t.relatedTarget.focus():t.currentTarget.blur()}},{key:"render",value:function(){var t=null;return this.props.icon&&(t=-1===this.props.icon.toString().indexOf("kai-")?Object(r.g)(1,"img",null,null,1,{src:this.props.icon,width:20,height:20,alt:""}):Object(r.g)(1,"span",this.props.icon)),Object(r.g)(1,"button","kai-softkey-btn",[t,this.props.text],0,{id:this.props.id,onClick:this.handleClick.bind(this),onFocus:this.handleFocus.bind(this),"data-icon":t?"true":null})}}]),n}(r.a),w=function(t){Object(i.a)(n,t);var e=b(n);function n(){var t;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).handleKeyDown=function(e){switch(e.key){case"<":case"SoftLeft":t.props.leftCallback&&t.props.leftCallback();break;case">":case"SoftRight":t.props.rightCallback&&t.props.rightCallback();break;case"Enter":t.props.centerCallback&&t.props.centerCallback();break;default:return}e.stopPropagation()},t}return Object(a.a)(n,[{key:"componentDidMount",value:function(){this.keyboardReceiver=this.props.keyboardReceiver||document,this.keyboardReceiver.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){this.keyboardReceiver.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return Object(r.g)(1,"div","kai-softkey visible",[Object(r.c)(2,m,{id:"sk-left",pos:"left",text:this.props.leftText,icon:this.props.leftIcon,handleClick:this.props.leftCallback}),Object(r.c)(2,m,{id:"sk-center",pos:"center",text:this.props.centerText,icon:this.props.centerIcon,handleClick:this.props.centerCallback}),Object(r.c)(2,m,{id:"sk-right",pos:"right",text:this.props.rightText,icon:this.props.rightIcon,handleClick:this.props.rightCallback})],4)}}]),n}(r.a);function k(t){var e=t.children,n=t.settings,r=t.isActive,o=Array.isArray(e)?e[0]:e;return Object(u.a)(o,{ref:r?function(t){!function(t,e){var n=Object(l.a)(t);n&&(setTimeout(function(){n.focus()},10),Object(f.a)(n,e))}(t,n||{behavior:"auto",block:"nearest",inline:"start"})}:null})}n(166),n(167);function O(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var j=document.getElementById("modal-root"),x=function(t){Object(i.a)(n,t);var e=O(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).handleKeydown=function(t){switch(t.stopPropagation(),"Enter"!==t.key&&t.preventDefault(),t.key){case"Backspace":r.props.onClose&&r.props.onClose();break;case"ArrowDown":r.setState({selected:(r.state.selected+1)%r.props.children.length||0});break;case"ArrowUp":r.setState({selected:(r.state.selected+r.props.children.length-1)%r.props.children.length||0})}},r.el=document.createElement("div"),r.el.className="kai-dialog",r.el.tabIndex=0,r.state={selected:0},r}return Object(a.a)(n,[{key:"componentDidMount",value:function(){j.appendChild(this.el),this.el.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){this.el.removeEventListener("keydown",this.handleKeydown),j.removeChild(this.el)}},{key:"render",value:function(){var t=this,e=this.props,n=e.header,o=e.children,a=e.onClose;return Object(r.e)(Object(r.d)([Object(r.g)(1,"div","kai-dialog-wrapper",[n&&Object(r.g)(1,"div","kai-dialog-header h1",n,0),Object(r.g)(1,"div","select-popup-container",o.map(function(e,n){return Object(r.c)(2,k,{isActive:t.state.selected===n,children:e})}),0)],0),Object(r.c)(2,w,{leftText:"Cancel",leftCallback:function(){a&&a()},centerText:"Select",centerCallback:function(){document.activeElement.dispatchEvent(new MouseEvent("click"))},keyboardReceiver:this.el})],4),this.el)}}]),n}(r.a);n(168),n(169);function L(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var E=function(t){Object(i.a)(n,t);var e=L(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={isFocused:!1},r}return Object(a.a)(n,[{key:"handleFocus",value:function(){this.buttonRef&&this.buttonRef.focus()}},{key:"handleButtonFocus",value:function(t){this.setState({isFocused:t})}},{key:"render",value:function(){var t=this,e="kai-rbl-button-input-".concat(this.state.isFocused?"focused":"unfocused"),n="kai-rbl".concat(this.state.isFocused?" kai-rbl-focused":"");return Object(r.g)(1,"div",n,[Object(r.g)(1,"div","kai-rbl-line left",Object(r.g)(1,"div","kai-rbl-primary",this.props.children,0),2),Object(r.g)(1,"div","kai-rbl-button",Object(r.g)(64,"input",e,null,1,{tabIndex:-1,type:"radio",checked:this.props.isChecked,onFocus:function(){return t.handleButtonFocus(!0)},onBlur:function(){return t.handleButtonFocus(!1)},onClick:function(){return t.props.onSelect&&t.props.onSelect()}},null,function(e){return t.buttonRef=e}),2)],4,{tabIndex:-1,onFocus:function(){return t.handleFocus()}})}}]),n}(r.a),S=null;function _(t){(S||(S=new Promise(function(t,e){navigator.mozApps&&navigator.mozApps.getSelf||(console.log("No mozApps interface, will disable toaster"),e(new Error("No toaster")));var n=navigator.mozApps.getSelf();n.onsuccess=function(){n.result.connect("systoaster").then(function(e){t(e)}).catch(function(t){console.log("Disabling toaster due to connection error",t),e()})},n.onerror=function(){console.log("Disabling toaster, failed to getSelf()"),e()}}))).then(function(e){e.forEach(function(e){e.postMessage({message:t})})}).catch(function(e){console.warn(e),alert(t)})}n(170),n(171);function P(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var R=function(t){Object(i.a)(n,t);var e=P(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={focused:!1},r}return Object(a.a)(n,[{key:"render",value:function(){var t=this,e=this.state.focused?"kai-text-input kai-text-input--focused item-selected":"kai-text-input";return Object(r.g)(1,"div",e,[Object(r.g)(1,"label","kai-text-input-label p-thi",this.props.label,0),Object(r.g)(64,"input","kai-text-input-input p-pri",null,1,{type:this.props.type,onBlur:this.handleBlur.bind(this),onChange:this.handleChange.bind(this),value:this.props.value,placeholder:this.props.placeholder},null,function(e){return t.inp=e})],4,{id:this.props.id,tabIndex:0,onFocus:this.handleFocus.bind(this)})}},{key:"handleChange",value:function(){this.props.value=this.inp.value,this.props.onChange&&this.props.onChange()}},{key:"handleFocus",value:function(){this.props.onFocus&&this.props.onFocus(),this.setState({focused:!0}),this.inp.focus()}},{key:"handleBlur",value:function(){this.props.onBlur&&this.props.onBlur(),this.setState({focused:!1})}}]),n}(r.a),A=n(32),C=n(33);n(192);function T(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var I=function(t){Object(i.a)(n,t);var e=T(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={extendedMetadata:null},r}return Object(a.a)(n,[{key:"renderExtendedMetadata",value:function(){var t=this;if(!this.state.extendedMetadata)return this.props.app.getExtendedMetadata().then(function(e){t.setState({extendedMetadata:e})}).catch(function(e){t.setState({extendedMetadata:{error:e}})}),null;var e=this.state.extendedMetadata;return Object.keys(e).map(function(t){switch(t){case"developer":return Object(r.g)(1,"div",null,[Object(r.g)(1,"b",null,"Developers:",16),e[t].name],0);case"license":return Object(r.g)(1,"div",null,[Object(r.g)(1,"b",null,"License:",16),e[t]],0);case"download_count":return Object(r.g)(1,"div",null,[Object(r.g)(1,"b",null,"Downloads:",16),e[t]],0);case"error":return Object(r.g)(1,"div",null,[Object(r.g)(1,"b",null,"Failed to get metadata:",16),"".concat(e[t])],0);default:return null}})}},{key:"render",value:function(){return Object(r.g)(1,"div","AppDetail",[Object(r.g)(1,"div","p-sec",this.props.app.description,0),Object(r.g)(1,"div","AppDetailMetadata",this.renderExtendedMetadata(),0)],4)}}]),n}(r.a);n(193);function N(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var F=document.getElementById("modal-root"),G=function(t){Object(i.a)(n,t);var e=N(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).el=document.createElement("div"),r.el.className="AppViewContainer",r.el.tabIndex=0,r.state={status:"",installState:"unknown",locked:!1},r}return Object(a.a)(n,[{key:"open",value:function(){this.installedApp.open()}},{key:"uninstall",value:function(){var t=this;console.log(this.installedApp),"not-installed"!==this.state.installState&&this.installedApp&&window.confirm("Uninstall "+this.props.app.name+"?")&&this.installedApp.uninstall().then(function(){t.setState({downloading:!1,status:"Uninstalled",installState:"not-installed"})})}},{key:"install",value:function(){var t=this;this.setState({status:"Installing",locked:!0}),Object(A.a)(this.props.app,this.installedApp?this.installedApp.idHint:void 0,function(e,n){t.setState({status:"number"===typeof n?"".concat(e," (").concat(n,"%)"):e})}).then(function(){t.setState({status:"Installed!",locked:!1})}).catch(function(e){alert("While installing app: "+e),t.setState({status:"Failed",locked:!1})})}},{key:"download",value:function(){var t=this;this.setState({downloading:!0}),this.props.app.downloadPackage().then(function(e){var n=URL.createObjectURL(e),r=document.createElement("a");r.href=n;r.download="".concat(t.props.app.name.replace(/\W/g,"_"),".zip"),r.dispatchEvent(new MouseEvent("click")),t.setState({downloading:!1}),setTimeout(function(){URL.revokeObjectURL(n)},1e3)})}},{key:"handleKeyDown",value:function(t){t.stopPropagation(),t.preventDefault();var e=null;switch(t.key){case"Backspace":this.state.locked?window.confirm("Abort installation?")&&window.location.reload():this.props.onClose&&this.props.onClose();break;case"ArrowDown":this.boxRef&&(e=Object(l.a)(this.boxRef)),e&&e.scrollBy({top:10,left:0});break;case"ArrowUp":this.boxRef&&(e=Object(l.a)(this.boxRef)),e&&e.scrollBy({top:-10,left:0})}}},{key:"componentDidMount",value:function(){F.appendChild(this.el),this.handleKeyDown_bound=this.handleKeyDown.bind(this),this.el.addEventListener("keydown",this.handleKeyDown_bound),this.el.focus(),C.b.subscribe(this.updateInstallState.bind(this))}},{key:"componentWillUnmount",value:function(){F.removeChild(this.el),this.el.removeEventListener("keydown",this.handleKeyDown_bound),C.b.unsubscribe(this.updateInstallState.bind(this))}},{key:"updateInstallState",value:function(){var t=this;Object(C.a)(this.props.app).then(function(e){if(e)return t.installedApp=e,t.props.app.checkUpdatable(e.version).then(function(e){t.setState({installState:e?"updatable":"installed"})});t.setState({installState:"not-installed"})}).catch(function(e){console.error("Install check failed",e),t.setState({status:"Install check failed",installState:"check-failed"})}),this.setState({installState:"checking"})}},{key:"render",value:function(){var t=this;return"unknown"===this.state.installState&&this.updateInstallState(),Object(r.e)(Object(r.d)([Object(r.g)(1,"div","AppView",[Object(r.g)(1,"div","AppViewHeader",[Object(r.g)(1,"h3",null,this.props.app.name,0),Object(r.g)(1,"div","AppViewStatus",this.state.status,0)],4,{style:"background-image: url(".concat(this.props.app.findIcon(60),")")}),Object(r.c)(2,I,{app:this.props.app})],4,null,null,function(e){return t.boxRef=e}),Object(r.c)(2,w,{leftText:this.state.downloading?"Saving":"Save",centerText:this.state.locked?"":"installed"===this.state.installState?"Open":"updatable"===this.state.installState?"Update":"Install",rightText:this.state.locked?"":"not-installed"===this.state.installState?"":"checking"===this.state.installState?"Checking...":"Uninstall",leftCallback:function(){return!t.state.downloading&&t.download()},centerCallback:this.state.locked?null:"installed"===this.state.installState?this.open.bind(this):this.install.bind(this),rightCallback:this.state.locked?null:this.uninstall.bind(this),keyboardReceiver:this.el})],4),this.el)}}]),n}(r.a);n(194);function B(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var M=function(t){Object(i.a)(n,t);var e=B(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={focused:!1,open:!1},r}return Object(a.a)(n,[{key:"render",value:function(){var t=this;return Object(r.g)(1,"div","app-button",[Object(r.g)(1,"button","app-button-button",this.props.app.name,0,{style:"background-image: url(".concat(this.props.app.findIcon(56),")"),onBlur:function(){return t.handleBlur()},onClick:function(){return t.handleClick()}},null,function(e){return t.btn=e}),this.state.open?Object(r.c)(2,G,{app:this.props.app,onClose:function(){return t.handleFocus()}}):null],0,{tabIndex:0,onFocus:function(){return t.handleFocus()}})}},{key:"handleClick",value:function(){this.setState({focused:!0,open:!0})}},{key:"handleFocus",value:function(){this.setState({focused:!0,open:!1}),this.btn.focus()}},{key:"handleBlur",value:function(){this.setState({focused:!1})}}]),n}(r.a);n(195);function D(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var U=function(t){Object(i.a)(n,t);var e=D(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).handleKeydown=function(t){var e=r.state.selected;"ArrowUp"===t.key?(t.preventDefault(),--e>=0?r.setState({selected:e}):-1===e&&r.props.canNavigateUp&&(r.setState({selected:e}),r.props.onNavigateUp())):"ArrowDown"===t.key&&(t.preventDefault(),e++,r.state.loading||(e<r.apps.length&&r.setState({selected:e}),e>=r.apps.length-2&&!r.state.isLastPage&&(r.setState({loading:!0,selected:e,isLastPage:!1}),r.loadNextPage())))},r.apps=[],r.state={loading:!1,loadedPages:0,isLastPage:!1,selected:0},r.savedFilters=t.filters,r}return Object(a.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"loadNextPage",value:function(t){var e=this,n=this.state.loadedPages+1;return this.props.store.getApps(this.props.filters,10*(n-1),10).then(function(t){var r=t.apps,o=t.isLastPage;console.log("[AppList] Is last page:",o),e.apps=e.apps.concat(r),e.setState({loading:!1,loadedPages:n,isLastPage:o})}).catch(function(t){console.error("Failed to load next page",t),setTimeout(function(){e.loadNextPage()},3e3)})}},{key:"renderApps",value:function(){var t=this;return this.props.filters!==this.savedFilters?(this.savedFilters=this.props.filters,this.apps=[],this.loading=!1,void this.setState({loading:!1,loadedPages:0,isLastPage:!1,selected:0})):0===this.state.loadedPages?(this.loading||(this.loading=!0,this.loadNextPage()),"Loading..."):0===this.apps.length?Object(r.g)(1,"div","AppListEmpty p-pri","No results.",16):this.apps.map(function(e,n){return Object(r.c)(2,k,{isActive:t.props.useFocus&&t.state.selected===n,settings:{behavior:"smooth",block:"center",inline:"start",duration:600},children:Object(r.c)(2,M,{app:e})})})}},{key:"render",value:function(){return Object(r.g)(1,"div","AppList",this.renderApps(),0)}}]),n}(r.a);n(196);function K(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var z=function(t){Object(i.a)(n,t);var e=K(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).handleKeydown=function(t){"Backspace"===t.key&&r.props.onClose&&(t.preventDefault(),r.props.onClose())},r.handleKeyup=function(t){"Enter"===t.key&&r.state.searchActive&&r.updateKeywords()},r.state={keywords:[],searchActive:!0},r.appList=null,r.search="",r}return Object(a.a)(n,[{key:"activateSearch",value:function(){var t=Object(l.a)(this.inp);t&&(t.focus(),this.setState({searchActive:!0}))}},{key:"componentDidMount",value:function(){this.activateSearch(),document.addEventListener("keydown",this.handleKeydown),document.addEventListener("keyup",this.handleKeyup)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("keyup",this.handleKeyup)}},{key:"render",value:function(){var t=this;return this.appList||(this.appList=this.state.keywords.length>0?Object(r.c)(2,U,{store:this.props.store,filters:{keywords:this.state.keywords},useFocus:!0,canNavigateUp:!0,onNavigateUp:function(){return t.activateSearch()}}):Object(r.g)(1,"div","SearchPlaceholder p-pri","Please enter a search term",16)),Object(r.g)(1,"div","Search",[Object(r.c)(2,R,{onChange:function(){return t.search=t.inp.props.value},onFocus:function(){return t.setState({searchActive:!0})},onBlur:function(){return t.setState({searchActive:!1})}},null,function(e){return t.inp=e}),this.appList,Object(r.c)(2,w,{leftText:"",centerText:this.state.searchActive?"Search":"Select",rightText:""})],0)}},{key:"updateKeywords",value:function(){this.appList=null,this.setState({keywords:this.search.replace(/[.,; ]+/gi," ").split(" ").filter(function(t){return t})})}}]),n}(r.a),q=n(9),H=Object(a.a)(function t(){Object(o.a)(this,t)}),J=Object(a.a)(function t(){Object(o.a)(this,t)}),Y=n(54),W=n.n(Y);function V(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function X(){X=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(E){c=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),i=new j(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return L()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=w(i,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(E){return{type:"throw",arg:E}}}t.wrap=s;var l={};function f(){}function h(){}function p(){}var d={};c(d,o,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(x([])));y&&y!==e&&n.call(y,o)&&(d=y);var g=p.prototype=f.prototype=Object.create(d);function b(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function m(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=u(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){l.value=t,i(l)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function x(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=p,c(g,"constructor",p),c(p,"constructor",h),h.displayName=c(p,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,i,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(m.prototype),c(m.prototype,a,function(){return this}),t.AsyncIterator=m,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new m(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},b(g),c(g,i,"Generator"),c(g,o,function(){return this}),c(g,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function Q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Z=["https://banana-hackers.gitlab.io/store-db","https://bananahackers.github.io/store-db"],tt=["https://bhackers.uber.space/srs/v1"];function et(t,e,n,r,o){return new Promise(function(a,i){var c=new XMLHttpRequest({mozSystem:!0});c.open(t,e,!0),c.responseType=n,c.ontimeout=function(){i(new Error("Request Timeout"))},c.onload=function(){200===c.status?a(c.response):c.status>200&&c.status<300?a(null):i(new Error("Got HTTP ".concat(c.status," status")))},c.onprogress=function(t){o&&o(t.loaded,t.total)},c.onerror=function(t){i(new Error("Request Failure"))},c.send(r)})}function nt(t,e){return rt.apply(this,arguments)}function rt(){return(rt=Object(q.a)(X().mark(function t(e,n){var r,o,a,i;return X().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=V(e),t.prev=1,r.s();case 3:if((o=r.n()).done){t.next=18;break}return a=o.value,t.prev=5,t.next=8,et("GET",a+"/download_counter/count/"+n);case 8:if("OK"===(i=t.sent)){t.next=11;break}throw new Error(i);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),console.error("Server ".concat(a," failed with"),t.t0);case 16:t.next=3;break;case 18:t.next=23;break;case 20:t.prev=20,t.t1=t.catch(1),r.e(t.t1);case 23:return t.prev=23,r.f(),t.finish(23);case 26:case"end":return t.stop()}},t,null,[[1,20,23,26],[5,13]])}))).apply(this,arguments)}function ot(t){return at.apply(this,arguments)}function at(){return(at=Object(q.a)(X().mark(function t(e){var n,r,o,a,i,c,s,u;return X().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=/[^a-z]/g,r="bhv2srs-"+e[0].replace(n,"$"),o=V(e),t.prev=3,o.s();case 5:if((a=o.n()).done){t.next=21;break}return i=a.value,t.prev=7,t.next=10,et("GET",i+"/download_counter");case 10:return c=t.sent,s=JSON.parse(c),localStorage.setItem(r,c),t.abrupt("return",s);case 16:t.prev=16,t.t0=t.catch(7),console.error("Server ".concat(i," failed with"),t.t0);case 19:t.next=5;break;case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(3),o.e(t.t1);case 26:return t.prev=26,o.f(),t.finish(26);case 29:if(!(u=localStorage.getItem(r))){t.next=32;break}return t.abrupt("return",JSON.parse(u));case 32:throw new Error("Could not load SRS data");case 33:case"end":return t.stop()}},t,null,[[3,23,26,29],[7,16]])}))).apply(this,arguments)}function it(t){return ct.apply(this,arguments)}function ct(){return(ct=Object(q.a)(X().mark(function t(e){var n,r,o,a,i;return X().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=V(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=19;break}return o=r.value,t.prev=5,t.next=8,et("GET",o+"/data.json","string",null);case 8:return a=t.sent,i=JSON.parse(a),localStorage.setItem("bhv2-save",a),t.abrupt("return",i);case 14:t.prev=14,t.t0=t.catch(5),console.error("Server ".concat(o," failed with"),t.t0);case 17:t.next=3;break;case 19:t.next=24;break;case 21:t.prev=21,t.t1=t.catch(1),n.e(t.t1);case 24:return t.prev=24,n.f(),t.finish(24);case 27:if(!localStorage.getItem("bhv2-save")){t.next=29;break}return t.abrupt("return",JSON.parse(localStorage.getItem("bhv2-save")));case 29:throw new Error("Could not load data");case 30:case"end":return t.stop()}},t,null,[[1,21,24,27],[5,14]])}))).apply(this,arguments)}function st(){return(st=Object(q.a)(X().mark(function t(e,n){var r;return X().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it(e);case 2:return r=t.sent,t.prev=3,t.next=6,ot(n);case 6:r.downloadCount=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error("SRS error",t.t0);case 12:return r.downloadCount||(r.downloadCount={}),t.abrupt("return",r);case 14:case"end":return t.stop()}},t,null,[[3,9]])}))).apply(this,arguments)}var ut=function(t){Object(i.a)(n,t);var e=Q(n);function n(t,r,a,i){var c;return Object(o.a)(this,n),(c=e.call(this))._data=r,c._dataVersion=i,c._downloadCount=a||0,c.ratings=t,c.blobPromise=c.manifestPromise=null,c}return Object(a.a)(n,[{key:"name",get:function(){return this._data.name}},{key:"description",get:function(){return this._data.description}},{key:"loadManifest",value:function(){return this._dataVersion<3?Promise.resolve({version:this._data.download.version}):(this.manifestPromise||(this.manifestPromise=et("GET",this._data.download.manifest,"string",null).then(function(t){return Promise.resolve(JSON.parse(t))})),this.manifestPromise)}},{key:"getExtendedMetadata",value:function(){var t=this;return this.loadManifest().then(function(e){return Promise.resolve({developer:{name:t._data.author.map(function(t){return t.replace(/\s*<[^>]*>$/,"")}).join(", ")},source:t._data.git_repo,has_ads:t._data.has_ads,has_tracking:t._data.has_tracking,license:t._data.license,type:t._data.type,version:e.version,download_count:t._downloadCount})})}},{key:"findIcon",value:function(t){return this._data.icon}},{key:"downloadPackage",value:function(){return this.blobPromise?this.blobPromise:this.blobPromise=et("GET",this._data.download.url,"blob",null,null)}},{key:"getInstallationMethod",value:function(){var t=this;return["importPackage",function(){var e=Object(q.a)(X().mark(function e(n){var r;return X().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.blobPromise||(t.blobPromise=et("GET",t._data.download.url,"blob",null,function(t,e){n("Downloading",Math.floor(t/e*100))})),nt(t.ratings,t._data.slug.toLowerCase()),t._downloadCount++,e.next=5,t.loadManifest();case 5:return r=e.sent,e.next=8,t.blobPromise;case 8:return e.t0=e.sent,e.t1=r.origin,e.t2=[e.t0,e.t1],e.abrupt("return",{args:e.t2});case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()]}},{key:"getIdentificationMethod",value:function(){var t=this;return this._dataVersion<3?["checkImported",Object(q.a)(X().mark(function e(){return X().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.blobPromise||(t.blobPromise=et("GET",t._data.download.url,"blob",null)),e.next=3,t.blobPromise;case 3:return e.t0=e.sent,e.t1=t._data.slug,e.t2=[e.t0,e.t1],e.abrupt("return",{args:e.t2});case 7:case"end":return e.stop()}},e)}))]:["checkInstalled",Object(q.a)(X().mark(function e(){var n;return X().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadManifest();case 2:return n=e.sent,e.abrupt("return",{args:[t._data.download.manifest,"web"===n.type&&(n.origin||t._data.slug),n.name]});case 4:case"end":return e.stop()}},e)}))]}},{key:"checkUpdatable",value:function(t){return this.loadManifest().then(function(e){return Promise.resolve(!(!t||!e.version)&&W()(e.version,t)>0)})}}]),n}(J),lt=function(t){Object(i.a)(n,t);var e=Q(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"B-Hackers Store";return Object(o.a)(this,n),(t=e.call(this)).servers=r,t.ratings=a,t.name=i,t}return Object(a.a)(n,[{key:"load",value:function(){var t=this;return function(t,e){return st.apply(this,arguments)}(this.servers,this.ratings).then(function(e){t._data=e,console.log("[bhackers-v2] Got data",e),e.version<3?console.log("[bhackers-v2] Old database version detected"):e.version>3&&console.warn("[bhackers-v2] Database version too new!"),t.categories=[{name:"Most downloaded",id:"$popular",special:!0}].concat(Object.keys(e.categories).map(function(t){return{name:e.categories[t].name,id:t}}))})}},{key:"getApps",value:function(t,e,n){var r=this,o=this._data.apps;t.keywords&&(console.log("[bhackers-v2] Keywords:",t.keywords),o=o.map(function(e){var n=0;t.keywords.forEach(function(t){t=t.toLowerCase(),e.name.toLowerCase()===t?n+=5:e.name.toLowerCase().includes(t)&&(n+=2),e.meta.tags.replace(/; */i,";").split(";").forEach(function(e){e.toLowerCase()===t?n+=3:e.toLowerCase().includes(t)&&(n+=1)}),e.description.toLowerCase().includes(t)&&(n+=2)});var r=Object.create(e);return r.searchScore=n,r}));var a=o.filter(function(e){var n=!0;return t.categories&&"$popular"!==t.categories[0].id&&(n&=t.categories.some(function(t){return e.meta.categories.includes(t.id)})),t.keywords&&(n&=e.searchScore>0),n});return t.categories&&"$popular"===t.categories[0].id&&a.sort(function(t,e){return(r._data.downloadCount[e.slug.toLowerCase()]||0)-(r._data.downloadCount[t.slug.toLowerCase()]||0)}),t.keywords&&a.sort(function(t,e){return e.searchScore-t.searchScore}),Promise.resolve({apps:a.slice(e,e+n).map(function(t){return new ut(r.ratings,t,r._data.downloadCount[t.slug.toLowerCase()],r._data.version)}),isLastPage:e+n>=a.length})}}]),n}(H),ft=n(8),ht=n(157),pt=function(){function t(e,n,r){var a=this;switch(Object(o.a)(this,t),this.auth=e,this.api=n,this.dev=r,e.method){case"api-key":this.send({method:"POST",data:{brand:r.brand,device_id:r.imei,device_type:r.type,model:r.model,os:r.os,os_version:r.version,reference:r.cu},path:"/v3.0/applications/"+n.app.id+"/tokens",headers:{Authorization:"Key "+e.key},type:"json"}).then(function(t){a.token=t,a.onload()}).catch(function(t){a.onerror(t)});break;default:this.onerror(new Error("Unknown authentication method: "+e.method))}}return Object(a.a)(t,[{key:"send",value:function(t){var e=this;return new Promise(function(n,r){if(t.path)if(t.method){var o,a=new XMLHttpRequest({mozSystem:!0}),i=t.path,c=["POST","PUT"].includes(t.method)?t.contentType&&"application/json"!==t.contentType?t.data:JSON.stringify(t.data):null;"/"===i[0]&&(i=e.api.server.url+i),"blob"!==t.type&&"arraybuffer"!==t.type||(a.responseType=t.type),a.open(t.method,i,!0),"object"===typeof t.headers&&Object.keys(t.headers).forEach(function(e){a.setRequestHeader(e,t.headers[e])}),a.setRequestHeader("Kai-API-Version",e.api.ver),a.setRequestHeader("Kai-Request-Info",'ct="wifi", rt="auto", utc="'+Date.now()+'", utc_off="1", mcc="'+e.dev.mcc+'", mnc="'+e.dev.mnc+'", net_mcc="null", net_mnc="null"'),a.setRequestHeader("Kai-Device-Info",'imei="'+e.dev.imei+'", curef="'+e.dev.cu+'"'),a.setRequestHeader("User-agent",e.dev.ua),a.setRequestHeader("Content-type",t.contentType||"application/json"),e.token&&(o={credentials:{id:e.token.kid,algorithm:"sha256",key:new ft.Buffer(e.token.mac_key,"base64")}},c&&(o.payload=c,o.contentType=t.contentType||"application/json"),a.setRequestHeader("Authorization",ht.client.header(i,t.method,o).header)),a.onerror=function(){r(new Error("request error"))},a.onprogress=function(e){t.reportProgress&&t.reportProgress("Downloading",Math.floor(e.loaded/e.total*100))},a.onload=function(){try{var e="";if(200!==a.status&&201!==a.status&&204!==a.status){if(a.responseText)try{var o=JSON.parse(a.responseText);e=" "+o.desc+": "+o.cause}catch(i){e=" "+a.responseText}r("request error ".concat(a.status,": ").concat(a.statusText," ").concat(e))}"json"===t.type?n(JSON.parse(a.responseText)):n(a.response)}catch(i){r(i)}},a.send(c)}else r(new TypeError("request missing method"));else r(new TypeError("request missing path"))})}}]),t}();function dt(){dt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(E){c=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),i=new j(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return L()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=w(i,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(E){return{type:"throw",arg:E}}}t.wrap=s;var l={};function f(){}function h(){}function p(){}var d={};c(d,o,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(x([])));y&&y!==e&&n.call(y,o)&&(d=y);var g=p.prototype=f.prototype=Object.create(d);function b(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function m(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=u(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){l.value=t,i(l)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function x(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=p,c(g,"constructor",p),c(p,"constructor",h),h.displayName=c(p,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,i,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(m.prototype),c(m.prototype,a,function(){return this}),t.AsyncIterator=m,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new m(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},b(g),c(g,i,"Generator"),c(g,o,function(){return this}),c(g,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function vt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function yt(){var t=/(KAIOS|B2GOS)\/([^ ]*)/.exec(navigator.userAgent);return t?t[2]:"2.5.4"}var gt=function(t){Object(i.a)(n,t);var e=vt(n);function n(t,r){var a;return Object(o.a)(this,n),(a=e.call(this)).requester=r,a._data=t,a}return Object(a.a)(n,[{key:"name",get:function(){return this._data.display||this._data.name}},{key:"description",get:function(){return this._data.description}},{key:"findIcon",value:function(t){if(this._data.thumbnail_url)return this._data.thumbnail_url;var e=Object.keys(this._data.icons),n=null,r=null;return e.forEach(function(e){var o=t-e;o<0&&(o=-o),(null===r||o<r)&&(n=e,r=o)}),n?this._data.icons[n]:null}},{key:"loadManifest",value:function(){return this.manifestPromise||(this.manifestPromise=this.requester.send({method:"GET",path:this._data.manifest_url,type:"json"})),this.manifestPromise}},{key:"getExtendedMetadata",value:function(){var t=this;return("string"===typeof this._data.developer&&"string"===typeof this._data.developer_url?Promise.resolve({name:this._data.developer,url:this._data.developer_url}):this.loadManifest().then(function(t){return Promise.resolve(t.developer)})).then(function(e){return Promise.resolve({developer:e,version:t._data.version,type:t._data.type})})}},{key:"downloadPackage",value:function(){var t=Object(q.a)(dt().mark(function t(){return dt().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.blobPromise){t.next=4;break}return t.next=3,this.blobPromise;case 3:return t.abrupt("return",t.sent);case 4:if(t.t0=this.requester,t.t1=this._data.package_path,t.t1){t.next=10;break}return t.next=9,this.loadManifest();case 9:t.t1=t.sent.package_path;case 10:return t.t2=t.t1,t.t3={method:"GET",path:t.t2,type:"blob"},t.next=14,this.blobPromise=t.t0.send.call(t.t0,t.t3);case 14:return t.abrupt("return",t.sent);case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getInstallationMethod",value:function(){var t=this;return["installPackage",function(){var e=Object(q.a)(dt().mark(function e(n){return dt().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.blobPromise){e.next=11;break}if(e.t0=t.requester,e.t1=t._data.package_path,e.t1){e.next=7;break}return e.next=6,t.loadManifest();case 6:e.t1=e.sent.package_path;case 7:e.t2=e.t1,e.t3=n,e.t4={method:"GET",path:e.t2,type:"blob",reportProgress:e.t3},t.blobPromise=e.t0.send.call(e.t0,e.t4);case 11:return e.t5=t._data.manifest_url,e.next=14,t.blobPromise;case 14:return e.t6=e.sent,e.t7=[e.t5,e.t6,null],e.abrupt("return",{args:e.t7});case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()]}},{key:"getIdentificationMethod",value:function(){var t=this;return["checkInstalled",Object(q.a)(dt().mark(function e(){var n;return dt().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadManifest();case 2:return n=e.sent,e.abrupt("return",{args:[t._data.manifest_url,"web"===t._data.type&&(n.origin||t._data.id),n.name]});case 4:case"end":return e.stop()}},e)}))]}},{key:"checkUpdatable",value:function(t){return Promise.resolve(!!t&&W()(this._data.version,t)>0)}}]),n}(J),bt=function(t){Object(i.a)(n,t);var e=vt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://api.kaiostech.com",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"KaiStone (KaiStore)";return Object(o.a)(this,n),(t=e.call(this)).name=a,t.settings={dev:{model:"GoFlip2",imei:"123456789012345",type:999999,brand:"AlcatelOneTouch",os:"KaiOS",version:yt(),ua:"Mozilla/5.0 (Mobile; GoFlip2; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/"+yt(),cu:"4044O-2BAQUS1-R",mcc:"0",mnc:"0"},api:{app:{id:"CAlTn_6yQsgyJKrr-nCh",name:"KaiOS Plus",ver:"2.5.4"},server:{url:r},ver:"3.0"},auth:{method:"api-key",key:"baJ_nea27HqSskijhZlT"}},t}return Object(a.a)(n,[{key:"load",value:function(){var t=this;return this.loadPromise||(this.loadPromise=new Promise(function(e,n){t.requester=new pt(t.settings.auth,t.settings.api,t.settings.dev),t.requester.onload=function(){t.requester.send({method:"GET",path:"/v3.0/categories",type:"json"}).then(function(n){console.log("[kaistone] Categories",n),t.categories=n,e()}).catch(n)},t.requester.onerror=function(t){n(t)}}))}},{key:"getApps",value:function(t,e,n){var r=this,o=!1,a=!1,i="/kc_ksfe/v1.0/apps";return Array.isArray(t.keywords)&&(o=!0,i="".concat(this.settings.api.server.url.replace("api","search"),"/v3/_search")),i+="?bookmark=false",i+="&imei="+this.settings.dev.imei,o?(i+="&platform="+this.settings.dev.version,i+="&page="+Math.floor(e/n),i+="&size="+n):(i+="&os="+this.settings.dev.version,i+="&page_size="+n,i+="&page_num="+(1+Math.floor(e/n))),i+="&mnc="+this.settings.dev.mnc+"&mcc="+this.settings.dev.mcc,t.categories&&t.categories.length>0&&(1===t.categories.length?i+="&category="+encodeURIComponent(t.categories[0].code):a=!0),o&&(i+="&query="+t.keywords.join(" "),i+="&locale="+encodeURIComponent(navigator.language)),this.requester.send({method:"GET",type:"json",path:i}).then(function(e){var n=(o?e.organic:e.apps).filter(function(e){var n=!0;return a&&(n&=t.categories.some(function(t){return e.category_list.includes(t.code)})),n});return Promise.resolve({apps:n.map(function(t){return new gt(t,r.requester)}),isLastPage:o?e.page===e.total_pages-1:e.last_page})})}}]),n}(H);n(319);function mt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var wt=function(t){Object(i.a)(n,t);var e=mt(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).stores=[new lt,new lt(["https://storedb.opengiraffes.top"],["https://opengiraffes-rating.herokuapp.com"],"OpenGiraffes (China)"),new bt,new bt("https://api.test.kaiostech.com","KaiStone test")],r.state={store:0,loaded:!1,loading:!1,searchOpen:!1,error:null},r}return Object(a.a)(n,[{key:"storeLoadComplete",value:function(t){_(this.stores[t].name),this.state.store===t&&this.setState({loaded:!0,loading:!1})}},{key:"render",value:function(){var t=this,e=this.state.selecting&&Object(r.c)(2,x,{header:"Select source",onClose:function(){return t.setState({selecting:!1})},children:this.stores.map(function(e,n){return Object(r.c)(2,E,{isChecked:n===t.state.store,onSelect:function(){return t.setState({store:n,loaded:!1,loading:!1,selecting:!1,error:null})},children:e.name})})});if(!this.state.loaded)return this.state.error?Object(r.g)(1,"div","Store",[Object(r.g)(1,"div","StoreLoadFailed",[Object(r.g)(1,"h3",null,"Loading failed",16),this.state.error],0),Object(r.c)(2,w,{leftText:"Quit",centerText:"Retry",rightText:"Switch",leftCallback:function(){return window.close()},centerCallback:function(){return t.setState({loaded:!1,loading:!1,error:null})},rightCallback:function(){return t.setState({selecting:!0})}}),e],0):(this.state.loading||(this.setState({loading:!0,loaded:!1,error:null}),this.stores[this.state.store].load().then(function(){return t.storeLoadComplete(t.state.store)}).catch(function(e){_("Failed"),t.setState({loading:!1,loaded:!1,error:e.toString()})})),Object(r.g)(1,"div","Store","Loading...",16));if(this.state.searchOpen)return Object(r.c)(2,z,{onClose:function(){return t.setState({searchOpen:!1})},store:this.stores[this.state.store]});var n=this.stores[this.state.store].categories.map(function(e){return Object(r.c)(2,U,{store:t.stores[t.state.store],filters:{categories:[e]},useFocus:!t.state.selecting})}),o=this.stores[this.state.store].categories.map(function(t){return t.name});return Object(r.g)(1,"div","Store",[Object(r.c)(2,g,{tabLabels:o,children:n}),Object(r.c)(2,w,{leftIcon:"kai-icon-search",centerText:"Select",rightText:"Switch",leftCallback:function(){return t.setState({searchOpen:!0})},rightCallback:function(){return t.setState({selecting:!0})}}),e],0)}}]),n}(r.a);n(320);function kt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ot=function(t){Object(i.a)(n,t);var e=kt(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).cb=t.onSetup,r}return Object(a.a)(n,[{key:"render",value:function(){return Object(r.g)(1,"div","Setup",Object(r.c)(2,R,{label:"Login"}),2)}},{key:"handleSetupComplete",value:function(){this.cb()}}]),n}(r.a);n(321);function jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(s.a)(t);if(e){var o=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var xt=function(t){Object(i.a)(n,t);var e=jt(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={setupDone:!0},r}return Object(a.a)(n,[{key:"render",value:function(){var t=this;return this.state.setupDone?Object(r.g)(1,"div","App",Object(r.c)(2,wt),2):Object(r.g)(1,"div","App",Object(r.c)(2,Ot,{onSetup:function(){return t.setState({setupDone:!0})}}),2)}}]),n}(r.a);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));navigator.mozSettings&&navigator.mozSettings.createLock().set({"debugger.remote-mode":"adb-devtools"}),Object(r.j)(Object(r.c)(2,xt),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},33:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c});var r=n(55),o=n(9),a=n(32);function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(S){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,a=Object.create(o.prototype),i=new x(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return E()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,o,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(L([])));g&&g!==e&&n.call(g,o)&&(v=g);var b=d.prototype=h.prototype=Object.create(v);function m(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=l(t[o],t,a);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=d,s(b,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(w.prototype),s(w.prototype,a,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new w(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},m(b),s(b,c,"Generator"),s(b,o,function(){return this}),s(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}var c={callbacks:[],subscribe:function(t){this.callbacks.push(t)},unsubscribe:function(t){this.callbacks=this.callbacks.filter(function(e){return e!==t})},emit:function(){this.callbacks.forEach(function(t){return t()})}};function s(t){return u.apply(this,arguments)}function u(){return(u=Object(o.a)(i().mark(function t(e){var n,o,c,s,u,l,f;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=new Error("No installers found"),o=e.getIdentificationMethod(),c=Object(r.a)(o,2),s=c[0],u=c[1],l=0;case 3:if(!(l<a.b.length)){t.next=20;break}return f=void 0,t.next=7,u();case 7:return f=t.sent,t.prev=8,t.next=11,a.b[l][s].apply(a.b[l],f.args);case 11:return t.abrupt("return",t.sent);case 14:t.prev=14,t.t0=t.catch(8),n=t.t0;case 17:l++,t.next=3;break;case 20:throw n;case 21:case"end":return t.stop()}},t,null,[[8,14]])}))).apply(this,arguments)}},40:function(t,e,n){"use strict";var r=n(9),o=n(2),a=n(3),i=n(57),c=n.n(i);function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,a=Object.create(o.prototype),i=new x(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return E()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};c(v,o,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(L([])));g&&g!==e&&n.call(g,o)&&(v=g);var b=d.prototype=h.prototype=Object.create(v);function m(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=l(t[o],t,a);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=d,c(b,"constructor",d),c(d,"constructor",p),p.displayName=c(d,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,i,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(w.prototype),c(w.prototype,a,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new w(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},m(b),c(b,i,"Generator"),c(b,o,function(){return this}),c(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function u(t){return l.apply(this,arguments)}function l(){return(l=Object(r.a)(s().mark(function t(e){var n,r,o,a;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.loadAsync(e);case 2:if(n=t.sent,r=n.file("metadata.json")){t.next=6;break}throw new Error("Package is missing metadata file");case 6:return t.t0=JSON,t.next=9,r.async("string");case 9:if(t.t1=t.sent,(o=t.t0.parse.call(t.t0,t.t1)).manifestURL){t.next=13;break}throw new Error("Metadata is missing manifestURL");case 13:if(a=n.file("application.zip")){t.next=16;break}throw new Error("Package is missing application.zip");case 16:return t.t2=o.manifestURL,t.next=19,a.async("blob");case 19:return t.t3=t.sent,t.abrupt("return",{manifestURL:t.t2,pkg:t.t3});case 21:case"end":return t.stop()}},t)}))).apply(this,arguments)}function f(t){return h.apply(this,arguments)}function h(){return(h=Object(r.a)(s().mark(function t(e){var n,r;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.loadAsync(e);case 2:if(n=t.sent,r=n.file("manifest.webapp")){t.next=6;break}throw new Error("Package is missing manifest");case 6:return t.t0=JSON,t.next=9,r.async("string");case 9:return t.t1=t.sent,t.abrupt("return",t.t0.parse.call(t.t0,t.t1));case 11:case"end":return t.stop()}},t)}))).apply(this,arguments)}function p(){p=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),i=new x(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return E()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=s;var l={};function f(){}function h(){}function d(){}var v={};c(v,o,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(L([])));g&&g!==e&&n.call(g,o)&&(v=g);var b=d.prototype=f.prototype=Object.create(v);function m(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){var r;this._invoke=function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=u(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(f).then(function(t){l.value=t,i(l)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return h.prototype=d,c(b,"constructor",d),c(d,"constructor",h),h.displayName=c(d,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,i,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(w.prototype),c(w.prototype,a,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new w(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},m(b),c(b,i,"Generator"),c(b,o,function(){return this}),c(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}n.d(e,"b",function(){return d}),n.d(e,"a",function(){return v});var d=function(){function t(){Object(o.a)(this,t)}return Object(a.a)(t,[{key:"importPackage",value:function(t,e,n,r){var o=this;return r?Promise.reject(new Error("This installer cannot import apps")):u(e).then(function(e){return o.installPackage(t,e.manifestURL,e.pkg,n,!0)})}},{key:"checkImported",value:function(){var t=Object(r.a)(p().mark(function t(e,n,r){var o;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=2;break}throw new Error("This installer cannot checkImported");case 2:return t.next=4,u(e);case 4:if(o=t.sent,t.t0=this.checkInstalled(o.manifestURL,n,!0),t.t0){t.next=12;break}return t.t1=this,t.next=10,f(o.pkg);case 10:t.t2=t.sent.origin,t.t0=t.t1.checkInstalledByOrigin.call(t.t1,t.t2);case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"installPackage",value:function(t,e,n,r,o){var a=this;return o?Promise.reject(new Error("This installer cannot install packages")):function(t){var e=new c.a;return e.file("metadata.json",JSON.stringify({manifestURL:t.manifestURL})),e.file("application.zip",t.pkg),e.generateAsync({type:"blob"})}({manifestURL:e,pkg:n}).then(function(e){return a.importPackage(t,e.pkg,r,!0)})}},{key:"installHosted",value:function(t){return Promise.reject(new Error("This installer does not support hosted apps"))}},{key:"checkInstalled",value:function(t,e,n){return Promise.reject(new Error("This installer cannot checkInstalled"))}},{key:"checkInstalledByOrigin",value:function(t){return!1}}]),t}(),v=Object(a.a)(function t(){Object(o.a)(this,t)})}},[[159,1,2]]]);
//# sourceMappingURL=main.080d351a.chunk.js.map