{"version":3,"sources":["backend/installer/self-debug.js","backend/installer/mozapps-import.js","backend/pkgutils.js","ui/Tabs.js","ui/Tab.js","ui/TabView.js","ui/SoftKey.js","ui/Focus.js","ui/SelectPopup.js","ui/RadioButtonListItem.js","Toaster.js","ui/TextInput.js","AppDetail.js","AppView.js","AppButton.js","AppList.js","Search.js","backend/AppStore.js","backend/appstore/bhackers-v2.js","backend/appstore/kaistone-requester.js","backend/appstore/kaistone.js","Store.js","Setup.js","App.js","serviceWorker.js","index.js","backend/install-app.js","backend/check-installed.js","backend/Installer.js"],"names":["token_alphabet","binary_name","daemon_base","token_file","daemon_init_cmd","concat","inst","SelfDebugInstaller","_this","Object","_builds_affenull2345_store_client_node_modules_babel_preset_inferno_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_super","call","loading","Promise","resolve","reject","failure","t","alert","token","i","Math","floor","random","length","start","cmd","navigator","engmodeExtension","startUniversalCommand","onsuccess","setTimeout","onerror","e","xhr","XMLHttpRequest","open","responseType","onload","save","storage","req","addNamed","response","console","log","error","status","storages","getDeviceStorages","del_req","delete","send","then","client","FirefoxClient","connect","on","Error","name","message","getWebapps","err","webapps","manifestURL","pkg","idHint","_this2","load","interfaces","id","extractManifest","manifest","origin","url","URL","host","blobToBuffer","buf","installPackaged","close","info","catch","Installer","getAllCachedPromise","cachedGetAll","mozApps","mgmt","getAll","result","onuninstall","oninstall","installStatusUpdate","emit","MozAppsImportedApp","mozApp","_mozApp","launch","uninstall","version","InstalledApp","import","app","DOMError","all","_step","_iterator","_createForOfIteratorHelper","s","n","done","value","f","manifest_url","_step2","_iterator2","pack","data","zip","JSZip","file","JSON","stringify","generateAsync","type","unpack","_callee","metafile","metadata","appfile","_builds_affenull2345_store_client_node_modules_babel_preset_inferno_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","wrap","_context","prev","next","loadAsync","sent","t0","async","t1","parse","t2","t3","abrupt","stop","_callee2","_context2","Tabs","props","classCallCheck","state","index","childRefs","handleKeyDown_bound","handleKeyDown","bind","document","addEventListener","removeEventListener","children","map","tab","cloneVNode","isActive","ref","node","index_esm","renderChildren","idx","key","setTabActive","setState","onChangeIndex","scrollIntoView","findDOMNode","behavior","block","inline","Component","Tab","cls","label","TabView","active","tabLabels","ui_Tab_Tab","child","ui_Tabs_Tabs","handleChangeIndex","renderTabs","renderContent","SoftKeyButton","preventDefault","handleClick","relatedTarget","focus","currentTarget","blur","renderedIcon","icon","toString","indexOf","src","width","height","alt","text","onClick","onFocus","handleFocus","data-icon","SoftKey","leftCallback","rightCallback","centerCallback","stopPropagation","keyboardReceiver","SoftKey_SoftKeyButton","pos","leftText","leftIcon","centerText","centerIcon","rightText","rightIcon","Focus","settings","Array","isArray","focusIntoView","modalRoot","getElementById","SelectPopup","handleKeydown","evt","onClose","selected","el","createElement","className","tabIndex","appendChild","removeChild","_this$props","header","createPortal","ui_SoftKey_SoftKey","activeElement","dispatchEvent","MouseEvent","RadioButtonListItem","isFocused","buttonRef","buttonCls","checked","isChecked","handleButtonFocus","onBlur","onSelect","conn","toast","msg","getSelf","forEach","postMessage","warn","TextInput","focused","handleBlur","onChange","handleChange","placeholder","inp","AppDetail","extendedMetadata","getExtendedMetadata","meta","keys","description","renderExtendedMetadata","AppView","installState","locked","installedApp","window","confirm","_this3","installApp","stage","progress","boxRef","scrollBy","top","left","subscribe","updateInstallState","unsubscribe","_this4","checkInstalled","checkUpdatable","updatable","_this5","style","findIcon","AppDetail_AppDetail","r","install","AppButton","btn","AppView_AppView","AppList","canNavigateUp","onNavigateUp","apps","isLastPage","loadNextPage","loadedPages","savedFilters","filters","after","nextPage","store","getApps","_ref","useFocus","duration","AppButton_AppButton","renderApps","Search","handleKeyup","searchActive","updateKeywords","keywords","appList","search","activateSearch","AppList_AppList","ui_TextInput_TextInput","replace","split","filter","AppStore","StoreApp","BHACKERS_SERVERS","BHACKERS_RATINGS","request","meth","rtype","mozSystem","ontimeout","onprogress","loaded","total","countDownload","_callee4","rating_servers","slug","srv","regenerator_default","_context4","finish","loadSRSData","_callee5","reg","saveName","obj","saved","_context5","localStorage","setItem","downloadCount","getItem","_callee6","servers","_iterator3","_step3","_context6","BHackersV2App","ratings","dataVersion","_data","_dataVersion","_downloadCount","blobPromise","manifestPromise","download","str","loadManifest","mf","developer","author","join","source","git_repo","has_ads","has_tracking","license","download_count","size","asyncToGenerator","mark","reportProgress","args","_x7","apply","arguments","_callee3","_context3","compareVersions","BHackersV2Store","undefined","_super2","_this6","loadData","categories","special","ctg","count","_this7","origSet","score","kw","toLowerCase","includes","tags","tag","new_app","create","searchScore","filteredSet","match","some","ct","sort","b","slice","Requester","auth","api","dev","method","brand","device_id","imei","device_type","model","os","os_version","reference","cu","path","headers","Authorization","hawkinfo","payload","contentType","server","setRequestHeader","ver","Date","now","mcc","mnc","ua","credentials","kid","algorithm","Buffer","mac_key","hawk","responseText","desc","cause","statusText","TypeError","getKaiOSVersion","kaiUA","exec","userAgent","KaiStoneApp","requester","display","preferredSize","thumbnail_url","sizes","icons","bestSize","currentDiff","diff","developer_url","package_path","t4","t5","t6","t7","t8","_x","KaiStone","loadPromise","ctgs","isSearch","clientSideCategoryFilter","encodeURIComponent","code","language","filtered","organic","category_list","page","total_pages","last_page","Store","stores","searchOpen","popup","selecting","SelectPopup_SelectPopup","ui_RadioButtonListItem_RadioButtonListItem","storeLoadComplete","Search_Search","tabs","labels","ui_TabView_TabView","Setup","cb","onSetup","App","setupDone","Store_Store","src_Setup_0","Boolean","location","hostname","mozSettings","createLock","set","debugger.remote-mode","render","src_App_0","serviceWorker","ready","registration","unregister","installers","require","default","_x2","_installApp","_app$getInstallationM","_app$getInstallationM2","loader","_loop","_ret","getInstallationMethod","_builds_affenull2345_store_client_node_modules_babel_preset_inferno_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","what","amount","v","delegateYield","callbacks","push","cb2","_checkInstalled","_app$getIdentificatio","_app$getIdentificatio2","getIdentificationMethod","calledFromImplementation","unpacked","installPackage","checkInstalledByOrigin","packed","importPackage"],"mappings":"+vBAoBA,IAAMA,EAAiB,oEACjBC,EAAc,kBAEdC,EAAc,sCACdC,EAAa,mBAIbC,EACJ,aAAAC,OAAaH,EAAb,eAAAG,OAJgB,cAIhB,SAAAA,OACwBJ,EADxB,SAAAI,OAC2CH,EAD3C,KAAAG,OAC0DJ,EAD1D,cAAAI,OAHgB,UAGhB,SAAAA,OAEuBJ,EAFvB,SAAAI,OAE0CH,EAF1C,KAAAG,OAEyDJ,EAFzD,mCAAAI,OAG0BH,EAH1B,uBAAAG,OAIaH,EAJb,KAAAG,OAI4BJ,EAJ5B,QAAAI,OAFiB,+BAEjB,sBAAAA,OAKWH,EALX,KAAAG,OAK0BJ,EAL1B,cAAAI,OAPkB,mCAOlB,mDAAAA,OAFiB,+BAEjB,qBAAAA,OAOGH,EAPH,KAAAG,OAOkBJ,EAPlB,iHAmKIK,EAAO,4CAlEX,SAAAC,IAAa,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAJ,IACXC,EAAAI,EAAAC,KAAAF,OACKG,QAAU,KAFJN,0CAIb,WACEG,KAAKG,QA1FA,IAAIC,QAAQ,SAACC,EAASC,GAC3B,SAASC,EAAQC,GACfC,MAAK,wOAAAf,OAGDc,EAHC,SAAAd,OAGQH,EAHR,KAAAG,OAGuBF,EAHvB,0IAQP,IADA,IAAIkB,EAAQ,GACJC,EAAI,EAAGA,EAAI,GAAIA,IACrBD,GAASrB,EACPuB,KAAKC,MAAMD,KAAKE,SACdzB,EAAe0B,SAErB,SAASC,IACP,IACE,IAAIC,EAAMC,UACPC,iBAAiBC,sBAChB3B,EAAe,WAAAC,OACJgB,EADI,SAAAhB,OACSH,EADT,KAAAG,OACwBF,EADxB,MAEf,GAEJyB,EAAII,UAAY,WAEdC,WAAW,kBAAMjB,EAAQK,IAAQ,MAEnCO,EAAIM,QAAU,WACZhB,EAAQG,GACRL,EAAQK,IAGZ,MAAMc,GACJjB,EAAQG,GACRL,EAAQK,IAGZ,IAAIe,EAAM,IAAIC,eACdD,EAAIE,KAAK,MAAT,IAAAjC,OAAoBJ,EAApB,SAAuC,GACvCmC,EAAIG,aAAe,OACnBH,EAAII,OAAS,WACX,SAASC,EAAKC,GACZ,IAAIC,EAAMD,EAAQE,SAASR,EAAIS,SAArB,OAAAxC,OAAsCJ,EAAtC,SACV0C,EAAIX,UAAY,WACdc,QAAQC,IAAI,wCACZpB,KAEFgB,EAAIT,QAAU,WACZY,QAAQE,MAAM,qCAAsCL,EAAIK,OACxDrB,KAGJ,GAAkB,MAAfS,EAAIa,QAAkBb,EAAIS,SAAS,CACpCC,QAAQC,IAAI,6BAA8BX,EAAIS,UAC9C,IAAIK,EAAWrB,UAAUsB,kBAAkB,UACvCC,EAAUF,EAAS,GAAGG,OAAZ,OAAAhD,OAA0BJ,EAA1B,SACdmD,EAAQpB,UAAY,WAClBc,QAAQC,IAAI,mDACZN,EAAKS,EAAS,KAEhBE,EAAQlB,QAAU,WAChBY,QAAQC,IAAI,+CACZN,EAAKS,EAAS,UAIhBJ,QAAQC,IAAI,yDACZpB,KAGJS,EAAIF,QAAU,WACZY,QAAQE,MAAM,kDACdrB,KAEF,IACES,EAAIkB,OAEN,MAAMnB,GACJW,QAAQE,MAAM,qCAAsCb,GACpDR,OAW0B4B,KAAK,SAAAlC,GAC/B,OAAO,IAAIN,QAAQ,SAACC,EAASC,GAC3B,IAAIuC,EAAS,IAAIC,IACjBD,EAAOE,QAAQ,YAAa,IAAMrC,EAAO,WACvCL,EAAQwC,KAEVA,EAAOG,GAAG,QAAS,SAAAxB,GACjBlB,EAAO,IAAI2C,MAAMzB,EAAE0B,KAAO,KAAO1B,EAAE2B,QAAU,QAE/CN,EAAOG,GAAG,MAAO,SAAAxB,GACflB,UAGHsC,KAAK,SAAAC,GACN,OAAO,IAAIzC,QAAQ,SAACC,EAASC,GAC3BuC,EAAOO,WAAW,SAACC,EAAKC,GACnBD,EAAK/C,EAAO+C,GACVhD,EAAQ,CACXwC,SACAS,gDAMV,SAAeC,EAAaC,EAAKC,GAAO,IAAAC,EAAA1D,KAItC,OAHIA,KAAKG,SACPH,KAAK2D,OAEA3D,KAAKG,QAAQyC,KAAK,SAAAgB,GACvB,IAAIC,EAAK,IAAMJ,EAAS,IACxB,OAAOK,YAAgBN,GAAKZ,KAAK,SAAAmB,GAC/B,GAAGA,EAASC,OAAO,CACjB,IAAIC,EAAM,IAAIC,IAAIH,EAASC,QAC3BH,EAAKI,EAAIE,KAEX,OAAO,IAAI/D,QAAQ,SAACC,EAASC,GAC3B6B,QAAQC,IAAR,sBAAA1C,OAAkCmE,EAAlC,gBAAoDL,GACpDY,IAAaZ,EAAK,SAACH,EAAKgB,GACnBhB,GAAK/C,EAAO+C,GACfO,EAAWN,QAAQgB,gBAAgBD,EAAKR,EAAI,SAAArC,GAC1CoC,EAAWN,QAAQiB,MAAnB,SAAA7E,OAAkCmE,EAAlC,oBAAwD,SAAArC,GACnDA,GAAGW,QAAQqC,KAAK,sBAAuBhD,KAEzCA,EAAGlB,EAAOkB,GACRnB,cAKZoE,MAAM,SAAAjD,GAEP,OADAkC,EAAKvD,QAAU,KACRC,QAAQE,OAAOkB,uBAI1B,WACE,MAAO,oBA/DsBkD,MAqElB/E,wkDChLf,IAAIgF,EAAsB,KAS1B,SAASC,IAYP,OAXID,IACFA,EAAsB,IAAIvE,QAAQ,SAACC,EAASC,GAC1C,IAAI0B,EAAMd,UAAU2D,QAAQC,KAAKC,SACjC/C,EAAIX,UAAY,WACdhB,EAAQ2B,EAAIgD,SAEdhD,EAAIT,QAAU,WACZjB,EAAO,IAAI2C,MAAMjB,EAAIK,MAAMa,KAAO,IAAMlB,EAAIK,MAAMc,cAIjDwB,EAnBNzD,UAAU2D,SAAW3D,UAAU2D,QAAQC,OACxC5D,UAAU2D,QAAQC,KAAKG,YAAc/D,UAAU2D,QAAQC,KAAKI,UAAY,WACtEP,EAAsB,KACtBQ,IAAoBC,aAmBlBC,0CACJ,SAAAA,EAAYC,GAAO,IAAAzF,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAqF,IACjBxF,EAAAI,EAAAC,KAAAF,OACKuF,QAAUD,EAFEzF,0CAInB,WACEG,KAAKuF,QAAQC,kCAEf,WAAY,IAAA9B,EAAA1D,KACV,OAAO,IAAII,QAAQ,SAACC,EAASC,GAC3B,IAAI0B,EAAMd,UAAU2D,QAAQC,KAAKW,UAAU/B,EAAK6B,SAChDvD,EAAIX,UAAY,WACdhB,KAEF2B,EAAIT,QAAU,WACZjB,EAAO,IAAI2C,MAAMjB,EAAIK,MAAMa,KAAO,IAAMlB,EAAIK,MAAMc,kCAIxD,WACE,OAAOnD,KAAKuF,QAAQxB,SAAS2B,eApBAC,KAgE3BhG,EAAO,6JAvCX,SAAc6D,EAAKC,GACjB,OAAOvC,UAAU2D,QAAQC,KAAKc,OAAOpC,GAAKZ,KAAK,SAAAiD,GAC7C,OAAOzF,QAAQC,YACdoE,MAAM,SAAAjD,GACP,GAAGA,aAAasE,SACd,OAAO1F,QAAQE,OAAO,IAAI2C,MAAMzB,EAAE0B,KAAO,IAAM1B,EAAE2B,kDAIvD,SAAuBa,GACrB,IAAIC,EAAM,IAAIC,IAAIF,GAClB,OAAOY,IAAehC,KAAK,SAAAmD,GAAO,IAAAC,EAAAC,EAAAC,EACfH,GADe,IAChC,IAAAE,EAAAE,MAAAH,EAAAC,EAAAG,KAAAC,MAAqB,KAAXR,EAAWG,EAAAM,MACnB,GAAGT,EAAI7B,SAAWC,EAAID,QACpB6B,EAAItC,cAAJ,SAAA7D,OAA6BuE,EAAID,OAAjC,oBAEA,OAAO5D,QAAQC,QAAQ,IAAIgF,EAAmBQ,KALlB,MAAAxC,GAAA4C,EAAAzE,EAAA6B,GAAA,QAAA4C,EAAAM,qCAUpC,SAAeC,EAAc/C,GAC3B,OAAOmB,IAAehC,KAAK,SAAAmD,GAAO,IAAAU,EAAAC,EAAAR,EACfH,GADe,IAChC,IAAAW,EAAAP,MAAAM,EAAAC,EAAAN,KAAAC,MAAqB,KAAXR,EAAWY,EAAAH,MACnB,GAAGT,EAAItC,cAAgBiD,GACrBX,EAAItC,cAAJ,UAAA7D,OAA8B+D,EAA9B,sBACAoC,EAAI7B,SAAJ,UAAAtE,OAAyB+D,EAAzB,MACAoC,EAAI7B,SAAWP,EAEf,OAAOrD,QAAQC,QAAQ,IAAIgF,EAAmBQ,KAPlB,MAAAxC,GAAAqD,EAAAlF,EAAA6B,GAAA,QAAAqD,EAAAH,yBAYpC,WACE,MAAO,wBApC0B7B,MA0CtB/E,wXC5Ff,SAASgH,EAAKC,GACZ,IAAIC,EAAM,IAAIC,IAKd,OAJAD,EAAIE,KAAK,gBAAiBC,KAAKC,UAAU,CACvC1D,YAAaqD,EAAKrD,eAEpBsD,EAAIE,KAAK,kBAAmBH,EAAKpD,KAC1BqD,EAAIK,cAAc,CAACC,KAAM,kBAEnBC,+EAAf,SAAAC,EAAsB7D,GAAtB,IAAAqD,EAAAS,EAAAC,EAAAC,EAAA,OAAAC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACkBhB,IAAMiB,UAAUvE,GADlC,UACMqD,EADNe,EAAAI,KAEMV,EAAWT,EAAIE,KAAK,iBAF1B,CAAAa,EAAAE,KAAA,cAGsB,IAAI7E,MAAM,oCAHhC,cAAA2E,EAAAK,GAIiBjB,KAJjBY,EAAAE,KAAA,EAIkCR,EAASY,MAAM,UAJjD,UAAAN,EAAAO,GAAAP,EAAAI,MAIMT,EAJNK,EAAAK,GAIsBG,MAJtBlI,KAAA0H,EAAAK,GAAAL,EAAAO,KAKe5E,YALf,CAAAqE,EAAAE,KAAA,eAKkC,IAAI7E,MAAM,mCAL5C,WAMMuE,EAAUX,EAAIE,KAAK,mBANzB,CAAAa,EAAAE,KAAA,eAOqB,IAAI7E,MAAM,sCAP/B,eAAA2E,EAAAS,GASiBd,EAAShE,YAT1BqE,EAAAE,KAAA,GAUeN,EAAQU,MAAM,QAV7B,eAAAN,EAAAU,GAAAV,EAAAI,KAAAJ,EAAAW,OAAA,UASIhF,YATJqE,EAAAS,GAUI7E,IAVJoE,EAAAU,KAAA,yBAAAV,EAAAY,SAAAnB,sCAaevD,+EAAf,SAAA2E,EAA+BjF,GAA/B,IAAAqD,EAAA9C,EAAA,OAAA0D,EAAAC,EAAAC,KAAA,SAAAe,GAAA,cAAAA,EAAAb,KAAAa,EAAAZ,MAAA,cAAAY,EAAAZ,KAAA,EACkBhB,IAAMiB,UAAUvE,GADlC,UACMqD,EADN6B,EAAAV,KAEMjE,EAAW8C,EAAIE,KAAK,mBAF1B,CAAA2B,EAAAZ,KAAA,cAGsB,IAAI7E,MAAM,+BAHhC,cAAAyF,EAAAT,GAISjB,KAJT0B,EAAAZ,KAAA,EAI0B/D,EAASmE,MAAM,UAJzC,cAAAQ,EAAAP,GAAAO,EAAAV,KAAAU,EAAAH,OAAA,SAAAG,EAAAT,GAIcG,MAJdlI,KAAAwI,EAAAT,GAAAS,EAAAP,KAAA,yBAAAO,EAAAF,SAAAC,yyBCfqBE,0CACnB,SAAAA,EAAYC,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAA2I,IACjB9I,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXC,MAAO,GAETlJ,EAAKmJ,UAAY,GALAnJ,uDAOnB,WACEG,KAAKiJ,oBAAsBjJ,KAAKkJ,cAAcC,KAAKnJ,MACnDoJ,SAASC,iBAAiB,UAAWrJ,KAAKiJ,yDAE5C,WACEG,SAASE,oBAAoB,UAAWtJ,KAAKiJ,mDAE/C,WAAiB,IAAAvF,EAAA1D,KACf,OAAOA,KAAK4I,MAAMW,SAASC,IAAI,SAACC,EAAK9I,GACnC,OAAO+I,YAAWD,EAAK,CACrBE,SAAUjG,EAAKoF,MAAMC,QAAUpI,EAC/BiJ,IAAK,SAAAC,GAAI,OAAInG,EAAKsF,UAAUrI,GAAKkJ,6BAIvC,WACE,OAAO/J,OAAAgK,EAAA,EAAAhK,CAAA,QACU,WAAYE,KAAK+J,iBADlC,gCAIF,SAAcvI,GACZ,IAAIwI,EAAMhK,KAAK8I,MAAMC,MACR,cAAVvH,EAAEyI,KACHjK,KAAKkK,aAAaF,GAAK,KACvBA,EACS,IAAGA,EAAMhK,KAAK4I,MAAMW,SAASxI,OAAS,GAC/Cf,KAAKkK,aAAaF,GAAK,GACvBhK,KAAKmK,SAAS,CAACpB,MAAOiB,IACnBhK,KAAK4I,MAAMwB,eAAepK,KAAK4I,MAAMwB,cAAcJ,IAEtC,eAAVxI,EAAEyI,MACRjK,KAAKkK,aAAaF,GAAK,KACvBA,GACUhK,KAAK4I,MAAMW,SAASxI,SAAQiJ,EAAM,GAC5ChK,KAAKkK,aAAaF,GAAK,GACvBhK,KAAKmK,SAAS,CAACpB,MAAOiB,IACnBhK,KAAK4I,MAAMwB,eAAepK,KAAK4I,MAAMwB,cAAcJ,gCAG1D,SAAaA,EAAKL,GACb3J,KAAK4I,MAAMW,SAASxI,OAASiJ,IAC9BhK,KAAK4I,MAAMW,SAASS,GAAKpB,MAAMe,SAAWA,EACvCA,GAAY3J,KAAKgJ,UAAUgB,IAC5BK,YAAeC,YAAYtK,KAAKgJ,UAAUgB,IAAO,CAC/CO,SAAU,SACVC,MAAO,QACPC,OAAQ,mBAtDgBC,qdCHbC,oJACnB,WACE,IAAMC,EAAM5K,KAAK4I,MAAMe,SAAW,iBAAmB,mBACrD,OAAO7J,OAAAgK,EAAA,EAAAhK,CAAA,QACW8K,EADlB9K,OAAAgK,EAAA,EAAAhK,CAAA,QAEoB8K,EAAM,SAAW5K,KAAK4I,MAAMiC,MAFhD,aAH6BH,8cCEZI,0CACnB,SAAAA,EAAYlC,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAA8K,IACjBjL,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXiC,OAAQ,GAHOlL,uDAMnB,SAAkBmK,GAChBhK,KAAKmK,SAAS,CAACY,OAAQf,8BAEzB,WACE,OAAOhK,KAAK4I,MAAMoC,UAAUxB,IAAI,SAACC,EAAK9I,GAAN,OAAAb,OAAAgK,EAAA,EAAAhK,CAAA,EAAAmL,EAAA,CAAAJ,MAClBpB,mCAGhB,WAAgB,IAAA/F,EAAA1D,KACd,OAAOA,KAAK4I,MAAMW,SAASC,IAAI,SAAC0B,EAAOvK,GAAR,OAC7BA,IAAM+C,EAAKoF,MAAMiC,OAASG,EAAQ,6BAGtC,WACE,OAAOpL,OAAAgK,EAAA,EAAAhK,CAAA,QACU,eADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAEmB,oBAFnBA,OAAAgK,EAAA,EAAAhK,CAAA,EAAAqL,EAAA,CAAAf,cAG2BpK,KAAKoL,kBAAkBjC,KAAKnJ,MAHvDuJ,SAISvJ,KAAKqL,eAJd,GAAAvL,OAAAgK,EAAA,EAAAhK,CAAA,QAOmB,uBACZE,KAAKsL,gBARZ,cArBiCZ,4dCA/Ba,yJACJ,SAAY/J,GACVA,EAAEgK,iBACCxL,KAAK4I,MAAM6C,aAAazL,KAAK4I,MAAM6C,yCAGxC,SAAYjK,GACVA,EAAEgK,iBACChK,EAAEkK,cAEHlK,EAAEkK,cAAcC,QAIhBnK,EAAEoK,cAAcC,6BAGpB,WACE,IAAIC,EAAe,KAUnB,OATG9L,KAAK4I,MAAMmD,OAEVD,GADiD,IAAhD9L,KAAK4I,MAAMmD,KAAKC,WAAWC,QAAQ,QACxBnM,OAAAgK,EAAA,EAAAhK,CAAA,qBAAAoM,IAAalM,KAAK4I,MAAMmD,KAAxBI,MAAqC,GAArCC,OAAiD,GAAjDC,IACN,KAGMvM,OAAAgK,EAAA,EAAAhK,CAAA,SAAoBE,KAAK4I,MAAMmD,OAGxCjM,OAAAgK,EAAA,EAAAhK,CAAA,WAGO,kBAHd,CAQKgM,EAAc9L,KAAK4I,MAAM0D,MAR9B,GAAAzI,GAEQ7D,KAAK4I,MAAM/E,GAFnB0I,QAIavM,KAAKyL,YAAYtC,KAAKnJ,MAJnCwM,QAKaxM,KAAKyM,YAAYtD,KAAKnJ,MALnC0M,YAMeZ,EAAe,OAAS,cAlCfpB,KA0CPiC,oMACnBzD,cAAgB,SAAC1H,GACf,OAAOA,EAAEyI,KACP,IAAK,IACL,IAAK,WACApK,EAAK+I,MAAMgE,cAAc/M,EAAK+I,MAAMgE,eACvC,MACF,IAAK,IACL,IAAK,YACA/M,EAAK+I,MAAMiE,eAAehN,EAAK+I,MAAMiE,gBACxC,MACF,IAAK,QACAhN,EAAK+I,MAAMkE,gBAAgBjN,EAAK+I,MAAMkE,iBACzC,MACF,QACE,OAIJtL,EAAEuL,0EAEJ,WACE/M,KAAKgN,iBAAmBhN,KAAK4I,MAAMoE,kBAAoB5D,SACvDpJ,KAAKgN,iBAAiB3D,iBAAiB,UAAWrJ,KAAKkJ,mDAEzD,WACElJ,KAAKgN,iBAAiB1D,oBAAoB,UAAWtJ,KAAKkJ,qCAE5D,WACE,OAAOpJ,OAAAgK,EAAA,EAAAhK,CAAA,QACU,sBADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,EAAAmN,EAAA,CAAApJ,GAGS,UAHTqJ,IAIU,OAJVZ,KAKYtM,KAAK4I,MAAMuE,SALvBpB,KAMY/L,KAAK4I,MAAMwE,SANvB3B,YAOmBzL,KAAK4I,MAAMgE,eAP9B9M,OAAAgK,EAAA,EAAAhK,CAAA,EAAAmN,EAAA,CAAApJ,GASS,YATTqJ,IAUU,SAVVZ,KAWYtM,KAAK4I,MAAMyE,WAXvBtB,KAYY/L,KAAK4I,MAAM0E,WAZvB7B,YAamBzL,KAAK4I,MAAMkE,iBAb9BhN,OAAAgK,EAAA,EAAAhK,CAAA,EAAAmN,EAAA,CAAApJ,GAeS,WAfTqJ,IAgBU,QAhBVZ,KAiBYtM,KAAK4I,MAAM2E,UAjBvBxB,KAkBY/L,KAAK4I,MAAM4E,UAlBvB/B,YAmBmBzL,KAAK4I,MAAMiE,iBAnB9B,UA7BiCnC,KCjCtB,SAAS+C,EAAM7E,GAAM,IAC1BW,EAAiCX,EAAjCW,SAAUmE,EAAuB9E,EAAvB8E,SAAU/D,EAAaf,EAAbe,SACtBuB,EAAQyC,MAAMC,QAAQrE,GAAYA,EAAS,GAAKA,EACtD,OAAOG,YAAWwB,EAAO,CACvBtB,IAAKD,EAAW,SAAAE,IAdpB,SAAuBD,EAAK8D,GAC1B,IAAI7D,EAAOS,YAAYV,GACpBC,IACDvI,WAAW,WACTuI,EAAK8B,SACJ,IACHtB,YAAeR,EAAM6D,IASnBG,CAAchE,EAAM6D,GAAY,CAC9BnD,SAAU,OACVC,MAAO,UACPC,OAAQ,WAER,0dCPR,IAAMqD,EAAY1E,SAAS2E,eAAe,cAErBC,0CACnB,SAAAA,EAAYpF,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAgO,IACjBnO,EAAAI,EAAAC,KAAAF,KAAM4I,IAQRqF,cAAgB,SAACC,GAMf,OAHAA,EAAInB,kBACW,UAAZmB,EAAIjE,KAAiBiE,EAAI1C,iBAErB0C,EAAIjE,KACT,IAAK,YACHpK,EAAK+I,MAAMuF,SAAWtO,EAAK+I,MAAMuF,UACjC,MACF,IAAK,YACHtO,EAAKsK,SAAS,CACZiE,UAAWvO,EAAKiJ,MAAMsF,SAAW,GAAKvO,EAAK+I,MAAMW,SAASxI,QAAU,IAEtE,MACF,IAAK,UACHlB,EAAKsK,SAAS,CACZiE,UAAWvO,EAAKiJ,MAAMsF,SAAWvO,EAAK+I,MAAMW,SAASxI,OAAS,GAC5DlB,EAAK+I,MAAMW,SAASxI,QAAU,MAzBtClB,EAAKwO,GAAKjF,SAASkF,cAAc,OACjCzO,EAAKwO,GAAGE,UAAY,aACpB1O,EAAKwO,GAAGG,SAAW,EACnB3O,EAAKiJ,MAAQ,CACXsF,SAAU,GANKvO,uDAkCnB,WACEiO,EAAUW,YAAYzO,KAAKqO,IAC3BrO,KAAKqO,GAAGhF,iBAAiB,UAAWrJ,KAAKiO,mDAE3C,WACEjO,KAAKqO,GAAG/E,oBAAoB,UAAWtJ,KAAKiO,eAC5CH,EAAUY,YAAY1O,KAAKqO,0BAE7B,WAAS,IAAA3K,EAAA1D,KAAA2O,EAKH3O,KAAK4I,MAHPgG,EAFKD,EAELC,OACArF,EAHKoF,EAGLpF,SACA4E,EAJKQ,EAILR,QAEF,OAAOU,YAAa/O,OAAAgK,EAAA,EAAAhK,CAAA,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAED,qBAFA,CAGZ8O,GAAM9O,OAAAgK,EAAA,EAAAhK,CAAA,QAAmB,uBAAwB8O,EAA3C,GAHM9O,OAAAgK,EAAA,EAAAhK,CAAA,QAIE,yBACZyJ,EAASC,IAAI,SAAC0B,EAAOvK,GAAR,OAAAb,OAAAgK,EAAA,EAAAhK,CAAA,EAAA2N,EAAA,CAAA9D,SACKjG,EAAKoF,MAAMsF,WAAazN,EAD7B4I,SACiC2B,MANpC,OAAApL,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgP,EAAA,CAAA3B,SAWJ,SAXIP,aAYC,WAAQuB,GAAWA,KAZpBd,WAaF,SAbEP,eAcG,WACd1D,SAAS2F,cAAcC,cAAc,IAAIC,WAAW,WAfzCjC,iBAiBKhN,KAAKqO,MAjBV,GAoBjBrO,KAAKqO,WArE8B3D,4dCfpBwE,0CACnB,SAAAA,EAAYtG,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAkP,IACjBrP,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXqG,WAAW,GAHItP,iDAMnB,WACKG,KAAKoP,WAAWpP,KAAKoP,UAAUzD,yCAEpC,SAAkBwD,GAChBnP,KAAKmK,SAAS,CAAEgF,oCAElB,WAAS,IAAAzL,EAAA1D,KACDqP,EAAS,wBAAA3P,OACWM,KAAK8I,MAAMqG,UAAY,UAAY,aACvDvE,EAAG,UAAAlL,OACGM,KAAK8I,MAAMqG,UAAY,mBAAqB,IACxD,OAAOrP,OAAAgK,EAAA,EAAAhK,CAAA,QACW8K,EADlB,CAAA9K,OAAAgK,EAAA,EAAAhK,CAAA,QAEmB,oBAFnBA,OAAAgK,EAAA,EAAAhK,CAAA,QAGqB,kBAAmBE,KAAK4I,MAAMW,SAHnD,MAAAzJ,OAAAgK,EAAA,EAAAhK,CAAA,QAKmB,iBALnBA,OAAAgK,EAAA,EAAAhK,CAAA,WAOmBuP,EAPnB,QAAAb,UAQmB,EARnBrH,KASa,QATbmI,QAUiBtP,KAAK4I,MAAM2G,UAV5B/C,QAYiB,kBAAM9I,EAAK8L,mBAAkB,IAZ9CC,OAagB,kBAAM/L,EAAK8L,mBAAkB,IAb7CjD,QAciB,kBAAM7I,EAAKkF,MAAM8G,UAAYhM,EAAKkF,MAAM8G,aAdzD,KAWa,SAAA7F,GAAI,OAAInG,EAAK0L,UAAYvF,IAXtC,OAAA2E,UACkC,EADlChC,QAC8C,kBAAM9I,EAAK+I,wBAnBZ/B,KCH7CiF,EAAO,KA0BI,SAASC,EAAMC,IAvBzBF,IACIA,EAAO,IAAIvP,QAAQ,SAACC,EAASC,GAC9BY,UAAU2D,SAAY3D,UAAU2D,QAAQiL,UAC1C3N,QAAQC,IAAI,8CACZ9B,EAAO,IAAI2C,MAAM,gBAEnB,IAAIjB,EAAMd,UAAU2D,QAAQiL,UAC5B9N,EAAIX,UAAY,WACdW,EAAIgD,OAAOjC,QAAQ,cAAcH,KAAK,SAAS+M,GAC7CtP,EAAQsP,KACPlL,MAAM,SAASjD,GAChBW,QAAQC,IAAI,4CACVZ,GACFlB,OAGJ0B,EAAIT,QAAU,WACZY,QAAQC,IAAI,0CACZ9B,SAMQsC,KAAK,SAAA+M,GACfA,EAAKI,QAAQ,SAAApP,GACXA,EAAEqP,YAAY,CAAC7M,QAAS0M,QAEzBpL,MAAM,SAAAjD,GACPW,QAAQ8N,KAAKzO,GACbf,MAAMoP,4dC9BWK,0CACnB,SAAAA,EAAYtH,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAkQ,IACjBrQ,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXqH,SAAS,GAHMtQ,4CAMnB,WAAS,IAAA6D,EAAA1D,KACD4K,EAAM5K,KAAK8I,MAAMqH,QACnB,uDACA,iBACJ,OAAOrQ,OAAAgK,EAAA,EAAAhK,CAAA,QAIQ8K,EAJf,CAAA9K,OAAAgK,EAAA,EAAAhK,CAAA,UAOqB,6BAA8BE,KAAK4I,MAAMiC,MAP9D,GAAA/K,OAAAgK,EAAA,EAAAhK,CAAA,WAWgB,6BAXhB,QAAAqH,KAUYnH,KAAK4I,MAAMzB,KAVvBsI,OAYczP,KAAKoQ,WAAWjH,KAAKnJ,MAZnCqQ,SAagBrQ,KAAKsQ,aAAanH,KAAKnJ,MAbvCsG,MAcatG,KAAK4I,MAAMtC,MAdxBiK,YAemBvQ,KAAK4I,MAAM2H,aAf9B,KASW,SAAAC,GAAG,OAAI9M,EAAK8M,IAAMA,KAT7B,GAAA3M,GAEQ7D,KAAK4I,MAAM/E,GAFnB2K,SAGc,EAHdhC,QAKaxM,KAAKyM,YAAYtD,KAAKnJ,oCAerC,WACEA,KAAK4I,MAAMtC,MAAQtG,KAAKwQ,IAAIlK,MACzBtG,KAAK4I,MAAMyH,UAAUrQ,KAAK4I,MAAMyH,sCAErC,WACKrQ,KAAK4I,MAAM4D,SAASxM,KAAK4I,MAAM4D,UAClCxM,KAAKmK,SAAS,CAACgG,SAAS,IACxBnQ,KAAKwQ,IAAI7E,kCAEX,WACK3L,KAAK4I,MAAM6G,QAAQzP,KAAK4I,MAAM6G,SACjCzP,KAAKmK,SAAS,CAACgG,SAAS,WA1CWzF,qeCFlB+F,0CACnB,SAAAA,EAAY7H,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAyQ,IACjB5Q,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACX4H,iBAAkB,MAHH7Q,4DAMnB,WAAyB,IAAA6D,EAAA1D,KACvB,IAAIA,KAAK8I,MAAM4H,iBAYb,OAXA1Q,KAAK4I,MAAM/C,IAAI8K,sBAAsB/N,KAAK,SAAA2E,GACxC7D,EAAKyG,SAAS,CACZuG,iBAAkBnJ,MAEnB9C,MAAM,SAAAjD,GACPkC,EAAKyG,SAAS,CACZuG,iBAAkB,CAChBrO,MAAOb,OAIN,KAGT,IAAIoP,EAAO5Q,KAAK8I,MAAM4H,iBACtB,OAAO5Q,OAAO+Q,KAAKD,GAAMpH,IAAI,SAAAS,GAC3B,OAAOA,GACL,IAAK,YACH,OAAOnK,OAAAgK,EAAA,EAAAhK,CAAA,cAAAA,OAAAgK,EAAA,EAAAhK,CAAA,6BAAwB8Q,EAAK3G,GAAK/G,MAAzC,GACF,IAAK,UACH,OAAOpD,OAAAgK,EAAA,EAAAhK,CAAA,cAAAA,OAAAgK,EAAA,EAAAhK,CAAA,0BAAqB8Q,EAAK3G,IAAjC,GACF,IAAK,iBACH,OAAOnK,OAAAgK,EAAA,EAAAhK,CAAA,cAAAA,OAAAgK,EAAA,EAAAhK,CAAA,4BAAuB8Q,EAAK3G,IAAnC,GACF,IAAK,QACH,OAAOnK,OAAAgK,EAAA,EAAAhK,CAAA,cAAAA,OAAAgK,EAAA,EAAAhK,CAAA,4CAAAJ,OAAuCkR,EAAK3G,KAAnD,GACF,QACE,OAAO,8BAKf,WACE,OAAOnK,OAAAgK,EAAA,EAAAhK,CAAA,QACU,YADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAEmB,QACZE,KAAK4I,MAAM/C,IAAIiL,YAHtB,GAAAhR,OAAAgK,EAAA,EAAAhK,CAAA,QAKmB,oBACZE,KAAK+Q,yBANZ,cAzCmCrG,idCKvC,IAAMoD,EAAY1E,SAAS2E,eAAe,cAErBiD,0CACnB,SAAAA,EAAYpI,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAgR,IACjBnR,EAAAI,EAAAC,KAAAF,KAAM4I,IACDyF,GAAKjF,SAASkF,cAAc,OACjCzO,EAAKwO,GAAGE,UAAY,mBACpB1O,EAAKwO,GAAGG,SAAW,EACnB3O,EAAKiJ,MAAQ,CACXxG,OAAQ,GACR2O,aAAc,UACdC,QAAQ,GAROrR,0CAWnB,WACEG,KAAKmR,aAAaxP,gCAEpB,WAAY,IAAA+B,EAAA1D,KACVmC,QAAQC,IAAIpC,KAAKmR,cACc,kBAA5BnR,KAAK8I,MAAMmI,cAAqCjR,KAAKmR,cAEpDC,OAAOC,QAAQ,aAAerR,KAAK4I,MAAM/C,IAAI3C,KAAO,MAExDlD,KAAKmR,aAAa1L,YAAY7C,KAAK,WACjCc,EAAKyG,SAAS,CACZ7H,OAAQ,cACR2O,aAAc,2CAIpB,WAAU,IAAAK,EAAAtR,KACRA,KAAKmK,SAAS,CACZ7H,OAAQ,aACR4O,QAAQ,IAEVK,YAAWvR,KAAK4I,MAAM/C,IAAK,SAAC2L,EAAOC,GACjCH,EAAKnH,SAAS,CACZ7H,OAAQ,kBAAoBmP,EAApB,GAAA/R,OAAkC8R,EAAlC,MAAA9R,OAA4C+R,EAA5C,MAA2DD,MAEpE5O,KAAK,WACN0O,EAAKnH,SAAS,CACZ7H,OAAQ,aACR4O,QAAQ,MAETzM,MAAM,SAAApB,GACP5C,MAAM,yBAA2B4C,GACjCiO,EAAKnH,SAAS,CACZ7H,OAAQ,SACR4O,QAAQ,mCAKd,SAAc1P,GAGZA,EAAEuL,kBACFvL,EAAEgK,iBAEF,IAAI3B,EAAO,KACX,OAAOrI,EAAEyI,KACP,IAAK,aACCjK,KAAK8I,MAAMoI,QAAUlR,KAAK4I,MAAMuF,SAClCnO,KAAK4I,MAAMuF,UAEb,MACF,IAAK,YACAnO,KAAK0R,SAAQ7H,EAAOS,YAAYtK,KAAK0R,SACrC7H,GAAMA,EAAK8H,SAAS,CACrBC,IAAK,GACLC,KAAM,IAER,MACF,IAAK,UACA7R,KAAK0R,SAAQ7H,EAAOS,YAAYtK,KAAK0R,SACrC7H,GAAMA,EAAK8H,SAAS,CACrBC,KAAM,GACNC,KAAM,sCAQd,WACE/D,EAAUW,YAAYzO,KAAKqO,IAC3BrO,KAAKiJ,oBAAsBjJ,KAAKkJ,cAAcC,KAAKnJ,MACnDA,KAAKqO,GAAGhF,iBAAiB,UAAWrJ,KAAKiJ,qBACzCjJ,KAAKqO,GAAG1C,QACRxG,IAAoB2M,UAAU9R,KAAK+R,mBAAmB5I,KAAKnJ,2CAE7D,WACE8N,EAAUY,YAAY1O,KAAKqO,IAC3BrO,KAAKqO,GAAG/E,oBAAoB,UAAWtJ,KAAKiJ,qBAC5C9D,IAAoB6M,YAAYhS,KAAK+R,mBAAmB5I,KAAKnJ,yCAG/D,WAAqB,IAAAiS,EAAAjS,KACnBkS,YAAelS,KAAK4I,MAAM/C,KAAKjD,KAAK,SAAAiD,GAClC,GAAGA,EAED,OADAoM,EAAKd,aAAetL,EACboM,EAAKrJ,MAAM/C,IAAIsM,eAAetM,EAAIH,SAAS9C,KAAK,SAAAwP,GACrDH,EAAK9H,SAAS,CACZ8G,aAAcmB,EAAY,YAAc,gBAK5CH,EAAK9H,SAAS,CACZ8G,aAAc,oBAGjBxM,MAAM,SAAAjD,GACPW,QAAQE,MAAM,uBAAwBb,GACtCyQ,EAAK9H,SAAS,CACZ7H,OAAQ,uBACR2O,aAAc,mBAGlBjR,KAAKmK,SAAS,CACZ8G,aAAc,mCAGlB,WAAS,IAAAoB,EAAArS,KAIP,MAH+B,YAA5BA,KAAK8I,MAAMmI,cACZjR,KAAK+R,qBAEAlD,YAAa/O,OAAAgK,EAAA,EAAAhK,CAAA,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAED,UAFA,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAID,gBAJC,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,YAONE,KAAK4I,MAAM/C,IAAI3C,KAPT,GAAApD,OAAAgK,EAAA,EAAAhK,CAAA,QAQI,gBAAiBE,KAAK8I,MAAMxG,OARhC,OAAAgQ,MAAA,yBAAA5S,OAKqBM,KAAK4I,MAAM/C,IAAI0M,SAAS,IAL7C,OAAAzS,OAAAgK,EAAA,EAAAhK,CAAA,EAAA0S,EAAA,CAAA3M,IAUG7F,KAAK4I,MAAM/C,OAVd,YAEe,SAAA4M,GAAC,OAAIJ,EAAKX,OAASe,IAFlC3S,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgP,EAAA,CAAA3B,SAaJ,GAbIE,WAeXrN,KAAK8I,MAAMoI,OAAS,GACQ,cAA5BlR,KAAK8I,MAAMmI,aAA+B,OACd,cAA5BjR,KAAK8I,MAAMmI,aAA+B,SAAW,UAjB1C1D,UAoBXvN,KAAK8I,MAAMoI,OAAS,GACQ,kBAA5BlR,KAAK8I,MAAMmI,aAAmC,GAClB,aAA5BjR,KAAK8I,MAAMmI,aAA8B,cACzC,YAvBWnE,eA0BX9M,KAAK8I,MAAMoI,OAAS,KACQ,cAA5BlR,KAAK8I,MAAMmI,aAA+BjR,KAAK2B,KAAKwH,KAAKnJ,MACzDA,KAAK0S,QAAQvJ,KAAKnJ,MA5BP6M,cA8BE7M,KAAK8I,MAAMoI,OAAS,KAAOlR,KAAKyF,UAAU0D,KAAKnJ,MA9BjDgN,iBA+BKhN,KAAKqO,MA/BV,GAkCjBrO,KAAKqO,WAhK0B3D,qdCNhBiI,0CACnB,SAAAA,EAAY/J,GAAM,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAA2S,IAChB9S,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXqH,SAAS,EACTxO,MAAM,GAJQ9B,4CAOlB,WAAS,IAAA6D,EAAA1D,KACP,OAAOF,OAAAgK,EAAA,EAAAhK,CAAA,QAEO,aAFd,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,WAOgB,oBAKVE,KAAK4I,MAAM/C,IAAI3C,KAZrB,GAAAoP,MAAA,yBAAA5S,OAQsCM,KAAK4I,MAAM/C,IAAI0M,SAAS,IAR9D,KAAA9C,OASc,kBAAM/L,EAAK0M,cATzB7D,QAUe,kBAAM7I,EAAK+H,gBAV1B,KAWW,SAAAmH,GAAG,OAAIlP,EAAKkP,IAAMA,IAExB5S,KAAK8I,MAAMnH,KAAX7B,OAAAgK,EAAA,EAAAhK,CAAA,EAAA+S,EAAA,CAAAhN,IAEQ7F,KAAK4I,MAAM/C,IAFnBsI,QAGY,kBAAMzK,EAAK+I,iBAEpB,MAlBR,GAAA+B,SAGc,EAHdhC,QAIa,kBAAM9I,EAAK+I,4CAkB1B,WACEzM,KAAKmK,SAAS,CAACgG,SAAS,EAAMxO,MAAM,+BAEtC,WACE3B,KAAKmK,SAAS,CAACgG,SAAS,EAAMxO,MAAM,IACpC3B,KAAK4S,IAAIjH,kCAEX,WACE3L,KAAKmK,SAAS,CAACgG,SAAS,WAvCWzF,qdCClBoI,0CACnB,SAAAA,EAAYlK,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAA8S,IACjBjT,EAAAI,EAAAC,KAAAF,KAAM4I,IAURqF,cAAgB,SAACzM,GACf,IAAIwI,EAAMnK,EAAKiJ,MAAMsF,SACR,YAAV5M,EAAEyI,KACHzI,EAAEgK,mBACFxB,GACU,EACRnK,EAAKsK,SAAS,CACZiE,SAAUpE,KAGG,IAATA,GAAcnK,EAAK+I,MAAMmK,gBAC/BlT,EAAKsK,SAAS,CACZiE,SAAUpE,IAEZnK,EAAK+I,MAAMoK,iBAGG,cAAVxR,EAAEyI,MACRzI,EAAEgK,iBACFxB,IACInK,EAAKiJ,MAAM3I,UACV6J,EAAMnK,EAAKoT,KAAKlS,QACjBlB,EAAKsK,SAAS,CACZiE,SAAUpE,IAGXA,GAAQnK,EAAKoT,KAAKlS,OAAS,IAAOlB,EAAKiJ,MAAMoK,aAC9CrT,EAAKsK,SAAS,CACZhK,SAAS,EACTiO,SAAUpE,EACVkJ,YAAY,IAEdrT,EAAKsT,mBAzCXtT,EAAKoT,KAAO,GACZpT,EAAKiJ,MAAQ,CACX3I,SAAS,EACTiT,YAAa,EACbF,YAAY,EACZ9E,SAAU,GAEZvO,EAAKwT,aAAezK,EAAM0K,QATTzT,uDAgDnB,WACEuJ,SAASC,iBAAiB,UAAWrJ,KAAKiO,mDAE5C,WACE7E,SAASE,oBAAoB,UAAWtJ,KAAKiO,2CAE/C,SAAasF,GAAO,IAAA7P,EAAA1D,KACZwT,EAAWxT,KAAK8I,MAAMsK,YAAc,EAC1C,OAAOpT,KAAK4I,MAAM6K,MAAMC,QAAQ1T,KAAK4I,MAAM0K,QAAsB,IAAZE,EAAS,GAAO,IACpE5Q,KAAK,SAAA+Q,GAAwB,IAAtBV,EAAsBU,EAAtBV,KAAMC,EAAgBS,EAAhBT,WACZ/Q,QAAQC,IAAI,0BAA2B8Q,GACvCxP,EAAKuP,KAAOvP,EAAKuP,KAAKvT,OAAOuT,GAC7BvP,EAAKyG,SAAS,CACZhK,SAAS,EACTiT,YAAaI,EACbN,iBAEDzO,MAAM,SAAAjD,GACPW,QAAQE,MAAM,2BAA4Bb,GAC1CF,WAAW,WACToC,EAAKyP,gBACJ,iCAGP,WAAa,IAAA7B,EAAAtR,KACX,OAAGA,KAAK4I,MAAM0K,UAAYtT,KAAKqT,cAC7BrT,KAAKqT,aAAerT,KAAK4I,MAAM0K,QAC/BtT,KAAKiT,KAAO,GACZjT,KAAKG,SAAU,OACfH,KAAKmK,SAAS,CACZhK,SAAS,EACTiT,YAAa,EACbF,YAAY,EACZ9E,SAAU,KAIgB,IAA3BpO,KAAK8I,MAAMsK,aACRpT,KAAKG,UACPH,KAAKG,SAAU,EACfH,KAAKmT,gBAEA,cAEe,IAArBnT,KAAKiT,KAAKlS,OACJjB,OAAAgK,EAAA,EAAAhK,CAAA,QACU,qBADjB,kBAIKE,KAAKiT,KAAKzJ,IAAI,SAAC3D,EAAKlF,GACzB,OAAOb,OAAAgK,EAAA,EAAAhK,CAAA,EAAA2N,EAAA,CAAA9D,SAEO2H,EAAK1I,MAAMgL,UAAYtC,EAAKxI,MAAMsF,WAAazN,EAF7D+M,SAGc,CACRnD,SAAU,SACVC,MAAO,SACPC,OAAQ,QACRoJ,SAAU,KAPhBtK,SAAAzJ,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgU,EAAA,CAAAjO,IAUoBA,8BAKxB,WACE,OAAO/F,OAAAgK,EAAA,EAAAhK,CAAA,QACU,UAAWE,KAAK+T,aADjC,UAnHiCrJ,qdCEhBsJ,0CACnB,SAAAA,EAAYpL,GAAM,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAgU,IAChBnU,EAAAI,EAAAC,KAAAF,KAAM4I,IAQRqF,cAAgB,SAACzM,GACF,cAAVA,EAAEyI,KAAuBpK,EAAK+I,MAAMuF,UACrC3M,EAAEgK,iBACF3L,EAAK+I,MAAMuF,YAZGtO,EAelBoU,YAAc,SAACzS,GACA,UAAVA,EAAEyI,KAAmBpK,EAAKiJ,MAAMoL,cACjCrU,EAAKsU,kBAfPtU,EAAKiJ,MAAQ,CACXsL,SAAU,GACVF,cAAc,GAEhBrU,EAAKwU,QAAU,KACfxU,EAAKyU,OAAS,GAPEzU,oDAoBlB,WACE,IAAIgK,EAAOS,YAAYtK,KAAKwQ,KACzB3G,IACDA,EAAK8B,QACL3L,KAAKmK,SAAS,CACZ+J,cAAc,sCAIpB,WACElU,KAAKuU,iBACLnL,SAASC,iBAAiB,UAAWrJ,KAAKiO,eAC1C7E,SAASC,iBAAiB,QAASrJ,KAAKiU,iDAE1C,WACE7K,SAASE,oBAAoB,UAAWtJ,KAAKiO,eAC7C7E,SAASE,oBAAoB,QAAStJ,KAAKiU,mCAE7C,WAAS,IAAAvQ,EAAA1D,KAcP,OAbIA,KAAKqU,UACPrU,KAAKqU,QAAUrU,KAAK8I,MAAMsL,SAASrT,OAAS,EAA7BjB,OAAAgK,EAAA,EAAAhK,CAAA,EAAA0U,EAAA,CAAAf,MAEJzT,KAAK4I,MAAM6K,MAFPH,QAGF,CAACc,SAAUpU,KAAK8I,MAAMsL,UAHpBR,UAID,EAJCb,eAKI,EALJC,aAMG,kBAAMtP,EAAK6Q,oBANdzU,OAAAgK,EAAA,EAAAhK,CAAA,QAQE,0BARF,kCAYVA,OAAAgK,EAAA,EAAAhK,CAAA,QACU,SADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,EAAA2U,EAAA,CAAApE,SAGgB,kBAAM3M,EAAK4Q,OAAS5Q,EAAK8M,IAAI5H,MAAMtC,OAHnDkG,QAIe,kBAAM9I,EAAKyG,SAAS,CAAC+J,cAAc,KAJlDzE,OAKc,kBAAM/L,EAAKyG,SAAS,CAAC+J,cAAc,MALjD,KAMW,SAAA1D,GAAG,OAAI9M,EAAK8M,IAAMA,IAExBxQ,KAAKqU,QARVvU,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgP,EAAA,CAAA3B,SAUe,GAVfE,WAWkBrN,KAAK8I,MAAMoL,aAAe,SAAW,SAXvD3G,UAYgB,MAZhB,iCAiBF,WAEEvN,KAAKqU,QAAU,KACfrU,KAAKmK,SAAS,CACZiK,SAAUpU,KAAKsU,OAAOI,QAHZ,YAGyB,KAAKC,MAAM,KAAKC,OAAO,SAAAlN,GAAC,OAAIA,aA1EjCgD,6BCP9BmK,iDACAC,8hDCEN,IAAMC,GAAmB,CACvB,4CACA,4CAEIC,GAAmB,CACvB,sCAGF,SAASC,GAAQC,EAAMjR,EAAKkR,EAAOvO,EAAM6K,GACvC,OAAO,IAAIrR,QAAQ,SAACC,EAASC,GAC3B,IAAImB,EAAM,IAAIC,eAAe,CAAC0T,WAAW,IACzC3T,EAAIE,KAAKuT,EAAMjR,GAAK,GACpBxC,EAAIG,aAAeuT,EACnB1T,EAAI4T,UAAY,WACd/U,EAAO,IAAI2C,MAAM,qBAEnBxB,EAAII,OAAS,WACO,MAAfJ,EAAIa,OACLjC,EAAQoB,EAAIS,UAENT,EAAIa,OAAS,KAAOb,EAAIa,OAAS,IACvCjC,EAAQ,MAGRC,EAAO,IAAI2C,MAAJ,YAAAvD,OAAsB+B,EAAIa,OAA1B,cAGXb,EAAI6T,WAAa,SAAS9T,GACrBiQ,GAAUA,EAASjQ,EAAE+T,OAAQ/T,EAAEgU,QAEpC/T,EAAIF,QAAU,SAASC,GACrBlB,EAAO,IAAI2C,MAAM,qBAEnBxB,EAAIkB,KAAKiE,cAIE6O,qFAAf,SAAAC,EAA6BC,EAAgBC,GAA7C,IAAA3P,EAAAD,EAAA6P,EAAA3T,EAAA,OAAA4T,EAAApO,EAAAC,KAAA,SAAAoO,GAAA,cAAAA,EAAAlO,KAAAkO,EAAAjO,MAAA,OAAA7B,EAAAC,EACiByP,GADjBI,EAAAlO,KAAA,EAAA5B,EAAAE,IAAA,WAAAH,EAAAC,EAAAG,KAAAC,KAAA,CAAA0P,EAAAjO,KAAA,gBACU+N,EADV7P,EAAAM,MAAAyP,EAAAlO,KAAA,EAAAkO,EAAAjO,KAAA,EAG2BmN,GAAQ,MAAOY,EAAM,2BACxCD,GAJR,UAKsB,QAFZ1T,EAHV6T,EAAA/N,MAAA,CAAA+N,EAAAjO,KAAA,eAKkC,IAAI7E,MAAMf,GAL5C,QAAA6T,EAAAjO,KAAA,iBAAAiO,EAAAlO,KAAA,GAAAkO,EAAA9N,GAAA8N,EAAA,SAQM5T,QAAQE,MAAR,UAAA3C,OAAwBmW,EAAxB,gBAAAE,EAAA9N,IARN,QAAA8N,EAAAjO,KAAA,gBAAAiO,EAAAjO,KAAA,iBAAAiO,EAAAlO,KAAA,GAAAkO,EAAA5N,GAAA4N,EAAA,SAAA9P,EAAAzE,EAAAuU,EAAA5N,IAAA,eAAA4N,EAAAlO,KAAA,GAAA5B,EAAAM,IAAAwP,EAAAC,OAAA,6BAAAD,EAAAvN,SAAAkN,EAAA,+DAaeO,qFAAf,SAAAC,EAA2BP,EAAgB/O,GAA3C,IAAAuP,EAAAC,EAAA1P,EAAAD,EAAAoP,EAAA3T,EAAAmU,EAAAC,EAAA,OAAAR,EAAApO,EAAAC,KAAA,SAAA4O,GAAA,cAAAA,EAAA1O,KAAA0O,EAAAzO,MAAA,OACQqO,EAAM,UACNC,EAAW,WAAaT,EAAe,GAAGjB,QAAQyB,EAAK,KAF/DzP,EAAAR,EAGiByP,GAHjBY,EAAA1O,KAAA,EAAAnB,EAAAP,IAAA,WAAAM,EAAAC,EAAAN,KAAAC,KAAA,CAAAkQ,EAAAzO,KAAA,gBAGU+N,EAHVpP,EAAAH,MAAAiQ,EAAA1O,KAAA,EAAA0O,EAAAzO,KAAA,GAK2BmN,GAAQ,MAAOY,EAAM,qBALhD,eAKU3T,EALVqU,EAAAvO,KAMUqO,EAAMrP,KAAKoB,MAAMlG,GACrBsU,aAAaC,QAAQL,EAAUlU,GAC/B0E,EAAK8P,cAAgBL,EAR3BE,EAAAhO,OAAA,SASa3B,GATb,QAAA2P,EAAA1O,KAAA,GAAA0O,EAAAtO,GAAAsO,EAAA,SAYMpU,QAAQE,MAAR,UAAA3C,OAAwBmW,EAAxB,gBAAAU,EAAAtO,IAZN,QAAAsO,EAAAzO,KAAA,gBAAAyO,EAAAzO,KAAA,iBAAAyO,EAAA1O,KAAA,GAAA0O,EAAApO,GAAAoO,EAAA,SAAA7P,EAAAlF,EAAA+U,EAAApO,IAAA,eAAAoO,EAAA1O,KAAA,GAAAnB,EAAAH,IAAAgQ,EAAAP,OAAA,iBAeQM,EAAQE,aAAaG,QAAQP,IAfrC,CAAAG,EAAAzO,KAAA,gBAiBIlB,EAAK8P,cAAgB1P,KAAKoB,MAAMkO,GAjBpCC,EAAAhO,OAAA,SAkBW3B,GAlBX,cAoBQ,IAAI3D,MAAM,2BApBlB,yBAAAsT,EAAA/N,SAAA0N,EAAA,mGAuBA,SAAAU,EAAwBC,EAASlB,GAAjC,IAAAmB,EAAAC,EAAAlB,EAAA3T,EAAAmU,EAAA,OAAAP,EAAApO,EAAAC,KAAA,SAAAqP,GAAA,cAAAA,EAAAnP,KAAAmP,EAAAlP,MAAA,OAAAgP,EAAA5Q,EACiB2Q,GADjBG,EAAAnP,KAAA,EAAAiP,EAAA3Q,IAAA,WAAA4Q,EAAAD,EAAA1Q,KAAAC,KAAA,CAAA2Q,EAAAlP,KAAA,gBACU+N,EADVkB,EAAAzQ,MAAA0Q,EAAAnP,KAAA,EAAAmP,EAAAlP,KAAA,EAG2BmN,GAAQ,MAAOY,EAAM,aAAc,SAAU,MAHxE,cAGU3T,EAHV8U,EAAAhP,KAIUqO,EAAMrP,KAAKoB,MAAMlG,GACrBsU,aAAaC,QAAQ,YAAavU,GALxC8U,EAAAlP,KAAA,GAMmBmO,GAAYN,EAAgBU,GAN/C,eAAAW,EAAAzO,OAAA,SAAAyO,EAAAhP,MAAA,QAAAgP,EAAAnP,KAAA,GAAAmP,EAAA/O,GAAA+O,EAAA,SASM7U,QAAQE,MAAR,UAAA3C,OAAwBmW,EAAxB,gBAAAmB,EAAA/O,IATN,QAAA+O,EAAAlP,KAAA,gBAAAkP,EAAAlP,KAAA,iBAAAkP,EAAAnP,KAAA,GAAAmP,EAAA7O,GAAA6O,EAAA,SAAAF,EAAAtV,EAAAwV,EAAA7O,IAAA,eAAA6O,EAAAnP,KAAA,GAAAiP,EAAAvQ,IAAAyQ,EAAAhB,OAAA,gBAYKQ,aAAaG,QAAQ,aAZ1B,CAAAK,EAAAlP,KAAA,gBAAAkP,EAAAzO,OAAA,SAaWvB,KAAKoB,MAAMoO,aAAaG,QAAQ,eAb3C,cAeQ,IAAI1T,MAAM,uBAflB,yBAAA+T,EAAAxO,SAAAoO,EAAA,0DAkBMK,2CACJ,SAAAA,EAAYC,EAAStQ,EAAM8P,EAAeS,GAAY,IAAAtX,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAiX,IACpDpX,EAAAI,EAAAC,KAAAF,OACKoX,MAAQxQ,EACb/G,EAAKwX,aAAeF,EACpBtX,EAAKyX,eAAiBZ,GAAiB,EACvC7W,EAAKqX,QAAUA,EACfrX,EAAK0X,YAAc1X,EAAK2X,gBAAkB,KANU3X,wCAQtD,WACE,OAAOG,KAAKoX,MAAMlU,8BAEpB,WACE,OAAOlD,KAAKoX,MAAMtG,wCAEpB,WACE,OAAG9Q,KAAKqX,aAAe,EAAUjX,QAAQC,QAAQ,CAC/CqF,QAAS1F,KAAKoX,MAAMK,SAAS/R,WAG3B1F,KAAKwX,kBACPxX,KAAKwX,gBAAkBvC,GACrB,MAAOjV,KAAKoX,MAAMK,SAAS1T,SAAU,SAAU,MAC/CnB,KAAK,SAAA8U,GAAG,OAAItX,QAAQC,QAAQ2G,KAAKoB,MAAMsP,OAEpC1X,KAAKwX,oDAEd,WAAsB,IAAA9T,EAAA1D,KACpB,OAAOA,KAAK2X,eAAe/U,KAAK,SAAAgV,GAAE,OAAIxX,QAAQC,QAAQ,CACpDwX,UAAW,CACT3U,KAAMQ,EAAK0T,MAAMU,OAAOtO,IAAI,SAAA9B,GAAC,OAAIA,EAAEgN,QAAQ,cAAe,MACnDqD,KAAK,OAEdC,OAAQtU,EAAK0T,MAAMa,SACnBC,QAASxU,EAAK0T,MAAMc,QACpBC,aAAczU,EAAK0T,MAAMe,aACzBC,QAAS1U,EAAK0T,MAAMgB,QACpBjR,KAAMzD,EAAK0T,MAAMjQ,KACjBzB,QAASkS,EAAGlS,QACZ2S,eAAgB3U,EAAK4T,2CAGzB,SAASgB,GACP,OAAOtY,KAAKoX,MAAMrL,0CAEpB,WAAwB,IAAAuF,EAAAtR,KACtB,MAAO,CAAC,gBAAD,eAAA2T,EAAA7T,OAAAyY,EAAA,EAAAzY,CAAAgW,EAAApO,EAAA8Q,KAAkB,SAAAnR,EAAOoR,GAAP,OAAA3C,EAAApO,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACnBwJ,EAAKiG,cACPjG,EAAKiG,YACHtC,GAAQ,MAAO3D,EAAK8F,MAAMK,SAASxT,IAAK,OAAQ,KAC9C,SAACsR,EAAQC,GACPiD,EAAe,cAAe7X,KAAKC,MAAM0U,EAAOC,EAAM,SAG9DC,GAAcnE,EAAK4F,QAAS5F,EAAK8F,MAAMxB,MACvCtE,EAAKgG,iBATkB1P,EAAAE,KAAA,EAUFwJ,EAAKiG,YAVH,cAAA3P,EAAAK,GAAAL,EAAAI,KAAAJ,EAAAO,GAUgBmJ,EAAK8F,MAAMxB,KAV3BhO,EAAAS,GAAA,CAAAT,EAAAK,GAAAL,EAAAO,IAAAP,EAAAW,OAAA,UAUfmQ,KAVe9Q,EAAAS,KAAA,wBAAAT,EAAAY,SAAAnB,MAAlB,gBAAAsR,GAAA,OAAAhF,EAAAiF,MAAA5Y,KAAA6Y,YAAA,2CAaT,WAA0B,IAAA5G,EAAAjS,KACxB,OAAGA,KAAKqX,aAAe,EACd,CAAC,gBAADvX,OAAAyY,EAAA,EAAAzY,CAAAgW,EAAApO,EAAA8Q,KAAkB,SAAA/P,IAAA,OAAAqN,EAAApO,EAAAC,KAAA,SAAAe,GAAA,cAAAA,EAAAb,KAAAa,EAAAZ,MAAA,cACnBmK,EAAKsF,cACPtF,EAAKsF,YACHtC,GAAQ,MAAOhD,EAAKmF,MAAMK,SAASxT,IAAK,OAAQ,OAH7ByE,EAAAZ,KAAA,EAKFmK,EAAKsF,YALH,cAAA7O,EAAAT,GAAAS,EAAAV,KAAAU,EAAAP,GAKgB8J,EAAKmF,MAAMxB,KAL3BlN,EAAAL,GAAA,CAAAK,EAAAT,GAAAS,EAAAP,IAAAO,EAAAH,OAAA,UAKfmQ,KALehQ,EAAAL,KAAA,wBAAAK,EAAAF,SAAAC,OAQpB,CAAC,iBAAD3I,OAAAyY,EAAA,EAAAzY,CAAAgW,EAAApO,EAAA8Q,KAAmB,SAAAM,IAAA,OAAAhD,EAAApO,EAAAC,KAAA,SAAAoR,GAAA,cAAAA,EAAAlR,KAAAkR,EAAAjR,MAAA,cAAAiR,EAAA9Q,GACTgK,EAAKmF,MAAMK,SAAS1T,SADXgV,EAAAjR,KAAA,EAEfmK,EAAK0F,eAFU,UAAAoB,EAAA5Q,GAAA4Q,EAAA/Q,KAEMhE,OAFN+U,EAAA5Q,GAAA,CAAA4Q,EAAAjR,KAAA,QAAAiR,EAAA5Q,GAEgB8J,EAAKmF,MAAMxB,KAF3B,cAAAmD,EAAA1Q,GAAA0Q,EAAA5Q,GAAA4Q,EAAAzQ,GAAA,CAAAyQ,EAAA9Q,GAAA8Q,EAAA1Q,IAAA0Q,EAAAxQ,OAAA,UAChBmQ,KADgBK,EAAAzQ,KAAA,wBAAAyQ,EAAAvQ,SAAAsQ,qCAM5B,SAAepT,GACb,OAAO1F,KAAK2X,eAAe/U,KAAK,SAAAgV,GAAE,OAAIxX,QAAQC,WAC3CqF,IAAWkS,EAAGlS,UACdsT,IAAgBpB,EAAGlS,QAASA,GAAW,YA9ElBoP,GAmFPmE,2CACnB,SAAAA,IAIE,IAAA5G,EAHAwE,EAGAgC,UAAA9X,OAAA,QAAAmY,IAAAL,UAAA,GAAAA,UAAA,GAHU9D,GACVmC,EAEA2B,UAAA9X,OAAA,QAAAmY,IAAAL,UAAA,GAAAA,UAAA,GAFU7D,GACV9R,EACA2V,UAAA9X,OAAA,QAAAmY,IAAAL,UAAA,GAAAA,UAAA,GADO,kBACP,OAAA/Y,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAiZ,IACA5G,EAAA8G,EAAAjZ,KAAAF,OACK6W,QAAUA,EACfxE,EAAK6E,QAAUA,EACf7E,EAAKnP,KAAOA,EAJZmP,0CAMF,WAAO,IAAA+G,EAAApZ,KACL,qDAAOqZ,CAASrZ,KAAK6W,QAAS7W,KAAKkX,SAAStU,KAAK,SAAAgE,GAC/CwS,EAAKhC,MAAQxQ,EACbzE,QAAQC,IAAI,yBAA0BwE,GACnCA,EAAKlB,QAAU,EAChBvD,QAAQC,IAAI,+CAENwE,EAAKlB,QAAU,GACrBvD,QAAQ8N,KAAK,2CAEfmJ,EAAKE,WAAa,CAAC,CACjBpW,KAAM,kBAAmBW,GAAI,WAAY0V,SAAS,IACjD7Z,OAAOI,OAAO+Q,KAAKjK,EAAK0S,YAAY9P,IAAI,SAAAgQ,GACzC,MAAO,CAAEtW,KAAM0D,EAAK0S,WAAWE,GAAKtW,KAAMW,GAAI2V,+BAIpD,SAAQ5E,EAAQ5T,EAAOyY,GAAO,IAAAC,EAAA1Z,KACxB2Z,EAAU3Z,KAAKoX,MAAMnE,KACtB2B,EAAOR,WACRjS,QAAQC,IAAI,0BAA2BwS,EAAOR,UAC9CuF,EAAUA,EAAQnQ,IAAI,SAAA3D,GACpB,IAAI+T,EAAQ,EAEZhF,EAAOR,SAASrE,QAAQ,SAAA8J,GACtBA,EAAKA,EAAGC,cAELjU,EAAI3C,KAAK4W,gBAAkBD,EAAID,GAAS,EACnC/T,EAAI3C,KAAK4W,cAAcC,SAASF,KAAKD,GAAS,GAEtD/T,EAAI+K,KAAKoJ,KAAKtF,QAAQ,OAAQ,KAAKC,MAAM,KAAK5E,QAAQ,SAAAkK,GACjDA,EAAIH,gBAAkBD,EAAID,GAAS,EAC9BK,EAAIH,cAAcC,SAASF,KAAKD,GAAS,KAGhD/T,EAAIiL,YAAYgJ,cAAcC,SAASF,KAAKD,GAAS,KAG1D,IAAIM,EAAUpa,OAAOqa,OAAOtU,GAE5B,OADAqU,EAAQE,YAAcR,EACfM,KAGX,IAAIG,EAAcV,EAAQ/E,OAAO,SAAA/O,GAC/B,IAAIyU,GAAQ,EAUZ,OATG1F,EAAO0E,YACuB,aAA5B1E,EAAO0E,WAAW,GAAGzV,KACtByW,GAAS1F,EAAO0E,WAAWiB,KACzB,SAAAC,GAAE,OAAI3U,EAAI+K,KAAK0I,WAAWS,SAASS,EAAG3W,OAGzC+Q,EAAOR,WACRkG,GAAUzU,EAAIuU,YAAc,GAEvBE,IAWT,OATG1F,EAAO0E,YAA0C,aAA5B1E,EAAO0E,WAAW,GAAGzV,IAC3CwW,EAAYI,KAAK,SAAC/S,EAAGgT,GACnB,OAAQhB,EAAKtC,MAAMV,cAAcgE,EAAE9E,OAAS,IACzC8D,EAAKtC,MAAMV,cAAchP,EAAEkO,OAAS,KAGxChB,EAAOR,UACRiG,EAAYI,KAAK,SAAC/S,EAAGgT,GAAJ,OAAUA,EAAEN,YAAc1S,EAAE0S,cAExCha,QAAQC,QAAQ,CACrB4S,KAAMoH,EACHM,MAAM3Z,EAAOA,EAAMyY,GACnBjQ,IAAI,SAAA3D,GAAG,OAAI,IAAIoR,GACdyC,EAAKxC,QACLrR,EACA6T,EAAKtC,MAAMV,cAAc7Q,EAAI+P,MAC7B8D,EAAKtC,MAAM1R,WAEfwN,WAAYlS,EAAMyY,GAASY,EAAYtZ,gBArFA8T,qBC9KxB+F,cACnB,SAAAA,EAAYC,EAAMC,EAAKC,GAAI,IAAAlb,EAAAG,KAIzB,OAJyBF,OAAA+I,EAAA,EAAA/I,CAAAE,KAAA4a,GACzB5a,KAAK6a,KAAOA,EACZ7a,KAAK8a,IAAMA,EACX9a,KAAK+a,IAAMA,EACJF,EAAKG,QACV,IAAK,UACHhb,KAAK2C,KAAK,CACRqY,OAAQ,OACRpU,KAAM,CACJqU,MAAOF,EAAIE,MACXC,UAAWH,EAAII,KACfC,YAAaL,EAAI5T,KACjBkU,MAAON,EAAIM,MACXC,GAAIP,EAAIO,GACRC,WAAYR,EAAIrV,QAChB8V,UAAWT,EAAIU,IAEjBC,KAAM,sBAAwBZ,EAAIjV,IAAIhC,GAAK,UAC3C8X,QAAS,CACPC,cAAiB,OAASf,EAAK5Q,KAEjC9C,KAAM,SACLvE,KAAK,SAAAlC,GACNb,EAAKa,MAAQA,EACbb,EAAKgC,WACJ4C,MAAM,SAAAjD,GACP3B,EAAK0B,QAAQC,KAEf,MACF,QACExB,KAAKuB,QAAQ,IAAI0B,MAAM,kCACrB4X,EAAKG,kDAIb,SAAKhZ,GAAI,IAAA0B,EAAA1D,KACP,OAAO,IAAII,QAAQ,SAACC,EAASC,GAC3B,GAAI0B,EAAI0Z,KAEH,GAAI1Z,EAAIgZ,OAER,CACH,IAMIa,EANApa,EAAM,IAAIC,eAAe,CAAC0T,WAAW,IACrCsG,EAAO1Z,EAAI0Z,KACXI,EAAU,CAAC,OAAQ,OAAO/B,SAAS/X,EAAIgZ,QACxChZ,EAAI+Z,aAAmC,qBAApB/Z,EAAI+Z,YACxB/Z,EAAI4E,KAAOI,KAAKC,UAAUjF,EAAI4E,MAC5B,KAEW,MAAZ8U,EAAK,KACNA,EAAOhY,EAAKoX,IAAIkB,OAAO/X,IAAMyX,GAEf,SAAb1Z,EAAImF,MAAgC,gBAAbnF,EAAImF,OAC5B1F,EAAIG,aAAeI,EAAImF,MAEzB1F,EAAIE,KAAKK,EAAIgZ,OAAQU,GAAM,GACxB,kBAAoB1Z,EAAI2Z,SACzB7b,OAAO+Q,KAAK7O,EAAI2Z,SAAS5L,QAAQ,SAAA7M,GAC/BzB,EAAIwa,iBAAiB/Y,EAAMlB,EAAI2Z,QAAQzY,MAG3CzB,EAAIwa,iBAAiB,kBAAmBvY,EAAKoX,IAAIoB,KACjDza,EAAIwa,iBAAiB,mBACnB,8BACAE,KAAKC,MAAQ,wBACH1Y,EAAKqX,IAAIsB,IAAM,WACf3Y,EAAKqX,IAAIuB,IAAM,qCAI3B7a,EAAIwa,iBAAiB,kBACnB,SAAWvY,EAAKqX,IAAII,KAAO,aAAezX,EAAKqX,IAAIU,GAAK,KAC1Dha,EAAIwa,iBAAiB,aAAcvY,EAAKqX,IAAIwB,IAC5C9a,EAAIwa,iBAAiB,eACnBja,EAAI+Z,aAAe,oBAClBrY,EAAKhD,QACNmb,EAAW,CACTW,YAAa,CACX3Y,GAAIH,EAAKhD,MAAM+b,IACfC,UAAW,SACXzS,IAAK,IAAI0S,UAAOjZ,EAAKhD,MAAMkc,QAAS,YAGrCd,IACDD,EAASC,QAAUA,EACnBD,EAASE,YAAc/Z,EAAI+Z,aAAe,oBAE5Cta,EAAIwa,iBAAiB,gBACnBY,UAAYjO,OAAO8M,EAAM1Z,EAAIgZ,OAAQa,GAAUjN,SAEnDnN,EAAIF,QAAU,WACZjB,EAAO,IAAI2C,MAAM,mBAEnBxB,EAAI6T,WAAa,SAAS9T,GACrBQ,EAAIyW,gBACLzW,EAAIyW,eAAe,cAAe7X,KAAKC,MACrCW,EAAE+T,OAAS/T,EAAEgU,MAAQ,OAG3B/T,EAAII,OAAS,WACX,IAAIgO,EAAM,GACV,GAAkB,MAAfpO,EAAIa,QAAiC,MAAfb,EAAIa,QAAiC,MAAfb,EAAIa,OAAe,CAChE,GAAGb,EAAIqb,aACL,IACE,IAAIza,EAAQ2E,KAAKoB,MAAM3G,EAAIqb,cAC3BjN,EAAM,IAAMxN,EAAM0a,KAAO,KAAO1a,EAAM2a,MACtC,MAAMxb,GACNqO,EAAM,IAAMpO,EAAIqb,aAGpBxc,EAAO,iBAAmBmB,EAAIa,OAAS,KAAOb,EAAIwb,WAAapN,GAEjE,GAAgB,SAAb7N,EAAImF,KACL,IACE9G,EAAQ2G,KAAKoB,MAAM3G,EAAIqb,eAEzB,MAAMtb,GACJlB,EAAOkB,QAITnB,EAAQoB,EAAIS,WAGhBT,EAAIkB,KAAKmZ,QApFTxb,EAAO,IAAI4c,UAAU,gCAFrB5c,EAAO,IAAI4c,UAAU,0eCtC7B,SAASC,KACP,IAAIC,EAAQ,yBAAyBC,KAAKnc,UAAUoc,WACpD,OAAGF,EAAcA,EAAM,GACX,QAGd,IAAM1P,GAAW,CACfqN,IAAK,CACHM,MAAO,UACPF,KAAM,kBACNhU,KAAM,OACN8T,MAAO,kBACPK,GAAI,QACJ5V,QAASyX,KACTZ,GAAI,wEACFY,KACF1B,GAAI,kBACJY,IAAK,IACLC,IAAK,KAEPxB,IAAK,CACHjV,IAAK,CACHhC,GAAI,uBACJX,KAAM,aACNgZ,IAAK,SAEPF,OAAQ,CACN/X,IAAK,6BAEPiY,IAAK,OAEPrB,KAAM,CACJG,OAAQ,UACR/Q,IAAK,yBAIHsT,4CACJ,SAAAA,EAAY3W,EAAM4W,GAAU,IAAA3d,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAud,IAC1B1d,EAAAI,EAAAC,KAAAF,OACKwd,UAAYA,EACjB3d,EAAKuX,MAAQxQ,EAHa/G,wCAK5B,WACE,OAAOG,KAAKoX,MAAMqG,SAAWzd,KAAKoX,MAAMlU,8BAE1C,WACE,OAAOlD,KAAKoX,MAAMtG,oCAEpB,SAAS4M,GACP,GAAG1d,KAAKoX,MAAMuG,cAAe,OAAO3d,KAAKoX,MAAMuG,cAE/C,IAAIC,EAAQ9d,OAAO+Q,KAAK7Q,KAAKoX,MAAMyG,OAC/BC,EAAW,KAAMC,EAAc,KASnC,OARAH,EAAM7N,QAAQ,SAAAuI,GACZ,IAAI0F,EAAON,EAAgBpF,EACxB0F,EAAO,IAAGA,GAAQA,IACF,OAAhBD,GAAwBC,EAAOD,KAChCD,EAAWxF,EACXyF,EAAcC,KAGdF,EAGG9d,KAAKoX,MAAMyG,MAAMC,GAFf,iCAIX,WAQE,OAPI9d,KAAKwX,kBACPxX,KAAKwX,gBAAkBxX,KAAKwd,UAAU7a,KAAK,CACzCqY,OAAQ,MACRU,KAAM1b,KAAKoX,MAAM5Q,aACjBW,KAAM,UAGHnH,KAAKwX,mDAEd,WAAsB,IAAA9T,EAAA1D,KAepB,OAbG,kBAAoBA,KAAKoX,MAAMS,WAChC,kBAAoB7X,KAAKoX,MAAM6G,cAEhB7d,QAAQC,QAAQ,CAC7B6C,KAAMlD,KAAKoX,MAAMS,UACjB5T,IAAKjE,KAAKoX,MAAM6G,gBAIHje,KAAK2X,eAAe/U,KAAK,SAAAgV,GACtC,OAAOxX,QAAQC,QAAQuX,EAAGC,cAGVjV,KAAK,SAAAiV,GACvB,OAAOzX,QAAQC,QAAQ,CACrBwX,YACAnS,QAAShC,EAAK0T,MAAM1R,QACpByB,KAAMzD,EAAK0T,MAAMjQ,8CAIvB,WAAwB,IAAAmK,EAAAtR,KACtB,MAAO,CAAC,iBAAD,eAAA2T,EAAA7T,OAAAyY,EAAA,EAAAzY,CAAAgW,EAAApO,EAAA8Q,KAAmB,SAAAnR,EAAOoR,GAAP,OAAA3C,EAAApO,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UACpBwJ,EAAKiG,YADe,CAAA3P,EAAAE,KAAA,YAAAF,EAAAK,GAEHqJ,EAAKkM,UAFF5V,EAAAO,GAIdmJ,EAAK8F,MAAM8G,aAJGtW,EAAAO,GAAA,CAAAP,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAKXwJ,EAAKqG,eALM,OAAA/P,EAAAO,GAAAP,EAAAI,KAKUkW,aALV,OAAAtW,EAAAS,GAAAT,EAAAO,GAAAP,EAAAU,GAOpBmQ,EAPoB7Q,EAAAuW,GAAA,CAGpBnD,OAAQ,MACRU,KAJoB9T,EAAAS,GAMpBlB,KAAM,OACNsR,eAPoB7Q,EAAAU,IAEtBgJ,EAAKiG,YAFiB3P,EAAAK,GAEYtF,KAFZzC,KAAA0H,EAAAK,GAAAL,EAAAuW,IAAA,eAAAvW,EAAAwW,GAWtB9M,EAAK8F,MAAM5Q,aAXWoB,EAAAE,KAAA,GAYhBwJ,EAAKiG,YAZW,eAAA3P,EAAAyW,GAAAzW,EAAAI,KAAAJ,EAAA0W,GAatBhN,EAAK8F,MAAMvT,GAbW+D,EAAA2W,GAAA,CAAA3W,EAAAwW,GAAAxW,EAAAyW,GAAAzW,EAAA0W,IAAA1W,EAAAW,OAAA,UAUhBmQ,KAVgB9Q,EAAA2W,KAAA,yBAAA3W,EAAAY,SAAAnB,MAAnB,gBAAAmX,GAAA,OAAA7K,EAAAiF,MAAA5Y,KAAA6Y,YAAA,2CAiBT,WAA0B,IAAA5G,EAAAjS,KACxB,MAAO,CAAC,iBAADF,OAAAyY,EAAA,EAAAzY,CAAAgW,EAAApO,EAAA8Q,KAAmB,SAAA/P,IAAA,OAAAqN,EAAApO,EAAAC,KAAA,SAAAe,GAAA,cAAAA,EAAAb,KAAAa,EAAAZ,MAAA,cAAAY,EAAAT,GAEtBgK,EAAKmF,MAAM5Q,aAFWkC,EAAAZ,KAAA,EAGfmK,EAAK0F,eAHU,UAAAjP,EAAAP,GAAAO,EAAAV,KAGMhE,OAHN0E,EAAAP,GAAA,CAAAO,EAAAZ,KAAA,QAAAY,EAAAP,GAGgB8J,EAAKmF,MAAMvT,GAH3B,cAAA6E,EAAAL,GAAAK,EAAAP,GAAAO,EAAAJ,GAAA,CAAAI,EAAAT,GAAAS,EAAAL,IAAAK,EAAAH,OAAA,UAChBmQ,KADgBhQ,EAAAJ,KAAA,wBAAAI,EAAAF,SAAAC,qCAO5B,SAAe/C,GACb,OAAOtF,QAAQC,UACbqF,GAAWsT,IAAgBhZ,KAAKoX,MAAM1R,QAASA,GAAW,UA3FtCoP,GAgGL2J,oJACnB,WAAO,IAAApM,EAAArS,KACL,OAAOA,KAAK0e,cACV1e,KAAK0e,YAAc,IAAIte,QAAQ,SAACC,EAASC,GACvC+R,EAAKmL,UAAY,IAAI5C,GACnBlN,GAASmN,KAAMnN,GAASoN,IAAKpN,GAASqN,KAExC1I,EAAKmL,UAAU3b,OAAS,WACtBwQ,EAAKmL,UAAU7a,KAAK,CAClBqY,OAAQ,MACRU,KAAM,mBACNvU,KAAM,SACLvE,KAAK,SAAA+b,GACNxc,QAAQC,IAAI,wBAAyBuc,GACrCtM,EAAKiH,WAAaqF,EAClBte,MACCoE,MAAMnE,IAEX+R,EAAKmL,UAAUjc,QAAU,SAAAC,GACvBlB,EAAOkB,8BAKf,SAAQoT,EAAQ5T,EAAOyY,GAAO,IAAAL,EAAApZ,KACxB4e,GAAW,EAAOC,GAA2B,EAC7CnD,EAAO,qBA4BX,OA3BG/N,MAAMC,QAAQgH,EAAOR,YACtBwK,GAAW,EACXlD,EAAO,2CAETA,GAAQ,kBACRA,GAAQ,SAAWhO,GAASqN,IAAII,KAC7ByD,GACDlD,GAAQ,aAAehO,GAASqN,IAAIrV,QACpCgW,GAAQ,SAAW9a,KAAKC,MAAMG,EAAMyY,GACpCiC,GAAQ,SAAWjC,IAGnBiC,GAAQ,OAAShO,GAASqN,IAAIrV,QAC9BgW,GAAQ,cAAgBjC,EACxBiC,GAAQ,cAAgB,EAAE9a,KAAKC,MAAMG,EAAMyY,KAE7CiC,GAAQ,QAAUhO,GAASqN,IAAIuB,IAAM,QAAU5O,GAASqN,IAAIsB,IACzDzH,EAAO0E,YAAc1E,EAAO0E,WAAWvY,OAAS,IACjB,IAA7B6T,EAAO0E,WAAWvY,OACnB2a,GAAQ,aAAeoD,mBAAmBlK,EAAO0E,WAAW,GAAGyF,MAE/DF,GAA2B,GAE5BD,IACDlD,GAAQ,UAAY9G,EAAOR,SAAS2D,KAAK,KACzC2D,GAAQ,WAAaoD,mBAAmB5d,UAAU8d,WAE7Chf,KAAKwd,UAAU7a,KAAK,CACzBqY,OAAQ,MACR7T,KAAM,OACNuU,SACC9Y,KAAK,SAAAgE,GACN,IAAIqY,GAAYL,EAAWhY,EAAKsY,QAAUtY,EAAKqM,MAAM2B,OAAO,SAAA/O,GAC1D,IAAIyU,GAAQ,EAKZ,OAJGuE,IACDvE,GAAS1F,EAAO0E,WAAWiB,KACzB,SAAAC,GAAE,OAAI3U,EAAIsZ,cAAcpF,SAASS,EAAGuE,SAEjCzE,IAET,OAAOla,QAAQC,QAAQ,CACrB4S,KAAMgM,EAASzV,IAAI,SAAA3D,GAAG,OAAI,IAAI0X,GAAY1X,EAAKuT,EAAKoE,aACpDtK,WAAY0L,EAAWhY,EAAKwY,OAASxY,EAAKyY,YAAY,EAAIzY,EAAK0Y,gCAIrE,WACE,MAAO,qCA1E2BzK,odC7HjB0K,4CACnB,SAAAA,EAAY3W,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAuf,IACjB1f,EAAAI,EAAAC,KAAAF,KAAM4I,IAED4W,OAAS,CACZ,IAAIvG,GACJ,IAAIA,GAAgB,CAClB,oCACC,CACD,6CACC,wBACH,IAAIwF,IAEN5e,EAAKiJ,MAAQ,CACX2K,MAAO,EACP8B,QAAQ,EACRpV,SAAS,EACTsf,YAAY,EACZpd,MAAO,MAjBQxC,uDAoBnB,SAAkBmK,GAChB4F,EAAM5P,KAAKwf,OAAOxV,GAAK9G,MACpBlD,KAAK8I,MAAM2K,QAAUzJ,GACtBhK,KAAKmK,SAAS,CAACoL,QAAQ,EAAMpV,SAAS,0BAE1C,WAAS,IAAAuD,EAAA1D,KACD0f,EAAQ1f,KAAK8I,MAAM6W,WAAX7f,OAAAgK,EAAA,EAAAhK,CAAA,EAAA8f,EAAA,CAAAhR,OACL,gBADKT,QAEH,kBAAMzK,EAAKyG,SAAS,CAC3BwV,WAAW,KAHDpW,SAKZvJ,KAAKwf,OAAOhW,IAAI,SAACiK,EAAO1K,GAAR,OAAAjJ,OAAAgK,EAAA,EAAAhK,CAAA,EAAA+f,EAAA,CAAAtQ,UAEHxG,IAAUrF,EAAKoF,MAAM2K,MAFlB/D,SAGJ,kBAAMhM,EAAKyG,SAAS,CAC5BsJ,MAAO1K,EACPwM,QAAQ,EACRpV,SAAS,EACTwf,WAAW,EACXtd,MAAO,QARKkH,SAWbkK,EAAMvQ,WAIX,IAAIlD,KAAK8I,MAAMyM,OACb,OAAGvV,KAAK8I,MAAMzG,MACLvC,OAAAgK,EAAA,EAAAhK,CAAA,QACU,QADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,QAEmB,kBAFnB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,iCAIOE,KAAK8I,MAAMzG,OAJlB,GAAAvC,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgP,EAAA,CAAA3B,SAOe,OAPfE,WAQiB,QARjBE,UASgB,SAThBX,aAUoB,kBAAMwE,OAAO7M,SAVjCuI,eAWsB,kBAAMpJ,EAAKyG,SAAS,CAClCoL,QAAQ,EACRpV,SAAS,EACTkC,MAAO,QAdfwK,cAgBqB,kBAAMnJ,EAAKyG,SAAS,CACjCwV,WAAW,OAGdD,GApBL,IAwBE1f,KAAK8I,MAAM3I,UACbH,KAAKmK,SAAS,CAAChK,SAAS,EAAMoV,QAAQ,EAAOlT,MAAO,OACpDrC,KAAKwf,OAAOxf,KAAK8I,MAAM2K,OACpB9P,OACAf,KAAK,kBAAMc,EAAKoc,kBAAkBpc,EAAKoF,MAAM2K,SAC7ChP,MAAM,SAAAjD,GACLoO,EAAM,UACNlM,EAAKyG,SAAS,CACZhK,SAAS,EACToV,QAAQ,EACRlT,MAAOb,EAAEwK,gBAIVlM,OAAAgK,EAAA,EAAAhK,CAAA,QACU,QADjB,kBAOF,GAAGE,KAAK8I,MAAM2W,WACZ,OAAO3f,OAAAgK,EAAA,EAAAhK,CAAA,EAAAigB,EAAA,CAAA5R,QAEM,kBAAMzK,EAAKyG,SAAS,CAAEsV,YAAY,KAF/ChM,MAGWzT,KAAKwf,OAAOxf,KAAK8I,MAAM2K,SAKpC,IAAMuM,EAAOhgB,KAAKwf,OAAOxf,KAAK8I,MAAM2K,OAAO6F,WAAW9P,IAAI,SAAAgQ,GAAG,OAAA1Z,OAAAgK,EAAA,EAAAhK,CAAA,EAAA0U,EAAA,CAAAf,MAElD/P,EAAK8b,OAAO9b,EAAKoF,MAAM2K,OAF2BH,QAGhD,CAACgG,WAAY,CAACE,IAHkC5F,UAI9ClQ,EAAKoF,MAAM6W,cAGpBM,EAASjgB,KAAKwf,OAAOxf,KAAK8I,MAAM2K,OAAO6F,WAAW9P,IACtD,SAAAgQ,GAAG,OAAIA,EAAItW,OACb,OAAOpD,OAAAgK,EAAA,EAAAhK,CAAA,QACU,QADjB,CAAAA,OAAAgK,EAAA,EAAAhK,CAAA,EAAAogB,EAAA,CAAAlV,UAEwBiV,EAFxB1W,SAEiCyW,IAFjClgB,OAAAgK,EAAA,EAAAhK,CAAA,EAAAgP,EAAA,CAAA1B,SAIe,kBAJfC,WAKiB,SALjBE,UAMgB,SANhBX,aAOoB,kBAAMlJ,EAAKyG,SAAS,CAAEsV,YAAY,KAPtD5S,cAQqB,kBAAMnJ,EAAKyG,SAAS,CACjCwV,WAAW,OAGdD,GAZL,UAhH+BhV,sdCSpByV,4CAhBb,SAAAA,EAAYvX,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAmgB,IACjBtgB,EAAAI,EAAAC,KAAAF,KAAM4I,IACDwX,GAAKxX,EAAMyX,QAFCxgB,4CAInB,WACE,OAAOC,OAAAgK,EAAA,EAAAhK,CAAA,QACU,QADjBA,OAAAgK,EAAA,EAAAhK,CAAA,EAAA2U,EAAA,CAAA5J,MAEqB,UAFrB,sCAMF,WACE7K,KAAKogB,YAbW1V,sdC0BL4V,4CAxBb,SAAAA,EAAY1X,GAAO,IAAA/I,EAAA,OAAAC,OAAA+I,EAAA,EAAA/I,CAAAE,KAAAsgB,IACjBzgB,EAAAI,EAAAC,KAAAF,KAAM4I,IACDE,MAAQ,CACXyX,WAAW,GAHI1gB,4CAMnB,WAAS,IAAA6D,EAAA1D,KACP,OAAIA,KAAK8I,MAAMyX,UAQNzgB,OAAAgK,EAAA,EAAAhK,CAAA,QACU,MADjBA,OAAAgK,EAAA,EAAAhK,CAAA,EAAA0gB,IAAA,GAPO1gB,OAAAgK,EAAA,EAAAhK,CAAA,QACU,MADjBA,OAAAgK,EAAA,EAAAhK,CAAA,EAAA2gB,GAAA,CAAAJ,QAEoB,kBAAM3c,EAAKyG,SAAS,CAACoW,WAAW,OAFpD,UATY7V,KCREgW,QACW,cAA7BtP,OAAOuP,SAASC,UAEe,UAA7BxP,OAAOuP,SAASC,UAEhBxP,OAAOuP,SAASC,SAAStG,MACvB,2DCEHpZ,UAAU2f,aAEX3f,UAAU2f,YAAYC,aAAaC,IAAI,CACrCC,uBAAwB,iBAI5BC,YAAOnhB,OAAAgK,EAAA,EAAAhK,CAAA,EAAAohB,IAAS9X,SAAS2E,eAAe,SDkGlC,kBAAmB7M,WACrBA,UAAUigB,cAAcC,MAAMxe,KAAK,SAAAye,GACjCA,EAAaC,oJEhHbC,EAAa,CACjBC,EAAQ,KAA0BC,QAClCD,EAAQ,KAA8BC,SAKzB,SAAelQ,EAA9BiN,EAAAkD,GAAA,OAAAC,EAAA/I,MAAA5Y,KAAA6Y,sDAAe,SAAAxR,EAA0BxB,EAAK4L,GAA/B,IAAApP,EAAAuf,EAAAC,EAAA7G,EAAA8G,EAAAC,EAAAphB,EAAAqhB,EAAA,OAAAva,EAAAC,EAAAC,KAAA,SAAAe,GAAA,cAAAA,EAAAb,KAAAa,EAAAZ,MAAA,OACTzF,EAAQ,IAAIY,MAAM,uBADT2e,EAEU/b,EAAIoc,wBAFdJ,EAAA/hB,OAAAoiB,EAAA,EAAApiB,CAAA8hB,EAAA,GAER5G,EAFQ6G,EAAA,GAEAC,EAFAD,EAAA,GAAAE,EAAAta,EAAAC,EAAA8Q,KAAA,SAAAuJ,EAGLphB,GAHK,IAAA4U,EAAAvQ,EAAA,OAAAyC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAIPyN,GAAS,EAJF3N,EAAAE,KAAA,EAKQga,EAAO,SAACK,EAAMC,GAC3B7M,GAAQ9D,EAAS0Q,EAAMC,KANlB,cAKPpd,EALO4C,EAAAI,KAQXuN,GAAS,EARE3N,EAAAC,KAAA,EAWT1F,QAAQC,IAAR,eAAA1C,OAA2B6hB,EAAW5gB,GAAGuC,KAAzC,KAAAxD,OAAiDsb,IACjDvJ,EAAS,eAAA/R,OAAe6hB,EAAW5gB,GAAGuC,KAA7B,MACiB,eAAvBqe,EAAW5gB,GAAGuC,KACf,iBAAmB,KAdZ0E,EAAAE,KAAA,GAeIyZ,EAAW5gB,GAAGqa,GAAQpC,MAAM2I,EAAW5gB,GAAIqE,EAAO0T,MAftD,eAAA9Q,EAAAK,GAAAL,EAAAI,KAAAJ,EAAAW,OAAA,UAAA8Z,EAAAza,EAAAK,KAAA,QAAAL,EAAAC,KAAA,GAAAD,EAAAO,GAAAP,EAAA,SAiBTzF,QAAQE,MAAM,gBAAduF,EAAAO,IACA9F,EAAKuF,EAAAO,GAlBI,yBAAAP,EAAAY,SAAAuZ,EAAA,iBAGLphB,EAAI,EAHC,YAGEA,EAAI4gB,EAAWxgB,QAHjB,CAAA2H,EAAAZ,KAAA,gBAAAY,EAAA4Z,cAAAP,EAGLphB,GAHK,oCAAAqhB,EAAAtZ,EAAAT,IAAA,CAAAS,EAAAZ,KAAA,eAAAY,EAAAH,OAAA,SAAAyZ,EAAAK,GAAA,OAGyB1hB,IAHzB+H,EAAAZ,KAAA,sBAqBPzF,EArBO,yBAAAqG,EAAAF,SAAAnB,2KCLXlC,EAAsB,CACxBod,UAAW,GACXzQ,UAFwB,SAEdsO,GACRpgB,KAAKuiB,UAAUC,KAAKpC,IAEtBpO,YALwB,SAKZoO,GACVpgB,KAAKuiB,UAAYviB,KAAKuiB,UAAU3N,OAAO,SAAA6N,GAAG,OAAIA,IAAQrC,KAExDhb,KARwB,WAStBpF,KAAKuiB,UAAUxS,QAAQ,SAAAqQ,GAAE,OAAIA,QAIlB,SAAelO,EAA9BsM,GAAA,OAAAkE,EAAA9J,MAAA5Y,KAAA6Y,sDAAe,SAAAxR,EAA8BxB,GAA9B,IAAAxD,EAAAsgB,EAAAC,EAAA5H,EAAA8G,EAAAnhB,EAAAqE,EAAA,OAAAyC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACTzF,EAAQ,IAAIY,MAAM,uBADT0f,EAEU9c,EAAIgd,0BAFdD,EAAA9iB,OAAAoiB,EAAA,EAAApiB,CAAA6iB,EAAA,GAER3H,EAFQ4H,EAAA,GAEAd,EAFAc,EAAA,GAGLjiB,EAAI,EAHC,YAGEA,EAAI4gB,IAAWxgB,QAHjB,CAAA6G,EAAAE,KAAA,gBAIP9C,OAJO,EAAA4C,EAAAE,KAAA,EAKIga,IALJ,cAKX9c,EALW4C,EAAAI,KAAAJ,EAAAC,KAAA,EAAAD,EAAAE,KAAA,GAQIyZ,IAAW5gB,GAAGqa,GAAQpC,MAAM2I,IAAW5gB,GAAIqE,EAAO0T,MARtD,eAAA9Q,EAAAW,OAAA,SAAAX,EAAAI,MAAA,QAAAJ,EAAAC,KAAA,GAAAD,EAAAK,GAAAL,EAAA,SAYTvF,EAAKuF,EAAAK,GAZI,QAGyBtH,IAHzBiH,EAAAE,KAAA,sBAePzF,EAfO,yBAAAuF,EAAAY,SAAAnB,EAAA,6LCbT3C,+FACJ,SAAclB,EAAKC,EAAQqf,GAA0B,IAAAjjB,EAAAG,KACnD,OAAG8iB,EACM1iB,QAAQE,OACb,IAAI2C,MAAM,sCAEPmE,YAAO5D,GAAKZ,KAAK,SAAAmgB,GACtB,OAAOljB,EAAKmjB,eAAeD,EAASxf,YAAawf,EAASvf,IAAKC,GAC7D,wEAGN,SAAA4D,EAAoB7D,EAAKC,EAAQqf,GAAjC,IAAAC,EAAA,OAAAtb,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACKgb,EADL,CAAAlb,EAAAE,KAAA,cAEU,IAAI7E,MAAM,uCAFpB,cAAA2E,EAAAE,KAAA,EAIuBV,YAAO5D,GAJ9B,UAIMuf,EAJNnb,EAAAI,KAAAJ,EAAAK,GAKSjI,KAAKkS,eAAe6Q,EAASxf,YAAaE,GAAQ,GAL3DmE,EAAAK,GAAA,CAAAL,EAAAE,KAAA,gBAAAF,EAAAO,GAMInI,KANJ4H,EAAAE,KAAA,GAMuChE,YAAgBif,EAASvf,KANhE,QAAAoE,EAAAS,GAAAT,EAAAI,KAMsEhE,OANtE4D,EAAAK,GAAAL,EAAAO,GAMS8a,uBANT/iB,KAAA0H,EAAAO,GAAAP,EAAAS,IAAA,eAAAT,EAAAW,OAAA,SAAAX,EAAAK,IAAA,yBAAAL,EAAAY,SAAAnB,EAAArH,gGAQA,SAAeuD,EAAaC,EAAKC,EAAQqf,GAA0B,IAAApf,EAAA1D,KACjE,OAAG8iB,EACM1iB,QAAQE,OACb,IAAI2C,MAAM,2CAEP0D,YAAK,CAACpD,cAAaC,QAAMZ,KAAK,SAAAsgB,GACnC,OAAOxf,EAAKyf,cAAcD,EAAO1f,IAAKC,GAAQ,kCAGlD,SAAcF,GACZ,OAAOnD,QAAQE,OACb,IAAI2C,MAAM,8EAEd,SAAeuD,EAAc/C,EAAQqf,GACnC,OAAO1iB,QAAQE,OAAO,IAAI2C,MAAM,+EAElC,SAAuBe,GACrB,OAAO,WAIL2B","file":"static/js/main.54fb1195.chunk.js","sourcesContent":["/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport FirefoxClient from 'firefox-client';\nimport blobToBuffer from 'blob-to-buffer';\nimport { extractManifest } from '../pkgutils';\nimport { Installer } from '../Installer';\n\nconst token_alphabet = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_.\";\nconst binary_name = 'debug-forwarder';\nconst binary_hash = '1d6a901d3237bfa56fdb8b85d593ed28';\nconst daemon_base = '/data/local/service/debug-forwarder';\nconst token_file = '.forwarder_token';\nconst storage_1 = '/data/media';\nconst storage_2 = '/sdcard';\nconst debug_file = '/sdcard/store-self-debug.log';\nconst daemon_init_cmd =\n  `(mkdir -p ${daemon_base} && ` +\n  `(cp ${storage_1}/tmp.${binary_name}.bin ${daemon_base}/${binary_name} || ` +\n  `cp ${storage_2}/tmp.${binary_name}.bin ${daemon_base}/${binary_name}) && ` +\n  `echo 'Copied daemon to ${daemon_base}/' && ` +\n  `chmod 700 ${daemon_base}/${binary_name}) > ${debug_file} 2>&1; ` +\n  `(md5sum ${daemon_base}/${binary_name} | grep '^${binary_hash}' || ` +\n  `(echo 'Failed to verify daemon hash' > ${debug_file} && false)) &&` +\n  `${daemon_base}/${binary_name} 6000 /data/local/debugger-socket 127.0.0.1` +\n  `>/dev/null </dev/null 2>/dev/null & ` +\n  `echo 'Started daemon'; `;\n\nfunction daemonInit(){\n  return new Promise((resolve, reject) => {\n    function failure(t){\n      alert(`Something went wrong with the daemon initialization.\nPlease manually follow the instructions at https://gitlab.com/affenull2345/kaios-self-debug and run the following command in 'adb shell'; then dismiss this dialog:\n\nprintf '${t}' > '${daemon_base}/${token_file}'\n\nIf the problem persists, please contact affenull2345@gmail.com and mention your phone model, firmware version and KaiOS version.`);\n    }\n    let token = \"\";\n    for(let i = 0; i < 32; i++){\n      token += token_alphabet[\n        Math.floor(Math.random() *\n          token_alphabet.length)];\n    }\n    function start(){\n      try {\n        let cmd = navigator\n          .engmodeExtension.startUniversalCommand(\n            daemon_init_cmd +\n            `printf '${token}' > '${daemon_base}/${token_file}'`,\n            true\n          );\n        cmd.onsuccess = function(){\n          // Wait for the daemon to spin up\n          setTimeout(() => resolve(token), 500);\n        }\n        cmd.onerror = function(){\n          failure(token);\n          resolve(token);\n        }\n      }\n      catch(e){\n        failure(token);\n        resolve(token);\n      }\n    }\n    let xhr = new XMLHttpRequest();\n    xhr.open('GET', `/${binary_name}.bin`, true);\n    xhr.responseType = 'blob';\n    xhr.onload = function(){\n      function save(storage){\n        let req = storage.addNamed(xhr.response, `tmp.${binary_name}.bin`);\n        req.onsuccess = function(){\n          console.log('[self-debug] Daemon saved to sdcard0');\n          start();\n        }\n        req.onerror = function(){\n          console.error('[self-debug] Failed to save daemon', req.error);\n          start();\n        }\n      }\n      if(xhr.status === 200 && xhr.response){\n        console.log('[self-debug] Loaded daemon', xhr.response);\n        let storages = navigator.getDeviceStorages('sdcard');\n        let del_req = storages[0].delete(`tmp.${binary_name}.bin`);\n        del_req.onsuccess = function(){\n          console.log('[self-debug] Deleted old daemon file on sdcard0');\n          save(storages[0]);\n        }\n        del_req.onerror = function(){\n          console.log('[self-debug] Did not delete old daemon file');\n          save(storages[0]);\n        }\n      }\n      else {\n        console.log('[self-debug] Could not load daemon, unexpected result');\n        start();\n      }\n    }\n    xhr.onerror = function(){\n      console.error('[self-debug] Could not load daemon, XHR failed');\n      start();\n    }\n    try {\n      xhr.send();\n    }\n    catch(e) {\n      console.error('[self-debug] Could not load daemon', e);\n      start();\n    }\n  });\n}\n\nclass SelfDebugInstaller extends Installer {\n  constructor(){\n    super();\n    this.loading = null;\n  }\n  load() {\n    this.loading = daemonInit().then(token => {\n      return new Promise((resolve, reject) => {\n        var client = new FirefoxClient();\n        client.connect('127.0.0.1', 6000, token, () => {\n          resolve(client);\n        });\n        client.on('error', e => {\n          reject(new Error(e.name + ' (' + e.message + ')'));\n        });\n        client.on('end', e => {\n          reject();\n        });\n      });\n    }).then(client => {\n      return new Promise((resolve, reject) => {\n        client.getWebapps((err, webapps) => {\n          if(err) reject(err);\n          else resolve({\n            client,\n            webapps\n          });\n        });\n      });\n    });\n  }\n  installPackage(manifestURL, pkg, idHint){\n    if(!this.loading){\n      this.load();\n    }\n    return this.loading.then(interfaces => {\n      var id = '{' + idHint + '}';\n      return extractManifest(pkg).then(manifest => {\n        if(manifest.origin){\n          var url = new URL(manifest.origin);\n          id = url.host;\n        }\n        return new Promise((resolve, reject) => {\n          console.log(`[self-debug] appId=${id}, installing`, pkg);\n          blobToBuffer(pkg, (err, buf) => {\n            if(err) reject(err);\n            interfaces.webapps.installPackaged(buf, id, e => {\n              interfaces.webapps.close(`app://${id}/manifest.webapp`, e => {\n                if(e) console.info('Could not close app', e);\n              });\n              if(e) reject(e);\n              else resolve();\n            });\n          });\n        });\n      });\n    }).catch(e => {\n      this.loading = null; // Retry next time\n      return Promise.reject(e);\n    });\n  }\n  /* checkInstalled should fall back to mozApps-based installer */\n  get name(){\n    return 'self-debug';\n  }\n}\n\nconst inst = new SelfDebugInstaller();\n\nexport default inst;\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { installStatusUpdate } from '../check-installed';\nimport { Installer, InstalledApp } from '../Installer';\n\nvar getAllCachedPromise = null;\n\nif(navigator.mozApps && navigator.mozApps.mgmt){\n  navigator.mozApps.mgmt.onuninstall = navigator.mozApps.mgmt.oninstall = ()=>{\n    getAllCachedPromise = null;\n    installStatusUpdate.emit();\n  }\n}\n\nfunction cachedGetAll(){\n  if(!getAllCachedPromise){\n    getAllCachedPromise = new Promise((resolve, reject) => {\n      var req = navigator.mozApps.mgmt.getAll();\n      req.onsuccess = function(){\n        resolve(req.result);\n      }\n      req.onerror = function(){\n        reject(new Error(req.error.name + ' ' + req.error.message));\n      }\n    });\n  }\n  return getAllCachedPromise;\n}\n\nclass MozAppsImportedApp extends InstalledApp {\n  constructor(mozApp){\n    super();\n    this._mozApp = mozApp;\n  }\n  open() {\n    this._mozApp.launch();\n  }\n  uninstall() {\n    return new Promise((resolve, reject) => {\n      var req = navigator.mozApps.mgmt.uninstall(this._mozApp);\n      req.onsuccess = function(){\n        resolve();\n      }\n      req.onerror = function(){\n        reject(new Error(req.error.name + ' ' + req.error.message));\n      }\n    });\n  }\n  get version() {\n    return this._mozApp.manifest.version;\n  }\n}\n\nclass MozAppsImportInstaller extends Installer {\n  importPackage(pkg, idHint){\n    return navigator.mozApps.mgmt.import(pkg).then(app => {\n      return Promise.resolve();\n    }).catch(e => {\n      if(e instanceof DOMError){\n        return Promise.reject(new Error(e.name + ' ' + e.message));\n      }\n    });\n  }\n  checkInstalledByOrigin(origin){\n    var url = new URL(origin);\n    return cachedGetAll().then(all => {\n      for(const app of all){\n        if(app.origin === url.origin ||\n          app.manifestURL === `app://${url.origin}/manifest.webapp`)\n        {\n          return Promise.resolve(new MozAppsImportedApp(app));\n        }\n      }\n    });\n  }\n  checkInstalled(manifest_url, idHint){\n    return cachedGetAll().then(all => {\n      for(const app of all){\n        if(app.manifestURL === manifest_url ||\n          app.manifestURL === `app://{${idHint}}/manifest.webapp` ||\n          app.origin === `app://{${idHint}}` ||\n          app.origin === idHint)\n        {\n          return Promise.resolve(new MozAppsImportedApp(app));\n        }\n      }\n    });\n  }\n  get name(){\n    return 'mozApps-import';\n  }\n}\n\nconst inst = new MozAppsImportInstaller();\n\nexport default inst;\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport JSZip from 'jszip';\nfunction pack(data){\n  var zip = new JSZip();\n  zip.file('metadata.json', JSON.stringify({\n    manifestURL: data.manifestURL\n  }));\n  zip.file('application.zip', data.pkg);\n  return zip.generateAsync({type: 'blob'});\n}\nasync function unpack(pkg){\n  var zip = await JSZip.loadAsync(pkg);\n  var metafile = zip.file('metadata.json');\n  if(!metafile) throw new Error('Package is missing metadata file');\n  var metadata = JSON.parse(await metafile.async('string'));\n  if(!metadata.manifestURL) throw new Error('Metadata is missing manifestURL');\n  var appfile = zip.file('application.zip');\n  if(!appfile) throw new Error('Package is missing application.zip');\n  return {\n    manifestURL: metadata.manifestURL,\n    pkg: await appfile.async('blob')\n  };\n}\nasync function extractManifest(pkg){\n  var zip = await JSZip.loadAsync(pkg);\n  var manifest = zip.file('manifest.webapp');\n  if(!manifest) throw new Error('Package is missing manifest');\n  return JSON.parse(await manifest.async('string'));\n}\n\nexport { pack, unpack, extractManifest }\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport { cloneVNode } from 'inferno-clone-vnode';\nimport { findDOMNode } from 'inferno-extras';\nimport scrollIntoView from 'smooth-scroll-into-view-if-needed';\nimport 'KaiUI/src/components/Tabs/Tabs.scss';\n\nexport default class Tabs extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      index: 0\n    };\n    this.childRefs = [];\n  }\n  componentDidMount() {\n    this.handleKeyDown_bound = this.handleKeyDown.bind(this);\n    document.addEventListener('keydown', this.handleKeyDown_bound);\n  }\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown_bound);\n  }\n  renderChildren() {\n    return this.props.children.map((tab, i) => {\n      return cloneVNode(tab, {\n        isActive: this.state.index === i,\n        ref: node => this.childRefs[i] = node\n      });\n    });\n  }\n  render() {\n    return (\n      <div className='kai-tabs'>{this.renderChildren()}</div>\n    );\n  }\n  handleKeyDown(e){\n    var idx = this.state.index;\n    if(e.key === 'ArrowLeft'){\n      this.setTabActive(idx, false);\n      idx--;\n      if(idx < 0) idx = this.props.children.length - 1;\n      this.setTabActive(idx, true);\n      this.setState({index: idx});\n      if(this.props.onChangeIndex) this.props.onChangeIndex(idx);\n    }\n    else if(e.key === 'ArrowRight'){\n      this.setTabActive(idx, false);\n      idx++;\n      if(idx >= this.props.children.length) idx = 0;\n      this.setTabActive(idx, true);\n      this.setState({index: idx});\n      if(this.props.onChangeIndex) this.props.onChangeIndex(idx);\n    }\n  }\n  setTabActive(idx, isActive) {\n    if(this.props.children.length > idx){\n      this.props.children[idx].props.isActive = isActive;\n      if(isActive && this.childRefs[idx]){\n        scrollIntoView(findDOMNode(this.childRefs[idx]), {\n          behavior: 'smooth',\n          block: 'start',\n          inline: 'center'\n        });\n      }\n    }\n  }\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport 'KaiUI/src/components/Tab/Tab.scss';\n\nexport default class Tab extends Component {\n  render() {\n    const cls = this.props.isActive ? 'kai-tab-active' : 'kai-tab-inactive';\n    return (\n      <div className={cls}>\n        <div className={cls + '-label'}>{this.props.label}</div>\n      </div>\n    );\n  }\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport 'KaiUI/src/views/TabView/TabView.scss';\nimport Tabs from './Tabs';\nimport Tab from './Tab';\n\nexport default class TabView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      active: 0\n    };\n  }\n  handleChangeIndex(idx) {\n    this.setState({active: idx});\n  }\n  renderTabs() {\n    return this.props.tabLabels.map((tab, i) => (\n      <Tab label={tab} />\n    ));\n  }\n  renderContent() {\n    return this.props.children.map((child, i) => (\n      i === this.state.active ? child : null\n    ));\n  }\n  render() {\n    return (\n      <div className='kai-tab-view'>\n        <div className='kai-tab-view-tabs'>\n          <Tabs onChangeIndex={this.handleChangeIndex.bind(this)}>\n            {this.renderTabs()}\n          </Tabs>\n        </div>\n        <div className='kai-tab-view-content'>\n          {this.renderContent()}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n * Most of this is directly copied from KaiUI, which is (C) Adrian Machado\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport 'KaiUI/src/kai-font/style.css';\nimport 'KaiUI/src/components/SoftKey/SoftKey.scss';\n\nclass SoftKeyButton extends Component {\n  handleClick(e) {\n    e.preventDefault();\n    if(this.props.handleClick) this.props.handleClick();\n  }\n  // We want to avoid losing focus on the parent element\n  handleFocus(e){\n    e.preventDefault();\n    if(e.relatedTarget){\n      // Revert focus back to previous blurrint element\n      e.relatedTarget.focus();\n    }\n    else {\n      // No previous focus target, blur instead\n      e.currentTarget.blur();\n    }\n  }\n  render() {\n    var renderedIcon = null;\n    if(this.props.icon){\n      if(this.props.icon.toString().indexOf('kai-') === -1){\n        renderedIcon = <img src={this.props.icon} width={20} height={20}\n          alt='' />;\n      }\n      else {\n        renderedIcon = <span className={this.props.icon} />;\n      }\n    }\n    return (\n      <button\n        id={this.props.id}\n        className='kai-softkey-btn'\n        onClick={this.handleClick.bind(this)}\n        onFocus={this.handleFocus.bind(this)}\n        data-icon={renderedIcon ? 'true' : null}\n      >\n        {renderedIcon}{this.props.text}\n      </button>\n    );\n  }\n}\n\nexport default class SoftKey extends Component {\n  handleKeyDown = (e) => {\n    switch(e.key){\n      case '<':\n      case 'SoftLeft':\n        if(this.props.leftCallback) this.props.leftCallback();\n        break;\n      case '>':\n      case 'SoftRight':\n        if(this.props.rightCallback) this.props.rightCallback();\n        break;\n      case 'Enter':\n        if(this.props.centerCallback) this.props.centerCallback();\n        break;\n      default:\n        return;\n    }\n    /* if this event was received by this softkey, other softkeys in parent\n     * receivers should not get it */\n    e.stopPropagation();\n  }\n  componentDidMount() {\n    this.keyboardReceiver = this.props.keyboardReceiver || document;\n    this.keyboardReceiver.addEventListener('keydown', this.handleKeyDown);\n  }\n  componentWillUnmount() {\n    this.keyboardReceiver.removeEventListener('keydown', this.handleKeyDown);\n  }\n  render() {\n    return (\n      <div className='kai-softkey visible'>\n        <SoftKeyButton\n          id='sk-left'\n          pos='left'\n          text={this.props.leftText}\n          icon={this.props.leftIcon}\n          handleClick={this.props.leftCallback} />\n        <SoftKeyButton\n          id='sk-center'\n          pos='center'\n          text={this.props.centerText}\n          icon={this.props.centerIcon}\n          handleClick={this.props.centerCallback} />\n        <SoftKeyButton\n          id='sk-right'\n          pos='right'\n          text={this.props.rightText}\n          icon={this.props.rightIcon}\n          handleClick={this.props.rightCallback} />\n      </div>\n    );\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { findDOMNode } from 'inferno-extras';\nimport { cloneVNode } from 'inferno-clone-vnode';\nimport scrollIntoView from 'smooth-scroll-into-view-if-needed';\n\nfunction focusIntoView(ref, settings){\n  var node = findDOMNode(ref);\n  if(node){\n    setTimeout(() => {\n      node.focus()\n    }, 10);\n    scrollIntoView(node, settings);\n  }\n}\n\nexport default function Focus(props){\n  const { children, settings, isActive } = props;\n  const child = Array.isArray(children) ? children[0] : children;\n  return cloneVNode(child, {\n    ref: isActive ? node => {\n      focusIntoView(node, settings || {\n        behavior: 'auto',\n        block: 'nearest',\n        inline: 'start'\n      });\n    } : null\n  });\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* This component is a derivative of KaiUI's Dialog */\n\nimport { Component, createPortal } from 'inferno';\nimport Focus from './Focus';\nimport SoftKey from './SoftKey';\nimport 'KaiUI/src/components/Dialog/Dialog.scss';\nimport './SelectPopup.css';\n\n/* focus logging\nHTMLElement.prototype.realFocus = HTMLElement.prototype.focus;\nHTMLElement.prototype.focus = function(){\n  console.log('focus', this);\n  this.realFocus();\n}\n*/\n\nconst modalRoot = document.getElementById('modal-root');\n\nexport default class SelectPopup extends Component {\n  constructor(props) {\n    super(props);\n    this.el = document.createElement('div');\n    this.el.className = 'kai-dialog';\n    this.el.tabIndex = 0;\n    this.state = {\n      selected: 0\n    };\n  }\n  handleKeydown = (evt) => {\n    // A modal should intercept all keys received, to avoid\n    // having them handled by other components\n    evt.stopPropagation();\n    if(evt.key !== 'Enter') evt.preventDefault();\n\n    switch(evt.key){\n      case 'Backspace':\n        this.props.onClose && this.props.onClose();\n        break;\n      case 'ArrowDown':\n        this.setState({\n          selected: (this.state.selected + 1) % this.props.children.length || 0\n        });\n        break;\n      case 'ArrowUp':\n        this.setState({\n          selected: (this.state.selected + this.props.children.length - 1) %\n            this.props.children.length || 0\n        });\n        break;\n      default:\n        break;\n    }\n  }\n  componentDidMount() {\n    modalRoot.appendChild(this.el);\n    this.el.addEventListener('keydown', this.handleKeydown);\n  }\n  componentWillUnmount() {\n    this.el.removeEventListener('keydown', this.handleKeydown);\n    modalRoot.removeChild(this.el);\n  }\n  render() {\n    const {\n      header,\n      children,\n      onClose,\n    } = this.props;\n    return createPortal(\n      <>\n        <div className=\"kai-dialog-wrapper\">\n          {header && <div className=\"kai-dialog-header h1\">{header}</div>}\n          <div className=\"select-popup-container\">\n            {children.map((child, i) =>\n              <Focus isActive={this.state.selected === i}>{child}</Focus>\n            )}\n          </div>\n        </div>\n        <SoftKey\n          leftText=\"Cancel\"\n          leftCallback={() => { onClose && onClose() }}\n          centerText=\"Select\"\n          centerCallback={() => {\n            document.activeElement.dispatchEvent(new MouseEvent('click'));\n          }}\n          keyboardReceiver={this.el}\n        />\n      </>,\n      this.el\n    );\n  }\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport 'KaiUI/src/components/RadioButtonListItem/RadioButtonListItem.scss';\nimport './RadioButtonListItem.css';\n\nexport default class RadioButtonListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false\n    };\n  }\n  handleFocus() {\n    if(this.buttonRef) this.buttonRef.focus();\n  }\n  handleButtonFocus(isFocused) {\n    this.setState({ isFocused });\n  }\n  render() {\n    const buttonCls =\n      `kai-rbl-button-input-${this.state.isFocused ? 'focused' : 'unfocused'}`;\n    const cls =\n      `kai-rbl${this.state.isFocused ? ' kai-rbl-focused' : ''}`;\n    return (\n      <div className={cls} tabIndex={-1} onFocus={() => this.handleFocus()}>\n        <div className=\"kai-rbl-line left\">\n          <div className=\"kai-rbl-primary\">{this.props.children}</div>\n        </div>\n        <div className=\"kai-rbl-button\">\n          <input\n            className={buttonCls}\n            tabIndex={-1}\n            type=\"radio\"\n            checked={this.props.isChecked}\n            ref={node => this.buttonRef = node}\n            onFocus={() => this.handleButtonFocus(true)}\n            onBlur={() => this.handleButtonFocus(false)}\n            onClick={() => this.props.onSelect && this.props.onSelect()}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n","// Copyright (C) 2021 Affe Null\n/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar conn = null;\n\nfunction startConn(){\n  if(conn) return conn;\n  return conn = new Promise((resolve, reject) => {\n    if(!navigator.mozApps || !navigator.mozApps.getSelf){\n      console.log('No mozApps interface, will disable toaster');\n      reject(new Error('No toaster'));\n    }\n    var req = navigator.mozApps.getSelf();\n    req.onsuccess = function(){\n      req.result.connect('systoaster').then(function(conn){\n        resolve(conn);\n      }).catch(function(e){\n        console.log('Disabling toaster due to connection error',\n          e);\n        reject();\n      });\n    }\n    req.onerror = function(){\n      console.log('Disabling toaster, failed to getSelf()');\n      reject();\n    }\n  });\n}\n\nexport default function toast(msg){\n  startConn().then(conn => {\n    conn.forEach(i => {\n      i.postMessage({message: msg});\n    });\n  }).catch(e => {\n    console.warn(e);\n    alert(msg);\n  });\n}\n","/*\n * KaiUI wrapper for InfernoJS\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport 'KaiUI/src/components/TextInput/TextInput.scss';\nimport './AppTheme.css';\n\nexport default class TextInput extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      focused: false\n    };\n  }\n  render() {\n    const cls = this.state.focused ?\n        'kai-text-input kai-text-input--focused item-selected' :\n        'kai-text-input';\n    return (\n      <div\n        id={this.props.id}\n        tabIndex={0}\n        className={cls}\n        onFocus={this.handleFocus.bind(this)}\n      >\n        <label className='kai-text-input-label p-thi'>{this.props.label}</label>\n        <input\n          ref={inp => this.inp = inp}\n          type={this.props.type}\n          className='kai-text-input-input p-pri'\n          onBlur={this.handleBlur.bind(this)}\n          onChange={this.handleChange.bind(this)}\n          value={this.props.value}\n          placeholder={this.props.placeholder}\n        />\n      </div>\n    );\n  }\n  handleChange() {\n    this.props.value = this.inp.value;\n    if(this.props.onChange) this.props.onChange();\n  }\n  handleFocus() {\n    if(this.props.onFocus) this.props.onFocus();\n    this.setState({focused: true});\n    this.inp.focus();\n  }\n  handleBlur() {\n    if(this.props.onBlur) this.props.onBlur();\n    this.setState({focused: false});\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport './AppDetail.css';\n\nexport default class AppDetail extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      extendedMetadata: null\n    };\n  }\n  renderExtendedMetadata() {\n    if(!this.state.extendedMetadata){\n      this.props.app.getExtendedMetadata().then(metadata => {\n        this.setState({\n          extendedMetadata: metadata\n        });\n      }).catch(e => {\n        this.setState({\n          extendedMetadata: {\n            error: e\n          }\n        });\n      });\n      return null;\n    }\n\n    let meta = this.state.extendedMetadata;\n    return Object.keys(meta).map(key => {\n      switch(key){\n        case 'developer':\n          return <div><b>Developers:</b>{meta[key].name}</div>;\n        case 'license':\n          return <div><b>License:</b>{meta[key]}</div>;\n        case 'download_count':\n          return <div><b>Downloads:</b>{meta[key]}</div>;\n        case 'error':\n          return <div><b>Failed to get metadata:</b>{`${meta[key]}`}</div>;\n        default:\n          return null;\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div className='AppDetail'>\n        <div className='p-sec'>\n          {this.props.app.description}\n        </div>\n        <div className='AppDetailMetadata'>\n          {this.renderExtendedMetadata()}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, createPortal } from 'inferno';\nimport { findDOMNode } from 'inferno-extras';\nimport installApp from './backend/install-app';\nimport checkInstalled, { installStatusUpdate } from './backend/check-installed';\nimport SoftKey from './ui/SoftKey';\nimport AppDetail from './AppDetail';\nimport './AppView.css';\n\nconst modalRoot = document.getElementById('modal-root');\n\nexport default class AppView extends Component {\n  constructor(props) {\n    super(props);\n    this.el = document.createElement('div');\n    this.el.className = 'AppViewContainer';\n    this.el.tabIndex = 0;\n    this.state = {\n      status: '',\n      installState: 'unknown',\n      locked: false\n    };\n  }\n  open() {\n    this.installedApp.open();\n  }\n  uninstall() {\n    console.log(this.installedApp);\n    if(this.state.installState === 'not-installed' || !this.installedApp)\n      return;\n    if(!window.confirm('Uninstall ' + this.props.app.name + '?')) return;\n\n    this.installedApp.uninstall().then(() => {\n      this.setState({\n        status: 'Uninstalled',\n        installState: 'not-installed'\n      });\n    });\n  }\n  install() {\n    this.setState({\n      status: 'Installing',\n      locked: true\n    });\n    installApp(this.props.app, (stage, progress) => {\n      this.setState({\n        status: 'number' === typeof progress ? `${stage} (${progress}%)` : stage\n      });\n    }).then(() => {\n      this.setState({\n        status: 'Installed!',\n        locked: false\n      });\n    }).catch(err => {\n      alert('While installing app: ' + err);\n      this.setState({\n        status: 'Failed',\n        locked: false\n      });\n    });\n  }\n\n  handleKeyDown(e) {\n    // A modal should intercept all keys received, to avoid\n    // having them handled by other components\n    e.stopPropagation();\n    e.preventDefault();\n\n    let node = null;\n    switch(e.key){\n      case 'Backspace':\n        if(!this.state.locked && this.props.onClose){\n          this.props.onClose();\n        }\n        break;\n      case 'ArrowDown':\n        if(this.boxRef) node = findDOMNode(this.boxRef);\n        if(node) node.scrollBy({\n          top: 10,\n          left: 0\n        });\n        break;\n      case 'ArrowUp':\n        if(this.boxRef) node = findDOMNode(this.boxRef);\n        if(node) node.scrollBy({\n          top: -10,\n          left: 0\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  componentDidMount() {\n    modalRoot.appendChild(this.el);\n    this.handleKeyDown_bound = this.handleKeyDown.bind(this);\n    this.el.addEventListener('keydown', this.handleKeyDown_bound);\n    this.el.focus();\n    installStatusUpdate.subscribe(this.updateInstallState.bind(this));\n  }\n  componentWillUnmount() {\n    modalRoot.removeChild(this.el);\n    this.el.removeEventListener('keydown', this.handleKeyDown_bound);\n    installStatusUpdate.unsubscribe(this.updateInstallState.bind(this));\n  }\n\n  updateInstallState() {\n    checkInstalled(this.props.app).then(app => {\n      if(app){\n        this.installedApp = app;\n        return this.props.app.checkUpdatable(app.version).then(updatable => {\n          this.setState({\n            installState: updatable ? 'updatable' : 'installed'\n          });\n        });\n      }\n      else {\n        this.setState({\n          installState: 'not-installed'\n        });\n      }\n    }).catch(e => {\n      console.error('Install check failed', e);\n      this.setState({\n        status: 'Install check failed',\n        installState: 'check-failed'\n      });\n    });\n    this.setState({\n      installState: 'checking'\n    });\n  }\n  render() {\n    if(this.state.installState === 'unknown'){\n      this.updateInstallState();\n    }\n    return createPortal(\n      (<>\n        <div className='AppView' ref={r => this.boxRef = r} >\n          <div\n            className='AppViewHeader'\n            style={`background-image: url(${this.props.app.findIcon(60)})`}\n          >\n            <h3>{this.props.app.name}</h3>\n            <div className='AppViewStatus'>{this.state.status}</div>\n          </div>\n          <AppDetail app={this.props.app} />\n        </div>\n        <SoftKey\n          leftText=''\n          centerText={\n            this.state.locked ? '' :\n            this.state.installState === 'installed' ? 'Open' :\n            this.state.installState === 'updatable' ? 'Update' : 'Install'\n          }\n          rightText={\n            this.state.locked ? '' :\n            this.state.installState === 'not-installed' ? '' :\n            this.state.installState === 'checking' ? 'Checking...' :\n            'Uninstall'\n          }\n          centerCallback={\n            this.state.locked ? null :\n            this.state.installState === 'installed' ? this.open.bind(this) :\n            this.install.bind(this)\n          }\n          rightCallback={this.state.locked ? null : this.uninstall.bind(this)}\n          keyboardReceiver={this.el}\n        />\n      </>),\n      this.el\n    );\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport AppView from './AppView';\nimport './AppButton.css';\n\nexport default class AppButton extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      focused: false,\n      open: false\n    };\n  }\n  render() {\n    return (\n      <div\n        className='app-button'\n        tabIndex={0}\n        onFocus={() => this.handleFocus()}\n      >\n        <button\n          className='app-button-button'\n          style={`background-image: url(${this.props.app.findIcon(56)})`}\n          onBlur={() => this.handleBlur()}\n          onClick={() => this.handleClick()}\n          ref={btn => this.btn = btn}\n        >{this.props.app.name}</button>\n        {this.state.open ? (\n          <AppView\n            app={this.props.app}\n            onClose={() => this.handleFocus()}\n          />\n        ) : null}\n      </div>\n    );\n  }\n  handleClick() {\n    this.setState({focused: true, open: true});\n  }\n  handleFocus() {\n    this.setState({focused: true, open: false});\n    this.btn.focus();\n  }\n  handleBlur() {\n    this.setState({focused: false});\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport Focus from './ui/Focus';\nimport AppButton from './AppButton';\nimport './AppList.css';\n\nexport default class AppList extends Component {\n  constructor(props) {\n    super(props);\n    this.apps = [];\n    this.state = {\n      loading: false,\n      loadedPages: 0,\n      isLastPage: false,\n      selected: 0\n    };\n    this.savedFilters = props.filters;\n  }\n  handleKeydown = (e) => {\n    var idx = this.state.selected;\n    if(e.key === 'ArrowUp'){\n      e.preventDefault();\n      idx--;\n      if(idx >= 0){\n        this.setState({\n          selected: idx\n        });\n      }\n      else if(idx === -1 && this.props.canNavigateUp){\n        this.setState({\n          selected: idx\n        });\n        this.props.onNavigateUp();\n      }\n    }\n    else if(e.key === 'ArrowDown'){\n      e.preventDefault();\n      idx++;\n      if(!this.state.loading){\n        if(idx < this.apps.length){\n          this.setState({\n            selected: idx\n          });\n        }\n        if(idx >= (this.apps.length - 2) && !this.state.isLastPage){\n          this.setState({\n            loading: true,\n            selected: idx,\n            isLastPage: false\n          });\n          this.loadNextPage();\n        }\n      }\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown);\n  }\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown);\n  }\n  loadNextPage(after) {\n    const nextPage = this.state.loadedPages + 1;\n    return this.props.store.getApps(this.props.filters, (nextPage-1)*10, 10)\n    .then(({apps, isLastPage}) => {\n      console.log('[AppList] Is last page:', isLastPage);\n      this.apps = this.apps.concat(apps);\n      this.setState({\n        loading: false,\n        loadedPages: nextPage,\n        isLastPage\n      });\n    }).catch(e => {\n      console.error('Failed to load next page', e);\n      setTimeout(() => {\n        this.loadNextPage();\n      }, 3000);\n    });\n  }\n  renderApps() {\n    if(this.props.filters !== this.savedFilters){\n      this.savedFilters = this.props.filters;\n      this.apps = [];\n      this.loading = false;\n      this.setState({\n        loading: false,\n        loadedPages: 0,\n        isLastPage: false,\n        selected: 0\n      });\n      return;\n    }\n    if(this.state.loadedPages === 0){\n      if(!this.loading){\n        this.loading = true;\n        this.loadNextPage();\n      }\n      return 'Loading...';\n    }\n    if(this.apps.length === 0){\n      return (\n        <div className='AppListEmpty p-pri'>No results.</div>\n      );\n    }\n    return this.apps.map((app, i) => {\n      return (\n        <Focus\n          isActive={this.props.useFocus && this.state.selected === i}\n          settings={{\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'start',\n            duration: 600\n          }}\n        >\n          <AppButton app={app} />\n        </Focus>\n      );\n    });\n  }\n  render() {\n    return (\n      <div className='AppList'>{this.renderApps()}</div>\n    );\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport { findDOMNode } from 'inferno-extras';\nimport TextInput from './ui/TextInput';\nimport SoftKey from './ui/SoftKey';\nimport AppList from './AppList';\nimport './Search.css';\n\nexport default class Search extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      keywords: [],\n      searchActive: true\n    };\n    this.appList = null;\n    this.search = '';\n  }\n  handleKeydown = (e) => {\n    if(e.key === 'Backspace' && this.props.onClose){\n      e.preventDefault();\n      this.props.onClose();\n    }\n  }\n  handleKeyup = (e) => {\n    if(e.key === 'Enter' && this.state.searchActive){\n      this.updateKeywords();\n    }\n  }\n  activateSearch() {\n    var node = findDOMNode(this.inp);\n    if(node){\n      node.focus();\n      this.setState({\n        searchActive: true\n      });\n    }\n  }\n  componentDidMount() {\n    this.activateSearch();\n    document.addEventListener('keydown', this.handleKeydown);\n    document.addEventListener('keyup', this.handleKeyup);\n  }\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown);\n    document.removeEventListener('keyup', this.handleKeyup);\n  }\n  render() {\n    if(!this.appList){\n      this.appList = this.state.keywords.length > 0 ?\n        <AppList\n          store={this.props.store}\n          filters={{keywords: this.state.keywords}}\n          useFocus={true}\n          canNavigateUp={true}\n          onNavigateUp={() => this.activateSearch()}\n        /> :\n        <div className='SearchPlaceholder p-pri'>\n          Please enter a search term\n        </div>\n    }\n    return (\n      <div className='Search'>\n        <TextInput\n          onChange={() => this.search = this.inp.props.value}\n          onFocus={() => this.setState({searchActive: true})}\n          onBlur={() => this.setState({searchActive: false})}\n          ref={inp => this.inp = inp}\n        />\n        {this.appList}\n        <SoftKey\n          leftText=''\n          centerText={this.state.searchActive ? 'Search' : 'Select'}\n          rightText=''\n        />\n      </div>\n    );\n  }\n  updateKeywords() {\n    const reg = /[.,; ]+/ig;\n    this.appList = null;\n    this.setState({\n      keywords: this.search.replace(reg, ' ').split(' ').filter(a => a)\n    });\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nclass AppStore {}\nclass StoreApp {}\n\nexport { AppStore, StoreApp }\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { AppStore, StoreApp } from '../AppStore';\nimport compareVersions from 'compare-versions';\n\nconst BHACKERS_SERVERS = [\n  \"https://banana-hackers.gitlab.io/store-db\",\n  \"https://bananahackers.github.io/store-db\",\n];\nconst BHACKERS_RATINGS = [\n  \"https://bhackers.uber.space/srs/v1\",\n];\n\nfunction request(meth, url, rtype, data, progress){\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest({mozSystem: true});\n    xhr.open(meth, url, true);\n    xhr.responseType = rtype;\n    xhr.ontimeout = function(){\n      reject(new Error('Request Timeout'));\n    }\n    xhr.onload = function(){\n      if(xhr.status === 200){\n        resolve(xhr.response);\n      }\n      else if(xhr.status > 200 && xhr.status < 300){\n        resolve(null);\n      }\n      else {\n        reject(new Error(`Got HTTP ${xhr.status} status`));\n      }\n    }\n    xhr.onprogress = function(e){\n      if(progress) progress(e.loaded, e.total);\n    }\n    xhr.onerror = function(e){\n      reject(new Error('Request Failure'));\n    }\n    xhr.send(data);\n  });\n}\n\nasync function countDownload(rating_servers, slug){\n  for(let srv of rating_servers){\n    try {\n      let response = await request('GET', srv + '/download_counter/count/' +\n        slug);\n      if(response !== 'OK') throw new Error(response);\n    }\n    catch(e) {\n      console.error(`Server ${srv} failed with`, e);\n    }\n  }\n}\n\nasync function loadSRSData(rating_servers, data){\n  const reg = /[^a-z]/g;\n  const saveName = 'bhv2srs-' + rating_servers[0].replace(reg, '$');\n  for(let srv of rating_servers){\n    try {\n      let response = await request('GET', srv + '/download_counter');\n      let obj = JSON.parse(response);\n      localStorage.setItem(saveName, response);\n      data.downloadCount = obj;\n      return data;\n    }\n    catch(e) {\n      console.error(`Server ${srv} failed with`, e);\n    }\n  }\n  const saved = localStorage.getItem(saveName);\n  if(saved){\n    data.downloadCount = JSON.parse(saved);\n    return data;\n  }\n  throw new Error('Could not load SRS data');\n}\n\nasync function loadData(servers, rating_servers){\n  for(let srv of servers){\n    try {\n      let response = await request('GET', srv + '/data.json', 'string', null);\n      let obj = JSON.parse(response);\n      localStorage.setItem('bhv2-save', response);\n      return await loadSRSData(rating_servers, obj);\n    }\n    catch(e) {\n      console.error(`Server ${srv} failed with`, e);\n    }\n  }\n  if(localStorage.getItem('bhv2-save')){\n    return JSON.parse(localStorage.getItem('bhv2-save'));\n  }\n  throw new Error('Could not load data');\n}\n\nclass BHackersV2App extends StoreApp {\n  constructor(ratings, data, downloadCount, dataVersion){\n    super();\n    this._data = data;\n    this._dataVersion = dataVersion;\n    this._downloadCount = downloadCount || 0;\n    this.ratings = ratings;\n    this.blobPromise = this.manifestPromise = null;\n  }\n  get name() {\n    return this._data.name;\n  }\n  get description() {\n    return this._data.description;\n  }\n  loadManifest() {\n    if(this._dataVersion < 3) return Promise.resolve({\n      version: this._data.download.version\n    });\n\n    if(!this.manifestPromise){\n      this.manifestPromise = request(\n        'GET', this._data.download.manifest, 'string', null\n      ).then(str => Promise.resolve(JSON.parse(str)));\n    }\n    return this.manifestPromise;\n  }\n  getExtendedMetadata() {\n    return this.loadManifest().then(mf => Promise.resolve({\n      developer: {\n        name: this._data.author.map(a => a.replace(/\\s*<[^>]*>$/, ''))\n              .join(', '),\n      },\n      source: this._data.git_repo,\n      has_ads: this._data.has_ads,\n      has_tracking: this._data.has_tracking,\n      license: this._data.license,\n      type: this._data.type,\n      version: mf.version,\n      download_count: this._downloadCount\n    }));\n  }\n  findIcon(size) {\n    return this._data.icon;\n  }\n  getInstallationMethod() {\n    return ['importPackage', async (reportProgress) => {\n      if(!this.blobPromise){\n        this.blobPromise =\n          request('GET', this._data.download.url, 'blob', null,\n            (loaded, total) => {\n              reportProgress('Downloading', Math.floor(loaded/total*100));\n            });\n      }\n      countDownload(this.ratings, this._data.slug);\n      this._downloadCount++;\n      return {args: [await this.blobPromise, this._data.slug]};\n    }];\n  }\n  getIdentificationMethod() {\n    if(this._dataVersion < 3){\n      return ['checkImported', async () => {\n        if(!this.blobPromise){\n          this.blobPromise =\n            request('GET', this._data.download.url, 'blob', null);\n        }\n        return {args: [await this.blobPromise, this._data.slug]};\n      }];\n    }\n    return ['checkInstalled', async () => {\n      return {args: [this._data.download.manifest,\n        (await this.loadManifest()).origin || this._data.slug\n      ]};\n    }];\n  }\n  checkUpdatable(version) {\n    return this.loadManifest().then(mf => Promise.resolve(\n      (version && mf.version) ?\n      (compareVersions(mf.version, version) > 0) : false\n    ));\n  }\n}\n\nexport default class BHackersV2Store extends AppStore {\n  constructor(\n    servers = BHACKERS_SERVERS,\n    ratings = BHACKERS_RATINGS,\n    name = 'B-Hackers Store'\n  ) {\n    super();\n    this.servers = servers;\n    this.ratings = ratings;\n    this.name = name;\n  }\n  load() {\n    return loadData(this.servers, this.ratings).then(data => {\n      this._data = data;\n      console.log('[bhackers-v2] Got data', data);\n      if(data.version < 3){\n        console.log('[bhackers-v2] Old database version detected');\n      }\n      else if(data.version > 3){\n        console.warn('[bhackers-v2] Database version too new!');\n      }\n      this.categories = [{\n        name: 'Most downloaded', id: '$popular', special: true\n      }].concat(Object.keys(data.categories).map(ctg => {\n        return { name: data.categories[ctg].name, id: ctg };\n      }));\n    });\n  }\n  getApps(filter, start, count) {\n    var origSet = this._data.apps;\n    if(filter.keywords){\n      console.log('[bhackers-v2] Keywords:', filter.keywords);\n      origSet = origSet.map(app => {\n        var score = 0;\n\n        filter.keywords.forEach(kw => {\n          kw = kw.toLowerCase();\n\n          if(app.name.toLowerCase() === kw) score += 5;\n          else if(app.name.toLowerCase().includes(kw)) score += 2;\n\n          app.meta.tags.replace(/; */i, ';').split(';').forEach(tag => {\n            if(tag.toLowerCase() === kw) score += 3;\n            else if(tag.toLowerCase().includes(kw)) score += 1;\n          });\n\n          if(app.description.toLowerCase().includes(kw)) score += 2;\n        });\n\n        var new_app = Object.create(app);\n        new_app.searchScore = score;\n        return new_app;\n      });\n    }\n    var filteredSet = origSet.filter(app => {\n      var match = true;\n      if(filter.categories){\n        if(filter.categories[0].id !== '$popular'){\n          match &= filter.categories.some(\n            ct => app.meta.categories.includes(ct.id));\n        }\n      }\n      if(filter.keywords){\n        match &= (app.searchScore > 0);\n      }\n      return match;\n    });\n    if(filter.categories && filter.categories[0].id === '$popular'){\n      filteredSet.sort((a, b) => {\n        return (this._data.downloadCount[b.slug] || 0) -\n          (this._data.downloadCount[a.slug] || 0);\n      });\n    }\n    if(filter.keywords){\n      filteredSet.sort((a, b) => b.searchScore - a.searchScore);\n    }\n    return Promise.resolve({\n      apps: filteredSet\n        .slice(start, start+count)\n        .map(app => new BHackersV2App(\n          this.ratings,\n          app,\n          this._data.downloadCount[app.slug],\n          this._data.version\n        )),\n      isLastPage: start+count >= filteredSet.length\n    });\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Buffer } from 'buffer';\nimport * as hawk from 'hawk';\n\nexport default class Requester {\n  constructor(auth, api, dev){\n    this.auth = auth;\n    this.api = api;\n    this.dev = dev;\n    switch(auth.method){\n      case 'api-key':\n        this.send({\n          method: 'POST',\n          data: {\n            brand: dev.brand,\n            device_id: dev.imei,\n            device_type: dev.type,\n            model: dev.model,\n            os: dev.os,\n            os_version: dev.version,\n            reference: dev.cu\n          },\n          path: '/v3.0/applications/' + api.app.id + '/tokens',\n          headers: {\n            'Authorization': 'Key ' + auth.key\n          },\n          type: 'json'\n        }).then(token => {\n          this.token = token;\n          this.onload();\n        }).catch(e => {\n          this.onerror(e);\n        });\n        break;\n      default:\n        this.onerror(new Error('Unknown authentication method: ' +\n          auth.method));\n        break;\n    }\n  }\n  send(req){\n    return new Promise((resolve, reject) => {\n      if(!req.path)\n        reject(new TypeError('request missing path'));\n      else if(!req.method)\n        reject(new TypeError('request missing method'));\n      else {\n        var xhr = new XMLHttpRequest({mozSystem: true});\n        var path = req.path;\n        var payload = ['POST', 'PUT'].includes(req.method) ? (\n          (req.contentType && req.contentType !== 'application/json') ?\n          req.data : JSON.stringify(req.data)\n        ) : null;\n        var hawkinfo;\n        if(path[0] === '/'){\n          path = this.api.server.url + path;\n        }\n        if(req.type === 'blob' || req.type === 'arraybuffer')\n          xhr.responseType = req.type;\n\n        xhr.open(req.method, path, true);\n        if('object' === typeof req.headers){\n          Object.keys(req.headers).forEach(name => {\n            xhr.setRequestHeader(name, req.headers[name]);\n          });\n        }\n        xhr.setRequestHeader('Kai-API-Version', this.api.ver);\n        xhr.setRequestHeader('Kai-Request-Info',\n          'ct=\"wifi\", rt=\"auto\", utc=\"' +\n          Date.now() + '\", utc_off=\"1\", ' +\n          'mcc=\"' + this.dev.mcc + '\", ' +\n          'mnc=\"' + this.dev.mnc + '\", ' +\n          'net_mcc=\"null\", ' +\n          'net_mnc=\"null\"'\n        );\n        xhr.setRequestHeader('Kai-Device-Info',\n          'imei=\"' + this.dev.imei + '\", curef=\"' + this.dev.cu + '\"');\n        xhr.setRequestHeader('User-agent', this.dev.ua);\n        xhr.setRequestHeader('Content-type',\n          req.contentType || 'application/json');\n        if(this.token){\n          hawkinfo = {\n            credentials: {\n              id: this.token.kid,\n              algorithm: 'sha256',\n              key: new Buffer(this.token.mac_key, 'base64')\n            }\n          };\n          if(payload){\n            hawkinfo.payload = payload;\n            hawkinfo.contentType = req.contentType || 'application/json';\n          }\n          xhr.setRequestHeader('Authorization',\n            hawk.client.header(path, req.method, hawkinfo).header);\n        }\n        xhr.onerror = function(){\n          reject(new Error('request error'));\n        }\n        xhr.onprogress = function(e){\n          if(req.reportProgress)\n            req.reportProgress('Downloading', Math.floor(\n              e.loaded / e.total * 100\n            ));\n        }\n        xhr.onload = function(){\n          var msg = '';\n          if(xhr.status !== 200 && xhr.status !== 201 && xhr.status !== 204){\n            if(xhr.responseText){\n              try {\n                var error = JSON.parse(xhr.responseText);\n                msg = ' ' + error.desc + ': ' + error.cause;\n              } catch(e) {\n                msg = ' ' + xhr.responseText;\n              }\n            }\n            reject('request error ' + xhr.status + ': ' + xhr.statusText + msg);\n          }\n          if(req.type === 'json'){\n            try {\n              resolve(JSON.parse(xhr.responseText));\n            }\n            catch(e){\n              reject(e);\n            }\n          }\n          else {\n            resolve(xhr.response);\n          }\n        }\n        xhr.send(payload);\n      }\n    });\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { AppStore, StoreApp } from '../AppStore';\nimport compareVersions from 'compare-versions';\nimport Requester from './kaistone-requester';\n\nfunction getKaiOSVersion(){\n  var kaiUA = /(KAIOS|B2GOS)\\/([^ ]*)/.exec(navigator.userAgent);\n  if(kaiUA) return kaiUA[2];\n  else return '2.5.4';\n}\n\nconst settings = {\n  dev: {\n    model: 'GoFlip2',\n    imei: '123456789012345',\n    type: 999999,\n    brand: 'AlcatelOneTouch',\n    os: 'KaiOS',\n    version: getKaiOSVersion(),\n    ua: 'Mozilla/5.0 (Mobile; GoFlip2; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/'+\n      getKaiOSVersion(),\n    cu: '4044O-2BAQUS1-R',\n    mcc: '0',\n    mnc: '0'\n  },\n  api: {\n    app: {\n      id: 'CAlTn_6yQsgyJKrr-nCh',\n      name: 'KaiOS Plus',\n      ver: '2.5.4'\n    },\n    server: {\n      url: 'https://api.kaiostech.com'\n    },\n    ver: '3.0'\n  },\n  auth: {\n    method: 'api-key',\n    key: 'baJ_nea27HqSskijhZlT'\n  }\n};\n\nclass KaiStoneApp extends StoreApp {\n  constructor(data, requester){\n    super();\n    this.requester = requester;\n    this._data = data;\n  }\n  get name() {\n    return this._data.display || this._data.name;\n  }\n  get description() {\n    return this._data.description;\n  }\n  findIcon(preferredSize) {\n    if(this._data.thumbnail_url) return this._data.thumbnail_url;\n\n    var sizes = Object.keys(this._data.icons);\n    var bestSize = null, currentDiff = null;\n    sizes.forEach(size => {\n      var diff = preferredSize - size;\n      if(diff < 0) diff = -diff;\n      if(currentDiff === null || diff < currentDiff){\n        bestSize = size;\n        currentDiff = diff;\n      }\n    });\n    if(!bestSize){\n      return null;\n    }\n    return this._data.icons[bestSize];\n  }\n  loadManifest() {\n    if(!this.manifestPromise){\n      this.manifestPromise = this.requester.send({\n        method: 'GET',\n        path: this._data.manifest_url,\n        type: 'json'\n      });\n    }\n    return this.manifestPromise;\n  }\n  getExtendedMetadata() {\n    var getDeveloper;\n    if('string' === typeof this._data.developer &&\n      'string' === typeof this._data.developer_url)\n    {\n      getDeveloper = Promise.resolve({\n        name: this._data.developer,\n        url: this._data.developer_url\n      });\n    }\n    else {\n      getDeveloper = this.loadManifest().then(mf => {\n        return Promise.resolve(mf.developer);\n      });\n    }\n    return getDeveloper.then(developer => {\n      return Promise.resolve({\n        developer,\n        version: this._data.version,\n        type: this._data.type\n      });\n    });\n  }\n  getInstallationMethod() {\n    return ['installPackage', async (reportProgress) => {\n      if(!this.blobPromise){\n        this.blobPromise = this.requester.send({\n          method: 'GET',\n          path: this._data.package_path ||\n            (await this.loadManifest()).package_path,\n          type: 'blob',\n          reportProgress\n        });\n      }\n      return {args: [\n        this._data.manifest_url,\n        await this.blobPromise,\n        this._data.id\n      ]};\n    }];\n  }\n  getIdentificationMethod() {\n    return ['checkInstalled', async () => {\n      return {args: [\n        this._data.manifest_url,\n        (await this.loadManifest()).origin || this._data.id\n      ]};\n    }];\n  }\n  checkUpdatable(version) {\n    return Promise.resolve(\n      version ? (compareVersions(this._data.version, version) > 0) : false\n    );\n  }\n}\n\nexport default class KaiStone extends AppStore {\n  load() {\n    return this.loadPromise || (\n      this.loadPromise = new Promise((resolve, reject) => {\n        this.requester = new Requester(\n          settings.auth, settings.api, settings.dev\n        );\n        this.requester.onload = () => {\n          this.requester.send({\n            method: 'GET',\n            path: '/v3.0/categories',\n            type: 'json'\n          }).then(ctgs => {\n            console.log('[kaistone] Categories', ctgs);\n            this.categories = ctgs;\n            resolve();\n          }).catch(reject);\n        }\n        this.requester.onerror = e => {\n          reject(e);\n        }\n      })\n    );\n  }\n  getApps(filter, start, count) {\n    var isSearch = false, clientSideCategoryFilter = false;\n    var path = '/kc_ksfe/v1.0/apps';\n    if(Array.isArray(filter.keywords)){\n      isSearch = true;\n      path = 'https://search.kaiostech.com/v3/_search';\n    }\n    path += '?bookmark=false';\n    path += '&imei=' + settings.dev.imei;\n    if(isSearch){\n      path += '&platform=' + settings.dev.version;\n      path += '&page=' + Math.floor(start/count);\n      path += '&size=' + count;\n    }\n    else {\n      path += '&os=' + settings.dev.version;\n      path += '&page_size=' + count;\n      path += '&page_num=' + (1+Math.floor(start/count));\n    }\n    path += '&mnc=' + settings.dev.mnc + '&mcc=' + settings.dev.mcc;\n    if(filter.categories && filter.categories.length > 0){\n      if(filter.categories.length === 1)\n        path += '&category=' + encodeURIComponent(filter.categories[0].code);\n      else\n        clientSideCategoryFilter = true;\n    }\n    if(isSearch){\n      path += '&query=' + filter.keywords.join(' ');\n      path += '&locale=' + encodeURIComponent(navigator.language);\n    }\n    return this.requester.send({\n      method: 'GET',\n      type: 'json',\n      path\n    }).then(data => {\n      var filtered = (isSearch ? data.organic : data.apps).filter(app => {\n        var match = true;\n        if(clientSideCategoryFilter){\n          match &= filter.categories.some(\n            ct => app.category_list.includes(ct.code));\n        }\n        return match;\n      });\n      return Promise.resolve({\n        apps: filtered.map(app => new KaiStoneApp(app, this.requester)),\n        isLastPage: isSearch ? data.page === data.total_pages-1 : data.last_page\n      });\n    });\n  }\n  get name() {\n    return 'KaiStore (KaiStone backend)';\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport TabView from './ui/TabView';\nimport SoftKey from './ui/SoftKey';\nimport SelectPopup from './ui/SelectPopup';\nimport RadioButtonListItem from './ui/RadioButtonListItem';\nimport toast from './Toaster';\nimport Search from './Search';\nimport AppList from './AppList';\nimport BHackersV2Store from './backend/appstore/bhackers-v2';\nimport KaiStone from './backend/appstore/kaistone';\nimport './Store.css';\n\nexport default class Store extends Component {\n  constructor(props) {\n    super(props);\n\n    this.stores = [\n      new BHackersV2Store(),\n      new BHackersV2Store([\n        'https://storedb.opengiraffes.top',\n      ], [\n        'https://opengiraffes-rating.herokuapp.com',\n      ], 'OpenGiraffes (China)'),\n      new KaiStone(),\n    ];\n    this.state = {\n      store: 0,\n      loaded: false,\n      loading: false,\n      searchOpen: false,\n      error: null\n    };\n  }\n  storeLoadComplete(idx) {\n    toast(this.stores[idx].name);\n    if(this.state.store === idx)\n      this.setState({loaded: true, loading: false});\n  }\n  render() {\n    const popup = this.state.selecting && <SelectPopup\n      header=\"Select source\"\n      onClose={() => this.setState({\n        selecting: false\n      })}\n    >{this.stores.map((store, index) =>\n      <RadioButtonListItem\n        isChecked={index === this.state.store}\n        onSelect={() => this.setState({\n          store: index,\n          loaded: false,\n          loading: false,\n          selecting: false,\n          error: null\n        })}\n      >\n        {store.name}\n      </RadioButtonListItem>\n    )}</SelectPopup>;\n\n    if(!this.state.loaded){\n      if(this.state.error){\n        return (\n          <div className='Store'>\n            <div className='StoreLoadFailed'>\n              <h3>Loading failed</h3>\n              {this.state.error}\n            </div>\n            <SoftKey\n              leftText='Quit'\n              centerText='Retry'\n              rightText='Switch'\n              leftCallback={() => window.close()}\n              centerCallback={() => this.setState({\n                loaded: false,\n                loading: false,\n                error: null\n              })}\n              rightCallback={() => this.setState({\n                selecting: true\n              })}\n            />\n            {popup}\n          </div>\n        );\n      }\n      if(!this.state.loading){\n        this.setState({loading: true, loaded: false, error: null});\n        this.stores[this.state.store]\n          .load()\n          .then(() => this.storeLoadComplete(this.state.store))\n          .catch(e => {\n            toast('Failed');\n            this.setState({\n              loading: false,\n              loaded: false,\n              error: e.toString()\n            });\n          });\n      }\n      return (\n        <div className='Store'>\n          Loading...\n        </div>\n      );\n    }\n\n    if(this.state.searchOpen){\n      return (\n        <Search\n          onClose={() => this.setState({ searchOpen: false})}\n          store={this.stores[this.state.store]}\n        />\n      );\n    }\n\n    const tabs = this.stores[this.state.store].categories.map(ctg => (\n      <AppList\n        store={this.stores[this.state.store]}\n        filters={{categories: [ctg]}}\n        useFocus={!this.state.selecting}\n      />\n    ));\n    const labels = this.stores[this.state.store].categories.map(\n      ctg => ctg.name);\n    return (\n      <div className='Store'>\n        <TabView tabLabels={labels}>{tabs}</TabView>\n        <SoftKey\n          leftIcon='kai-icon-search'\n          centerText='Select'\n          rightText='Switch'\n          leftCallback={() => this.setState({ searchOpen: true })}\n          rightCallback={() => this.setState({\n            selecting: true\n          })}\n        />\n        {popup}\n      </div>\n    );\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport TextInput from './ui/TextInput';\nimport './Setup.css';\n\nclass Setup extends Component {\n  constructor(props) {\n    super(props);\n    this.cb = props.onSetup;\n  }\n  render() {\n    return (\n      <div className='Setup'>\n        <TextInput label='Login' />\n      </div>\n    );\n  }\n  handleSetupComplete() {\n    this.cb();\n  }\n}\n\nexport default Setup;\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component } from 'inferno';\nimport Store from './Store'\nimport Setup from './Setup'\nimport './App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      setupDone: true\n    };\n  }\n  render() {\n    if(!this.state.setupDone){\n      return (\n        <div className='App'>\n          <Setup onSetup={() => this.setState({setupDone: true})} />\n        </div>\n      );\n    }\n    else {\n      return (\n        <div className='App'>\n          <Store />\n        </div>\n      );\n    }\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { render } from 'inferno';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nif(navigator.mozSettings){\n  /* Force debug mode to be enabled */\n  navigator.mozSettings.createLock().set({\n    'debugger.remote-mode': 'adb-devtools'\n  });\n}\n\nrender(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst installers = [\n  require('./installer/self-debug').default,\n  require('./installer/mozapps-import').default,\n];\n\nexport { installers };\n\nexport default async function installApp(app, progress){\n  let error = new Error('No installers found');\n  let [method, loader] = app.getInstallationMethod();\n  for(let i = 0; i < installers.length; i++){\n    let loaded = false;\n    let result = await loader((what, amount) => {\n      if(!loaded) progress(what, amount);\n    });\n    loaded = true;\n\n    try {\n      console.log(`Trying with ${installers[i].name}.${method}`);\n      progress(`Installing [${installers[i].name}]` +\n        (installers[i].name === 'self-debug' ?\n        ' - be patient!' : ''));\n      return await installers[i][method].apply(installers[i], result.args);\n    } catch(e) {\n      console.error('Install error', e);\n      error = e;\n    }\n  }\n  throw error;\n}\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { installers } from './install-app';\n\nvar installStatusUpdate = {\n  callbacks: [],\n  subscribe(cb) {\n    this.callbacks.push(cb);\n  },\n  unsubscribe(cb) {\n    this.callbacks = this.callbacks.filter(cb2 => cb2 !== cb);\n  },\n  emit() {\n    this.callbacks.forEach(cb => cb());\n  }\n};\n\nexport default async function checkInstalled(app){\n  let error = new Error('No installers found');\n  let [method, loader] = app.getIdentificationMethod();\n  for(let i = 0; i < installers.length; i++){\n    let result;\n    result = await loader();\n\n    try {\n      return await installers[i][method].apply(installers[i], result.args);\n    } catch(e) {\n      // Don't spam console with fallback errors\n      //console.error('CheckInstall error', e);\n      error = e;\n    }\n  }\n  throw error;\n}\n\nexport { installStatusUpdate };\n","/*\n * Copyright (C) 2021 Affe Null <affenull2345@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { pack, unpack, extractManifest } from './pkgutils';\n\nclass Installer {\n  importPackage(pkg, idHint, calledFromImplementation) {\n    if(calledFromImplementation){\n      return Promise.reject(\n        new Error('This installer cannot import apps'));\n    }\n    return unpack(pkg).then(unpacked => {\n      return this.installPackage(unpacked.manifestURL, unpacked.pkg, idHint,\n        true);\n    });\n  }\n  async checkImported(pkg, idHint, calledFromImplementation) {\n    if(calledFromImplementation){\n      throw new Error('This installer cannot checkImported');\n    }\n    var unpacked = await unpack(pkg);\n    return this.checkInstalled(unpacked.manifestURL, idHint, true) ||\n      this.checkInstalledByOrigin((await extractManifest(unpacked.pkg)).origin);\n  }\n  installPackage(manifestURL, pkg, idHint, calledFromImplementation) {\n    if(calledFromImplementation){\n      return Promise.reject(\n        new Error('This installer cannot install packages'));\n    }\n    return pack({manifestURL, pkg}).then(packed => {\n      return this.importPackage(packed.pkg, idHint, true);\n    });\n  }\n  installHosted(manifestURL) {\n    return Promise.reject(\n      new Error('This installer does not support hosted apps'));\n  }\n  checkInstalled(manifest_url, idHint, calledFromImplementation) {\n    return Promise.reject(new Error('This installer cannot checkInstalled'));\n  }\n  checkInstalledByOrigin(origin) {\n    return false;\n  }\n}\n\nclass InstalledApp {}\n\nexport { Installer, InstalledApp }\n"],"sourceRoot":""}