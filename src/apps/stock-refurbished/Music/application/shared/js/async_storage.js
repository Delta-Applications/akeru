
this.asyncStorage=function(){function r(e){if(d)e();else{var n=indexedDB.open(s,l);n.onerror=function(){console.error("asyncStorage: can't open database:",n.error.name),window.close()},n.onupgradeneeded=function(){n.result.createObjectStore(u)},n.onsuccess=function(){d=n.result,d.objectStoreNames.contains(u)?(localStorage.async_storage_db_ver=l,e()):f--&&(d.close(),d=null,l++,r(e))}}}function e(e,n,o){r(function(){var r=d.transaction(u,e);o&&(r.oncomplete=o),n(r.objectStore(u))})}function n(r,n){var o;e("readonly",function(e){o=e.get(r),o.onerror=function(){console.error("Error in asyncStorage.getItem(): ",o.error.name)}},function(){var r=o.result;void 0===r&&(r=null),n(r)})}function o(r,n,o){e("readwrite",function(e){var o=e.put(n,r);o.onerror=function(){console.error("Error in asyncStorage.setItem(): ",o.error.name)}},o)}function t(r,n){e("readwrite",function(e){var n=e.delete(r);n.onerror=function(){console.error("Error in asyncStorage.removeItem(): ",n.error.name)}},n)}function a(r){e("readwrite",function(r){var e=r.clear();e.onerror=function(){console.error("Error in asyncStorage.clear(): ",e.error.name)}},r)}function c(r){var n;e("readonly",function(r){n=r.count(),n.onerror=function(){console.error("Error in asyncStorage.length(): ",n.error.name)}},function(){r(n.result)})}function i(r,n){if(0>r)return n(null),void 0;var o;e("readonly",function(e){var n=!1;o=e.openCursor(),o.onsuccess=function(){var e=o.result;e&&(0===r||n||(n=!0,e.advance(r)))},o.onerror=function(){console.error("Error in asyncStorage.key(): ",o.error.name)}},function(){var r=o.result;n(r?r.key:null)})}var s="asyncStorage",l=localStorage.async_storage_db_ver||1,u="keyvaluepairs",d=null,f=3;return{getItem:n,setItem:o,removeItem:t,clear:a,length:c,key:i}}();