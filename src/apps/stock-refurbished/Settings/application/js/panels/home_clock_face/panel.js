define(["require","modules/settings_panel","modules/settings_service"],function(e){var t=e("modules/settings_panel"),n=e("modules/settings_service");return function(){return t({onInit:function(e){this._elements={leftTrangle:e.querySelector(".arrow-left"),rightTrangle:e.querySelector(".arrow-right"),homeClockSelector:e.querySelector(".clock-title"),displayDateCheckbox:e.querySelector("[name='displayDate']")},this.clockpanel=new ClockPanel,this._boundUpdateDisplayDate=function(e){this._elements.displayDateCheckbox.checked=e?!0:!1}.bind(this),this._boundCheckedBoxChange=function(e){this.clockpanel.isDisplayDate=e.target.checked}.bind(this),this._boundUpdateHomeClockSelector=function(e){var t="";t=window.navigator.mozHour12?"12 Hour ":"24 Hour ";var n="";navigator.mozL10n.get("digital-clock"),n=e===ClockPanel.ANALOG?navigator.mozL10n.get(e+"-clock"):e===ClockPanel.BOLD_DIGITAL?"Bold "+t+"Clock":t+"Clock",this._elements.homeClockSelector.textContent=n}.bind(this),this._boundTrangleClick=function(t){switch(t.key){case"ArrowLeft":this._elements.leftTrangle.click();break;case"ArrowRight":this._elements.rightTrangle.click();break;case"Enter":case"Accept":e.querySelector(".focus input").focus()}}.bind(this),this._boundClockFaceChange=function(e){for(var t=[ClockPanel.BOLD_DIGITAL,ClockPanel.DIGITAL],n=this.clockpanel.clockType,i=t[0],o=t[t.length-1],r=0;r<t.length;r++)n===t[r]&&(i=r!=t.length-1?t[r+1]:t[0],o=0!=r?t[r-1]:t[t.length-1]);var a=e.target.classList.contains("arrow-left");this.clockpanel.clockType=a?o:i}.bind(this),this._boundClockPanelInitHandler=function(e){var t=e.detail.clockType,n=e.detail.isDisplayDate;this._boundUpdateHomeClockSelector(t),this._boundUpdateDisplayDate(n)}.bind(this),this._saveChange=function(){this.clockpanel.saveClockFace(),this.clockpanel.saveDisplayDate()}.bind(this);var t=function(){this._saveChange(),n.navigate("dateTime")}.bind(this);this.softkeyParams={menuClassName:"menu-button",header:{l10nId:"message"},items:[{name:"Cancel",l10nId:"cancel",priority:1,method:function(){n.navigate("dateTime")}},{name:"Save",l10nId:"save",priority:3,method:t}]}},onBeforeShow:function(){this.clockpanel.showClockPanel(),SettingsSoftkey.init(this.softkeyParams),window.addEventListener("keydown",this._boundTrangleClick),this._elements.leftTrangle.addEventListener("click",this._boundClockFaceChange),this._elements.rightTrangle.addEventListener("click",this._boundClockFaceChange),window.addEventListener("clockchange",this._boundClockPanelInitHandler),this._elements.displayDateCheckbox.addEventListener("change",this._boundCheckedBoxChange)},onShow:function(){SettingsSoftkey.show()},onHide:function(){window.removeEventListener("keydown",this._boundTrangleClick),this._elements.leftTrangle.removeEventListener("click",this._boundClockFaceChange),this._elements.rightTrangle.removeEventListener("click",this._boundClockFaceChange),window.removeEventListener("clockchange",this._boundClockPanelInitHandler),this._elements.displayDateCheckbox.removeEventListener("change",this._boundCheckedBoxChange)},onBeforeHide:function(){}})}});