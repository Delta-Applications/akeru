define(["require","modules/settings_panel","modules/settings_service"],function(e){var t=e("modules/settings_panel"),n=e("modules/settings_service");return function(){function e(){var e=u.getCardLockRetryCount("nck");e.onsuccess=function(){var t=e.result.retryCount;i(t)}}function i(e){return e?(d(f.tryLeftMsg,"inputCodeRetriesLeft",{n:e}),f.tryLeftMsg.hidden=!1,void 0):(f.tryLeftMsg.hidden=!0,void 0)}function o(){if(!l){l=!0;var t=u.unlockCardLock({lockType:"nck",pin:f.nckInput.value});t.onsuccess=function(){console.log("unlockNCK onsuccess"),n.navigate("carrier"),l=!1},t.onerror=function(){t.error,l=!1,console.log("unlockNCK onerror"),e(),f.errorMsg.hidden=!1}}}function r(e){var t=e.querySelector("input");return t.addEventListener("input",function(){var e=f.nckInput.value;f.errorMsg.hidden=!0,e.length>7?a(c):a(s)}),t}function a(e){SettingsSoftkey.init(e),SettingsSoftkey.show()}var s,c,u,d=navigator.mozL10n.setAttributes,l=!1,f={};return s={menuClassName:"menu-button",header:{l10nId:"message"},items:[{name:"Cancel",l10nId:"cancel",priority:1,method:function(){n.navigate("carrier")}}]},c={items:[{name:"Cancel",l10nId:"cancel",priority:1,method:function(){n.navigate("carrier")}},{name:"Done",l10nId:"done",priority:3,method:function(){o()}}]},t({onInit:function(e,t){f.tryLeftMsg=document.getElementById("sim-tries-left"),f.errorMsg=document.getElementById("sim-code-error"),f.nckInput=r(e),u=getIccByIndex(t.index)},onBeforeShow:function(){a(s),e()},onShow:function(){f.nckInput.value="",f.errorMsg.hidden=!0,f.nckInput.focus()},onBeforeHide:function(){}})}});