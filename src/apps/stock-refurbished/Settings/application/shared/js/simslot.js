!function(e){var t=Date.now(),n=!1;e.SIMSlot=function(e,t,n){this.index=t,this.conn=e,n&&this.update(n),this.publish("created")},SIMSlot.EVENTS=["cardstatechange","iccinfochange","stkcommand","stksessionend"],SIMSlot.METHODS=["sendStkResponse","sendStkMenuSelection","sendStkTimerExpiration","sendStkEventDownload"],SIMSlot.DOM_REQUEST_METHODS=["getCardLock","unlockCardLock","setCardLock","getCardLockRetryCount","readContacts","updateContact","iccOpenChannel","iccExchangeAPDU","iccCloseChannel"],SIMSlot.LOCK_TYPES=["pinRequired","pukRequired","networkLocked","corporateLocked","serviceProviderLocked","network1Locked","network2Locked","hrpdNetworkLocked","ruimCorporateLocked","ruimServiceProviderLocked","permanentBlocked"],SIMSlot.prototype.update=function(e){this.simCard=e,this.constructor.EVENTS.forEach(function(t){e.addEventListener(t,this)},this),this.constructor.DOM_REQUEST_METHODS.forEach(function(t){this[t]=function(){return e[t].apply(e,arguments)}},this),this.constructor.METHODS.forEach(function(t){this[t]=function(){return e[t].apply(e,arguments)}},this),this.publish("updated")},SIMSlot.prototype.EVENT_PREFIX="simslot-",SIMSlot.prototype.CLASS_NAME="SIMSLOT",SIMSlot.prototype.publish=function(t){this.debug(" publish: "+t),e.dispatchEvent(new CustomEvent(this.EVENT_PREFIX+t,{detail:this}))},SIMSlot.prototype.handleEvent=function(e){switch(e.type){default:this.publish(e.type),this.simCard&&this.debug(this.simCard.cardState)}},SIMSlot.prototype.debug=function(){n&&console.log("["+this.CLASS_NAME+"]"+"["+this.index+"]"+"["+((new Date).getTime()/1e3-t).toFixed(3)+"]"+Array.slice(arguments).concat())},SIMSlot.prototype.isAbsent=function(){return!this.simCard||this.simCard&&this.simCard.iccInfo&&null===this.simCard.iccInfo.iccid},SIMSlot.prototype.getSmsc=function(t){var n=e.navigator.mozMobileMessage;if(n){var o=n.getSmscAddress(this.index);o.onsuccess=function(){var e=this.result.split(",")[0].replace(/"/g,"");t(e)},o.onerror=function(){console.error(this.error),t(null)}}else console.error("can't access mozMobileMessage"),t(null)},SIMSlot.prototype.isUnknownState=function(){var e=""===this.simCard.cardState,t="unknown"===this.simCard.cardState;return!this.simCard.cardState||t||e},SIMSlot.prototype.isLocked=function(){return this.constructor.LOCK_TYPES.indexOf(this.simCard.cardState)>=0},SIMSlot.prototype.getCardState=function(){return this.simCard.cardState}}(window);