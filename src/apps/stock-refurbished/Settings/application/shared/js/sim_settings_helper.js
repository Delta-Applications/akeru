!function(e){var t={EMPTY_OPTION_TEXT:"--",EMPTY_OPTION_VALUE:-2,ALWAYS_ASK_OPTION_VALUE:-1,_callbacks:{outgoingCall:[],outgoingMessages:[],outgoingData:[]},observe:function(e,t){var n=this._callbacks[e];n&&n.push(t)},unobserve:function(e,t){var n=this._callbacks[e];if(n){var o=n.indexOf(t);o>-1&&n.splice(o,1)}},getCardIndexFrom:function(e,t){this._get(e)._onWhichCard(t)},_get:function(e){switch(this.settingKeys=[],e){case"outgoingCall":this.settingKeys.push("ril.telephony.defaultServiceId");break;case"outgoingMessages":this.settingKeys.push("ril.sms.defaultServiceId");break;case"outgoingData":this.settingKeys.push("ril.data.defaultServiceId")}return this},_onWhichCard:function(e){this.settingKeys.forEach(function(t){this._getFromSettingsDB(t,e)}.bind(this))},_getFromSettingsDB:function(e,t){var n=window.navigator.mozSettings,o=n.createLock().get(e),r=function(){if(t){var n=o.result[e]||0;t(n)}};o.onsuccess=r,o.onerror=r},setServiceOnCard:function(e,t){this._set(e)._on(+t)},_set:function(e){switch(this.settingKeys=[],e){case"outgoingCall":this.settingKeys.push("ril.telephony.defaultServiceId"),this.settingKeys.push("ril.voicemail.defaultServiceId");break;case"outgoingMessages":this.settingKeys.push("ril.sms.defaultServiceId"),this.settingKeys.push("ril.mms.defaultServiceId");break;case"outgoingData":this.settingKeys.push("ril.data.defaultServiceId")}return this},_on:function(e){this.settingKeys.forEach(function(t){this._setToSettingsDB(t,e)}.bind(this))},_setToSettingsDB:function(e,t,n){var o=function(){n&&n()},r=window.navigator.mozSettings,i=r.createLock().get(e);i.onsuccess=function(){var n=i.result[e];if(n!==t){var a={};a[e]=t;var s=r.createLock().set(a);s.onsuccess=o,s.onerror=o}else o()},i.onerror=o},_addSettingsObservers:function(){var e=this;navigator.mozSettings.addObserver("ril.telephony.defaultServiceId",function(t){e._callbacks.outgoingCall.forEach(function(e){e(t.settingValue)})}),navigator.mozSettings.addObserver("ril.sms.defaultServiceId",function(t){e._callbacks.outgoingMessages.forEach(function(e){e(t.settingValue)})}),navigator.mozSettings.addObserver("ril.data.defaultServiceId",function(t){e._callbacks.outgoingData.forEach(function(e){e(t.settingValue)})})}};t._addSettingsObservers(),e.SimSettingsHelper=t}(window);