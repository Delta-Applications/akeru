!function(e){function t(e){var t;if("string"==typeof e?(t=e,e=document.getElementById(e)):e&&(t=e.id),!e)return console.error("Can not find the node passed to Template",t),"";if(!e.firstChild)return console.error("Node passed to Template should have a comment node",t),"";e=e.firstChild;do if(e.nodeType===Node.COMMENT_NODE)return(e.nodeValue||"").trim();while(e=e.nextSibling);return console.error("Nodes passed to Template should have a comment node",t),""}function n(e){return this instanceof n?(r.set(this,{idOrNode:e}),void 0):new n(e)}var r=new WeakMap,o=/\$\{([^}]+)\}/g,i=/[&<>"']/g,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};n.prototype.extract=function(){var e=r.get(this);return e.tmpl||(e.tmpl=t(e.idOrNode),delete e.idOrNode),e.tmpl},n.prototype.toString=function(){return this.extract().slice()},n.prototype.interpolate=function(e,t){return t=t||{},t.safe=t.safe||[],this.extract().replace(o,function(r,o){return o=o.trim(),-1===t.safe.indexOf(o)?n.escape(e[o]):e[o]})},n.prototype.prepare=function(e,t){var n=this;return{toString:function(){return n.interpolate(e,t)},toDocumentFragment:function(){var e=document.createElement("template");return e.innerHTML=this.toString(),e.content.cloneNode(!0)}}},n.escape=function(e){return"string"!=typeof e?"":e.replace(i,function(e){return a[e]})},e.Template=n}(this);