
(function(exports){'use strict';exports.VideoLoadingChecker=VideoLoadingChecker;function VideoLoadingChecker(player,overlay,overlayTitle,overlayText){this.player=player;this.overlay=overlay;this.overlayTitle=overlayTitle;this.overlayText=overlayText;}
VideoLoadingChecker.prototype={ensureVideoLoads:function vpc_ensureVideoLoads(callback){var self=this;this.player.addEventListener('stalled',throwOverlay);this.player.addEventListener('loadedmetadata',handleLoadedMetadata);function handleLoadedMetadata(){self.player.removeEventListener('loadedmetadata',handleLoadedMetadata);self.player.removeEventListener('stalled',throwOverlay);hideOverlay(self);if(callback){callback();}}
function throwOverlay(){showOverlay(self);}},ensureVideoPlays:function(){this.playingListener=this.cancelEnsureVideoPlays.bind(this);this.errorListener=this.errorShow.bind(this);this.player.addEventListener('error',this.errorListener);this.player.addEventListener('timeupdate',this.playingListener);},errorShow:function(){showOverlay(this);},cancelEnsureVideoPlays:function(){hideOverlay(this);if(this.errorListener){this.player.removeEventListener('error',this.errorListener);this.errorListener=null;}
if(this.playingListener){this.player.removeEventListener('timeupdate',this.playingListener);this.playingListener=null;}
canPlay=true;}};function showOverlay(checker){checker.overlayTitle.setAttribute('data-l10n-id','video-hardware-in-use-title');checker.overlayText.setAttribute('data-l10n-id','video-hardware-in-use-text');checker.overlay.classList.remove('hidden');document.body.classList.add('in-use-overlay');}
function hideOverlay(checker){document.body.classList.remove('in-use-overlay');checker.overlay.classList.add('hidden');}}(window));